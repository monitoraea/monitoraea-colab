import{u as w,c as D,d as I,r as s,e as S,n as h,f as _,K as z,j as n,p as t}from"./index-D3lmPgLZ.js";import{r as N}from"./robot-DMXJz1T6.js";const k="_mainDiv_chtiv_1",E="_actions_chtiv_6",m={mainDiv:k,actions:E};function C({data:e}){const{server:a}=w(),{enqueueSnackbar:i,closeSnackbar:c}=D(),l=I(),[f,j]=s.useState(""),[v,g]=s.useState(null),[u,d]=s.useState(!1),{data:o}=S(["indic_notif",{sourceProjectId:e.content.sourceProjectId,type:e.content.type,sourceDraftId:e.content.sourceDraftId,indicationId:e.content.indicationId}],{queryFn:async()=>(await h.get(`${a}project/${e.content.sourceProjectId}/relation/agreement/${e.content.type}/${e.content.sourceDraftId}/${e.content.indicationId}`)).data,enabled:!!e.content}),y={sendAgreement:_(r=>h.put(`${a}project/${e.content.sourceProjectId}/relation/agreement`,{...e.content,agreement:r}))};s.useEffect(()=>{e&&(l.invalidateQueries("indic_notif"),j(z(e.createdAt).format("DD/MM/YYYY HH:mm")))},[e,l]),s.useEffect(()=>{o&&g(o.agreement)},[o]);const p=async r=>{d(!0);const x=i("Enviando resposta...",{persist:!0,anchorOrigin:{vertical:"top",horizontal:"center"}});try{await y.sendAgreement.mutateAsync(r),c(x),i("Envio efetuado com sucesso!",{variant:"success",anchorOrigin:{vertical:"top",horizontal:"right"}})}catch(b){c(x),console.error(b),i("Erro ao enviar a resposta!",{variant:"error",anchorOrigin:{vertical:"top",horizontal:"right"}})}finally{d(!1)}};return n.jsxs(t,{sx:{padding:"24px",marginTop:"48px",backgroundColor:"white",position:"relative",zIndex:"1",minHeight:"100px",width:"100%",boxShadow:"0px 0px 8px #0000001A",borderRadius:"8px"},children:[n.jsx(t,{sx:{display:"flex",justifyContent:"space-between"},children:n.jsxs(t,{sx:{display:"flex"},children:[n.jsx(t,{as:"img",src:N,alt:"salve",sx:{borderRadius:"50%",width:"48px",height:"48px"}}),n.jsxs(t,{sx:{marginLeft:"8px"},children:[n.jsx(t,{sx:{fontWeight:"bold",fontSize:"16px"},children:"Sua iniciativa foi indicada"}),n.jsx(t,{sx:{fontSize:"14px"},children:f})]})]})}),n.jsx(t,{sx:{marginTop:"8px"},children:n.jsxs("div",{className:m.mainDiv,children:[n.jsxs("div",{children:['A iniciativa "',e.content.sourceProjectName,'" indicou que sua iniciativa',e.content.type==="apoia"&&n.jsx("span",{children:" é uma de suas apoiadoras."}),e.content.type==="apoiada"&&n.jsx("span",{children:" é apoiada por ela."})]}),v===null&&n.jsxs("div",{className:m.actions,children:[n.jsx("button",{className:"button-primary",size:"small",disabled:u,onClick:()=>p(!0),children:"Sim, reconheço"}),n.jsx("button",{className:"button-outline",size:"small",disabled:u,onClick:()=>p(!1),children:"Não reconheço"})]})]})})]})}export{C as default};
