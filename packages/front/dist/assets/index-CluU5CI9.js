import{r as w,j as c,e as Vt,T as ht,u as ee,l as ut,c as ue,b as ii,f as ce,D as Oi,h as ki,i as Se,k as Mi,B as ur,d as ji,C as $n,o as ei,M as nt,R as wt,g as At,p as Wt,S as ti,q as $a,m as dr,s as Ua,t as fr,v as Fa,w as X,a as Ha}from"./index-Bt2dc8oQ.js";import{T as Un,A as Fn,C as pr}from"./Trash-D_TyOwEo.js";import{T as Ga,a as bi}from"./Tabs-Dzd8MGJK.js";import{H as Hn,_ as Wa,b as Va,a as qa,c as mr,h as Ya,S as Yo,i as Gn,d as Ka,e as Ja,s as Xa,o as Qa,f as ts,g as es,j as _r,k as Wn,l as is,m as ns,n as os,p as rs,q as as,r as ss,t as ls,u as hs,v as cs,w as us}from"./_baseIteratee-D8Xi_5y6.js";import{A as ds,C as fs}from"./index-auPX8ilA.js";import{A as Ei,C as ps,c as ms,a as jn}from"./CircularProgress-B6xarsSL.js";import{A as Sn}from"./index-BPEKB_09.js";import{P as Nn}from"./Plus-DgNPZnEJ.js";import{s as Xe}from"./FreeMultiple.module-CtXSpXmF.js";import{I as gr}from"./Popper-Bw8nTH4X.js";import{D as Ko}from"./index-5l8RjsFm.js";import{F as vr,S as _s}from"./Switch-9QR8OtQ0.js";import{S as gs,F as vs}from"./FormControlLabel-CXejDUP9.js";import{C as ys}from"./index-tjP0QGq2.js";import{N as Si}from"./react-number-format.es-DbKIUXmk.js";import{q as Ls}from"./styled-components.browser.esm-DfUNofdj.js";import{P as xs}from"./PageTitle-sSwpJkJW.js";import{B as bs}from"./Box-DWUSnGLM.js";import"./KeyboardArrowRight-CKXDRILH.js";import"./index-BrB1sgMj.js";const ws="_backdrop_x4juq_52",Es="_indicator_x4juq_85",Ps="_warning_x4juq_106",Ts="_ready_x4juq_109",Os="_divisor_x4juq_146",ks="_cleanfilters_x4juq_152",yt={"projects-tabs":"_projects-tabs_x4juq_45",backdrop:ws,"ptabs-content":"_ptabs-content_x4juq_72","ptabs-tabs":"_ptabs-tabs_x4juq_79",indicator:Es,"fixed-size":"_fixed-size_x4juq_85","not-ready":"_not-ready_x4juq_103",warning:Ps,ready:Ts,"ptabs-actions":"_ptabs-actions_x4juq_119","ptabs-datefilter":"_ptabs-datefilter_x4juq_124","ptabs-datefilter-button":"_ptabs-datefilter-button_x4juq_134",divisor:Os,cleanfilters:ks};function Ms({defaultTab:a,onTabChange:n,analysis:h}){const[s,i]=w.useState(!1),[r,d]=w.useState(!1),[p,_]=w.useState(!1),[g,b]=w.useState(!1),[T,O]=w.useState(0),[H,M]=w.useState(0),G=v=>{n(v.target.id)};return w.useEffect(()=>{if(!h)return;let v=0;const Z=Object.filter=(k,j)=>Object.keys(k).filter(P=>(j(k[P])&&v++,j(k[P]))).reduce((P,I)=>(P[I]=k[I],P),{});Z(h.analysis.indics,k=>k.ready===!1),O(v),v=0;const D=Z(h.analysis.information,k=>k===!1);M(v),i((k=>Object.keys(k).length===0)(D)),_(Object.values(h.analysis.indics).reduce((k,j)=>j.ready?k:!1,!0)),b(h.analysis.geo),d(h.analysis.connections)},[h]),c.jsxs("div",{className:yt["projects-tabs"],children:[c.jsx("div",{className:yt.backdrop}),c.jsx("div",{className:yt["ptabs-content"],children:c.jsxs(Ga,{className:yt["ptabs-tabs"],onChange:G,value:a,children:[c.jsx(bi,{disableRipple:!0,label:"Informações",...wi("informacao",H),className:`${yt.indicator} ${s?yt.ready:yt.warning} ${H<10&&yt["fixed-size"]}`}),c.jsx(bi,{disableRipple:!0,label:"Conexões",...wi("conexoes"),className:`${yt.indicator} ${r?yt.ready:yt["not-ready"]}`}),c.jsx(bi,{disableRipple:!0,label:"Indicadores",className:`${yt.indicator} ${p?yt.ready:yt["not-ready"]} ${T<10&&yt["fixed-size"]}`,...wi("indicadores",T)}),c.jsx(bi,{disableRipple:!0,label:"Atuação",className:`${yt.indicator} ${g?yt.ready:yt["not-ready"]} ${yt["fixed-size"]}`,...wi("atuacao",g?"0":"1")})]})})]})}function wi(a,n=""){return{id:a,"aria-controls":`simple-tabpanel-${a}`,value:a,"data-problems":n}}const js=ms();function te({label:a=null,url:n,urlSingle:h,query:s="",value:i,invalidText:r,titleField:d,onChange:p,disabled:_,error:g,creatable:b=!1,creatableFormat:T='Adicionar "INPUTVALUE"',onCreate:O,inputWidth:H,placeholder:M,...G}){const[v,Z]=w.useState(!1),[D,z]=w.useState([]),[k,j]=w.useState(null),[P,I]=w.useState(!1),{data:Y,isLoading:at}=Vt(`${h||n}/${i}`,{enabled:!!i&&!G.freeSolo}),{data:A,isLoading:K}=Vt(`${n}/${s}`,{enabled:v});w.useEffect(()=>{z(A?A.list:[])},[A]),w.useEffect(()=>{i||j(null)},[i]),w.useEffect(()=>{Y&&j(Y)},[Y]);const B=async($,lt)=>{I(!0),lt&&lt.inputValue&&(lt=await O(lt.inputValue)),I(!1),j(lt),p(lt?lt.id:null,lt||null)};return c.jsx(c.Fragment,{children:c.jsx(Ei,{className:"input-autocomplete",id:"asynchronous-demo",disabled:_||P,open:v,onOpen:()=>{Z(!0)},onClose:()=>{Z(!1)},onChange:B,value:k,autoHighlight:!0,isOptionEqualToValue:($,lt)=>$.id===lt.id,getOptionLabel:$=>(d?$[d]:$.name)||"",options:D,noOptionsText:"Nenhuma opção",filterOptions:($,lt)=>{const S=js($,lt),{inputValue:W}=lt,et=$.some(xt=>W===xt.name);return b&&W!==""&&!et&&S.push({inputValue:W,name:T.replace("INPUTVALUE",W)}),S},renderOption:($,lt)=>w.createElement("li",{...$,key:`${lt.id}-${lt.name}`},lt.name),loading:at||K,renderInput:$=>(r&&$.inputProps.value===""&&($.inputProps.value=r),c.jsx(ht,{sx:{"& legend":{display:"none"},"& fieldset":{top:0},width:H||"inherit"},...$,label:a,error:g,placeholder:M,InputProps:{...$.InputProps,endAdornment:c.jsxs(w.Fragment,{children:[at||K?c.jsx(ps,{color:"inherit",size:20}):null,$.InputProps.endAdornment]})}})),...G})})}function Ct(){return c.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[c.jsx("circle",{cx:"12",cy:"12",r:"10"}),c.jsx("line",{x1:"15",y1:"9",x2:"9",y2:"15"}),c.jsx("line",{x1:"9",y1:"9",x2:"15",y2:"15"})]})}const Me=({onChange:a,data:n,sectionTitle:h,hasError:s})=>{const[i,r]=w.useState([]);w.useEffect(()=>{r(n?n.split(`
`):[])},[n]);const d=()=>{r([...i,""])},p=g=>{i.splice(g,1),r([...i]),a([...i].join(`
`))},_=(g,b)=>{let T=[...i];T[g]=b,r(T),a(T.join(`
`))};return c.jsxs(c.Fragment,{children:[h&&c.jsxs("div",{className:"section-header",children:[c.jsx("div",{className:"section-title",children:c.jsxs("div",{className:Xe.title,children:[s&&c.jsx("div",{className:`mr-2 ${Xe.error}`,children:c.jsx(Ct,{})}),h]})}),c.jsx("div",{className:"section-actions",children:c.jsxs("button",{className:"button-outline",onClick:()=>d(),children:[c.jsx(Nn,{}),"Adicionar"]})})]}),!h&&c.jsx("div",{className:Xe.new_line,children:c.jsxs("button",{className:"button-outline",onClick:()=>d(),children:[c.jsx(Nn,{}),"Adicionar"]})}),i&&i.map((g,b)=>c.jsx("div",{children:c.jsxs("div",{className:"row mb-3",children:[c.jsx("div",{className:"col-xs-11",children:c.jsx(ht,{className:"input-text",value:g,onChange:T=>_(b,T.target.value),multiline:!0,minRows:1,maxRows:5})}),c.jsx("div",{className:"col-xs-1",children:c.jsx("div",{className:Xe["svg-icon-box"],children:c.jsx("div",{children:c.jsx(Un,{title:"Remover",children:c.jsx(gr,{onClick:()=>p(b),children:c.jsx(Fn,{})})})})})})]},b)},b))]})},Ss=({onChange:a,data:n,sectionTitle:h})=>{const[s,i]=w.useState([]);w.useEffect(()=>{i(n||[])},[n]);const r=()=>{i([...s,{tel:"",nome:"",email:""}])},d=g=>{s.splice(g,1),i([...s]),_()},p=(g,b)=>T=>{let O=[...s];O[b][g]=T,i(O)},_=()=>{a(s)};return c.jsxs(c.Fragment,{children:[c.jsxs("div",{className:"section-header",children:[c.jsx("div",{className:"section-title",children:h}),c.jsx("div",{className:"section-actions",children:c.jsxs("button",{className:"button-outline",onClick:()=>r(),children:[c.jsx(Nn,{}),"Adicionar"]})})]}),s&&s.map((g,b)=>c.jsx("div",{children:c.jsxs("div",{className:"row mb-3",children:[c.jsx("div",{className:"col-xs-4",children:c.jsx(ht,{className:"input-text",label:"Nome",value:g.nome||"",onChange:T=>p("nome",b)(T.target.value),onBlur:_})}),c.jsx("div",{className:"col-xs-4",children:c.jsx(ht,{className:"input-text",label:"E-mail",value:g.email||"",onChange:T=>p("email",b)(T.target.value),onBlur:_})}),c.jsx("div",{className:"col-xs-3",children:c.jsx(ht,{className:"input-text",label:"Telefone",value:g.tel||"",onChange:T=>p("tel",b)(T.target.value),onBlur:_})}),c.jsx("div",{className:"col-xs-1",children:c.jsx("div",{className:Xe["svg-icon-box"],children:c.jsx("div",{children:c.jsx(Un,{title:"Remover",children:c.jsx(gr,{onClick:()=>d(b),children:c.jsx(Fn,{})})})})})})]},b)},b))]})},Cs="_error_1r416_45",Ds="_done_1r416_50",Ns="_indic_1r416_55",zs="_selected_1r416_59",Is="_field_1r416_63",Rs="_title_box_1r416_66",As="_tree_1r416_81",Bs="_li_lae_titles_1r416_92",Zs="_show_1r416_96",$s="_fade_in_show_1r416_1",Us="_hide_1r416_111",Fs="_li_indicators_1r416_114",Hs="_strong_1r416_125",Gs="_actions_1r416_151",Ws="_helpbox_button_1r416_157",Vs="_button_delete_1r416_164",qs="_Roll_1r416_1",F={error:Cs,done:Ds,indic:Ns,selected:zs,field:Is,title_box:Rs,tree:As,li_lae_titles:Bs,show:Zs,fade_in_show:$s,hide:Us,li_indicators:Fs,"item-container":"_item-container_1r416_118",strong:Hs,"indic-header":"_indic-header_1r416_137",actions:Gs,helpbox_button:Ws,button_delete:Vs,Roll:qs};function Ys(){return c.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",className:"feather feather-help-circle",children:[c.jsx("circle",{cx:"12",cy:"12",r:"10"}),c.jsx("path",{d:"M9.09 9a3 3 0 0 1 5.83 1c0 2-3 3-3 3"}),c.jsx("line",{x1:"12",y1:"17",x2:"12.01",y2:"17"})]})}function mt({keyRef:a,openHelpbox:n}){const{server:h}=ee(),[s,i]=w.useState(!1),[r,d]=w.useState(null),{data:p}=Vt(["help_content",{key_ref:r}],{queryFn:async()=>(await ut.get(`${h}helpbox/${r}`)).data,enabled:!!r});return w.useEffect(()=>{a&&d(a.join("."))},[a]),w.useEffect(()=>{i(!!p)},[p]),c.jsx(c.Fragment,{children:s&&c.jsx("button",{className:`button-link ${F.helpbox_button}`,onClick:()=>n(p.text),children:c.jsx(Ys,{})})})}const Ks=a=>w.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",width:24,height:24,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:2,strokeLinecap:"round",strokeLinejoin:"round",className:"feather feather-life-buoy",...a},w.createElement("circle",{cx:12,cy:12,r:10}),w.createElement("circle",{cx:12,cy:12,r:4}),w.createElement("line",{x1:4.93,y1:4.93,x2:9.17,y2:9.17}),w.createElement("line",{x1:14.83,y1:14.83,x2:19.07,y2:19.07}),w.createElement("line",{x1:14.83,y1:9.17,x2:19.07,y2:4.93}),w.createElement("line",{x1:14.83,y1:9.17,x2:18.36,y2:5.64}),w.createElement("line",{x1:4.93,y1:19.07,x2:9.17,y2:14.83}));function Ci({tab:a}){const{enqueueSnackbar:n,closeSnackbar:h}=ue(),{server:s}=ee(),{currentCommunity:i}=ii(),[r,d]=w.useState(!1),[p,_]=w.useState(""),[g,b]=w.useState(!1),[T,O]=w.useState({});w.useEffect(()=>{_(""),d(!1),O({})},[]);const H={request:ce(()=>ut.post(`${s}help/request`,{communityId:i.id,tab:a,text:p}))},M=()=>{d(!0)},G=async()=>{let v=!1,Z={};if(p.trim().length===0&&(Z.message=!0,v=!0),O(Z),v)return;b(!0);const D=n("Enviando pedido de ajuda...",{persist:!0,anchorOrigin:{vertical:"top",horizontal:"center"}});try{await H.request.mutateAsync(),h(D),n("Pedido de ajuda enviado com sucesso!",{variant:"success",anchorOrigin:{vertical:"top",horizontal:"right"}}),d(!1)}catch(z){h(D),console.error(z),n("Erro ao enviar pedido de ajuda!",{variant:"error",anchorOrigin:{vertical:"top",horizontal:"right"}})}finally{b(!1)}};return c.jsxs(c.Fragment,{children:[c.jsx("div",{style:{marginRight:"5px"},children:c.jsx(Un,{title:"Pedir ajuda",children:c.jsxs("button",{className:"button-outline",disabled:g,onClick:M,children:[c.jsx(Ks,{}),"Pedir ajuda sobre esta aba"]})})}),c.jsxs(Oi,{open:r,onClose:()=>d(!1),"aria-labelledby":"alert-dialog-title","aria-describedby":"alert-dialog-description",fullWidth:!0,maxWidth:"sm",children:[c.jsx(ki,{id:"alert-dialog-title",children:"Envio de pedido de ajuda"}),c.jsx(Se,{id:"alert-dialog-description",children:c.jsx("p",{className:"pt-1 px-3 pb-3",children:c.jsx(ht,{label:"Preencha este campo com sua dúvida",className:"input-text",value:p,onChange:v=>_(v.target.value),multiline:!0,rows:8,error:T.message})})}),c.jsxs(Mi,{children:[c.jsx("button",{className:"button-primary",onClick:G,children:"Enviar"}),c.jsx(ur,{onClick:()=>d(!1),autoFocus:!0,children:"Cancelar"})]})]})]})}function Js({projectId:a}){var j;const{server:n}=ee(),h=ji(),{enqueueSnackbar:s,closeSnackbar:i}=ue(),[r,d]=w.useState([]),[p,_]=w.useState(!1),[g,b]=w.useState({}),[T,O]=w.useState([]),[H,M]=w.useState(null),{data:G}=Vt(["project_info",{projectId:a}],{queryFn:async()=>(await ut.get(`${n}project/${a}/draft/info`)).data});w.useEffect(()=>{G&&d(G.project)},[G]),w.useEffect(()=>{if(r){if(!r.atuacao)return O([]);O(r.atuacao.map((P,I)=>({id:I,label:P,value:P})))}},[r]);const v=P=>I=>{_(!0);let Y={};if(P==="nome"){const{value:at,reason:A}=I;if(A==="clear")Y={...r,nome:"",indicado:null};else if(["input","reset"].includes(A))Y={...r,nome:at};else return}else{if(P==="indicado"&&!I)return;if(P==="atuacao"){const at=I.map(K=>K.value);Y={...r,atuacao:at};const A=Wa.difference(r.atuacao,at);if(A.length){let K=r.ufs.filter(B=>B.region!==A[0]);Y.ufs=K}}else Y={...r,[P]:I}}console.log(`changing ${P}:`,I,Y),d(Y)},Z=(P,I)=>async Y=>{console.log(`creating ${P}: ${Y}`);let at={entity:P,data:{name:Y}};if(I&&I.length)for(let K of I)at.data[K]=r[K];const{data:A}=await D.mutateAsync(at);return A},D=ce(({entity:P,data:I})=>ut.post(`${n}${P}/`,I),{onSuccess:()=>h.invalidateQueries(`project/${a}/draft/info`)}),z=ce(P=>{if(P)return ut.put(`${n}project/${a}/draft/info`,P)},{onSuccess:()=>h.invalidateQueries(`project/${a}/draft/info`)}),k=async()=>{if(_(!1),r.nome.trim().length===0){b({...g,nome:!0});return}if(["em_desenvolvimento","finalizada","interrompida"].includes(r.status_desenvolvimento)&&!r.mes_inicio){b({...g,mes_inicio:!0});return}if(["finalizada","interrompida"].includes(r.status_desenvolvimento)&&!r.mes_fim){b({...g,mes_fim:!0});return}b([]);const P=s("Gravando...",{persist:!0,anchorOrigin:{vertical:"top",horizontal:"right"}});try{await z.mutateAsync(r),h.invalidateQueries("project_indics"),i(P),s("Registro gravado com sucesso!",{variant:"success",anchorOrigin:{vertical:"top",horizontal:"right"}})}catch(I){i(P),console.error(I),s("Erro ao gravar o registro!",{variant:"error",anchorOrigin:{vertical:"top",horizontal:"right"}})}};return c.jsx(c.Fragment,{children:r&&c.jsx("div",{className:"page-content",children:c.jsxs("div",{className:"page-body",children:[c.jsx($n,{middle:!0,headerless:!0,children:c.jsxs("div",{className:"p-3",children:[c.jsxs("section",{id:"details",children:[c.jsxs("div",{className:"section-header",children:[c.jsx("div",{className:"section-title",children:"Detalhes da instituição"}),c.jsxs("div",{className:"section-actions",children:[c.jsx(Ci,{tab:"informacao"}),c.jsxs("button",{className:"button-primary",onClick:()=>k(),children:[c.jsx(ei,{}),"Gravar"]})]})]}),c.jsxs("div",{className:"row",children:[c.jsxs("div",{className:"col-xs-6",style:{display:"flex"},children:[c.jsx(te,{label:"Nome da instituição",url:"institution",onChange:v("instituicao_id"),creatable:!0,onCreate:Z("institution",["instituicao_id"]),value:r.instituicao_id}),c.jsx(mt,{keyRef:["instituicao_id"],openHelpbox:M})]}),c.jsxs("div",{className:"col-xs-4",style:{display:"flex"},children:[c.jsx(Sn,{label:"Segmento da instituição",url:"segmento/related",urlSingle:"segmento",onChange:v("instituicao_segmentos"),value:r.instituicao_segmentos,multiple:!0}),c.jsx(mt,{keyRef:["segmento"],openHelpbox:M})]}),c.jsxs("div",{className:"col-xs-2",style:{display:"flex"},children:[c.jsxs(ht,{select:!0,id:"money-select",label:"Porte da instituição",className:"input-select",value:r.instituicao_porte||"none",onChange:P=>v("instituicao_porte")(P.target.value),children:[c.jsx(nt,{value:"none",children:"Não respondido"}),c.jsx(nt,{value:"pequeno",children:"Pequeno"}),c.jsx(nt,{value:"medio",children:"Médio"}),c.jsx(nt,{value:"grande",children:"Grande"})]}),c.jsx(mt,{keyRef:["porte"],openHelpbox:M})]})]})]}),c.jsx("hr",{className:"hr-spacer my-4"}),c.jsxs("section",{id:"details",children:[c.jsx("div",{className:"section-header",children:c.jsx("div",{className:"section-title",children:"Detalhes da iniciativa"})}),c.jsx("div",{className:"row",children:c.jsxs("div",{className:"col-xs-12",style:{display:"flex"},children:[c.jsx(te,{label:"Nome da iniciativa",url:"project/list_all_indic",urlSingle:"project/draft/name",query:`?me=${a}`,invalidText:r.nome,value:r.indicado,onChange:v("indicado"),inputValue:r.nome||"",onInputChange:(P,I,Y)=>v("nome")({value:I,reason:Y}),freeSolo:!0,error:!p&&g.nome}),c.jsx(mt,{keyRef:["nome"],openHelpbox:M})]})}),c.jsxs("div",{className:"row",children:[c.jsxs("div",{className:"col-xs-4",style:{display:"flex"},children:[c.jsx(ds,{label:"Modalidade",url:"modality",onChange:v("modalidade_id"),value:r.modalidade_id}),c.jsx(mt,{keyRef:["modalidade_id"],openHelpbox:M})]}),c.jsxs("div",{className:"col-xs-4",style:{display:"flex"},children:[c.jsx(Sn,{label:"Regiões",url:"project/regions",titleField:"value",onChange:v("atuacao"),value:T,multiple:!0}),c.jsx(mt,{keyRef:["atuacao"],openHelpbox:M})]}),c.jsxs("div",{className:"col-xs-4",style:{display:"flex"},children:[c.jsx(Sn,{label:"Estados",url:"uf/related",urlSingle:"uf",query:`?f_regioes=${(j=r.atuacao)!=null&&j.length?r.atuacao.join(","):""}`,titleField:"value",onChange:v("ufs"),value:r.ufs,multiple:!0}),c.jsx(mt,{keyRef:["ufs"],openHelpbox:M})]})]}),c.jsxs("div",{className:"row",children:[c.jsxs("div",{className:"col-xs-6",style:{display:"flex"},children:[c.jsxs(ht,{select:!0,id:"money-select",label:"Situação do desenvolvimento",className:"input-select",value:r.status_desenvolvimento||"none",onChange:P=>v("status_desenvolvimento")(P.target.value),children:[c.jsx(nt,{value:"none",children:"Não respondido"}),c.jsx(nt,{value:"nao_iniciada",children:"Não iniciada"}),c.jsx(nt,{value:"em_desenvolvimento",children:"Em desenvolvimento"}),c.jsx(nt,{value:"finalizada",children:"Finalizada"}),c.jsx(nt,{value:"interrompida",children:"Interrompida"})]}),c.jsx(mt,{keyRef:["status_desenvolvimento"],openHelpbox:M})]}),c.jsx("div",{className:"col-xs-3",style:{display:"flex"},children:["em_desenvolvimento","finalizada","interrompida"].includes(r.status_desenvolvimento)&&c.jsx(Ko,{className:"input-datepicker",label:"Inicio do desenvolvimento",value:r.mes_inicio,onChange:v("mes_inicio"),views:["month","year"],inputFormat:"MM/yyyy",maxDate:r.mes_fim,error:!p&&g.mes_inicio})}),c.jsx("div",{className:"col-xs-3",style:{display:"flex"},children:["finalizada","interrompida"].includes(r.status_desenvolvimento)&&c.jsx(Ko,{className:"input-datepicker",label:"Término do desenvolvimento",value:r.mes_fim,onChange:v("mes_fim"),views:["month","year"],inputFormat:"MM/yyyy",minDate:r.mes_inicio,error:!p&&g.mes_fim})})]})]}),c.jsx("hr",{className:"hr-spacer my-4"}),c.jsx("section",{id:"contacts",children:c.jsx(Ss,{data:r.contatos,onChange:v("contatos"),sectionTitle:c.jsx(ke,{title:"Contatos",keyRef:["contatos"],openHelpbox:M})})}),c.jsx("hr",{className:"hr-spacer my-4"}),c.jsx("section",{id:"objectives",children:c.jsx(Me,{data:r.objetivos_txt,onChange:v("objetivos_txt"),sectionTitle:c.jsx(ke,{title:"Objetivos",keyRef:["objetivos_txt"],openHelpbox:M})})}),c.jsx("hr",{className:"hr-spacer my-4"}),c.jsx("section",{id:"general-aspects",children:c.jsx(Me,{data:r.aspectos_gerais_txt,onChange:v("aspectos_gerais_txt"),sectionTitle:c.jsx(ke,{title:"Aspectos gerais",keyRef:["aspectos_gerais_txt"],openHelpbox:M})})}),c.jsx("hr",{className:"hr-spacer my-4"}),c.jsx("section",{id:"public",children:c.jsx(Me,{data:r.publico_txt,onChange:v("publico_txt"),sectionTitle:c.jsx(ke,{title:"Público",keyRef:["publico_txt"],openHelpbox:M})})}),c.jsx("hr",{className:"hr-spacer my-4"}),c.jsx("section",{id:"partners",children:c.jsx(Me,{data:r.parceiros_txt,onChange:v("parceiros_txt"),sectionTitle:c.jsx(ke,{title:"Parceiros",keyRef:["parceiros_txt"],openHelpbox:M})})}),c.jsx("hr",{className:"hr-spacer my-4"}),c.jsx("section",{id:"period",children:c.jsx(Me,{data:r.periodo_txt,onChange:v("periodo_txt"),sectionTitle:c.jsx(ke,{title:"Período",keyRef:["periodo_txt"],openHelpbox:M})})}),c.jsx("hr",{className:"hr-spacer my-4"}),c.jsxs("section",{id:"politics",children:[c.jsx("div",{className:"section-header",children:c.jsxs("div",{className:"section-title",style:{display:"flex"},children:["Políticas públicas ",c.jsx(mt,{keyRef:["relacionado_ppea"],openHelpbox:M})]})}),c.jsx("div",{className:"row",children:c.jsx("div",{className:"col-xs-12",children:c.jsxs("small",{children:["A ação/projeto está vinculada, é decorrente ou é parte de alguma política pública de educação ambiental (federal, estadual, municipal ou de outro segmento não público)?",c.jsx(vr,{children:c.jsxs(gs,{direction:"row",spacing:1,alignItems:"center",children:[c.jsx("div",{children:"Não"}),c.jsx(_s,{className:"input-switch",checked:r.relacionado_ppea==="sim",onChange:P=>v("relacionado_ppea")(P.target.checked?"sim":"nao")}),c.jsx("div",{children:"Sim"})]})})]})})}),c.jsx("div",{className:"row",children:r.relacionado_ppea==="sim"&&c.jsx("div",{className:"col-xs-6",children:c.jsx(ht,{className:"input-text",label:"Qual PPEA?",value:r.qual_ppea||"",onChange:P=>v("qual_ppea")(P.target.value)})})})]}),c.jsxs("div",{className:"section-header",children:[c.jsx("div",{className:"section-title"}),c.jsx("div",{className:"section-actions",children:c.jsxs("button",{className:"button-primary",onClick:()=>k(),children:[c.jsx(ei,{}),"Gravar"]})})]})]})}),c.jsx(Hn,{content:H,onClose:()=>M(null)})]})})})}function ke({title:a,keyRef:n,openHelpbox:h}){return c.jsxs("div",{style:{display:"flex",alignItems:"center"},children:[c.jsx("div",{children:a})," ",c.jsx(mt,{keyRef:n,openHelpbox:h})]})}function Xs({projectId:a}){const{server:n}=ee(),h=ji(),{enqueueSnackbar:s,closeSnackbar:i}=ue(),{currentCommunity:r}=ii(),[d,p]=w.useState(null),[_,g]=w.useState([]),[b,T]=w.useState(null),{data:O}=Vt(["project_info",{projectId:a}],{queryFn:async()=>(await ut.get(`${n}project/${a}/draft/info`)).data,refetchOnWindowFocus:!1});w.useEffect(()=>{O&&p(O.project)},[O]),w.useEffect(()=>{console.log({errors:_})},[_]);const H=ce(v=>{if(v)return ut.put(`${n}project/${a}/draft/network`,{...v,communityId:r.id})},{onSuccess:()=>h.invalidateQueries(`project/${a}/draft/info`)}),M=(v,Z,D)=>z=>{let k={...d};if(console.log({prop:D,value:z}),Z!==void 0){let j=d[v][Z];if(D.includes("name")){const{value:P,reason:I}=z;if(I==="clear")j={...j,[D]:""};else if(["input","reset"].includes(I))j={...j,[D]:P};else return}else{if(v==="id"&&!z)return;j={...j,[D]:z}}D.includes("instituicao")&&(j={...j,iniciativa_id:null,iniciativa_name:""}),k[v][Z]=j}else k[v]=z;console.log(`changing ${v}:`,z,k),p(k)},G=async()=>{let v=[];if(d.pp_base==="none"&&v.push("pp_base"),d.apoiada_base==="none"&&v.push("apoiada_base"),d.apoia_base==="none"&&v.push("apoia_base"),d.pp_base==="sim"){let D=null;for(let z=0;z<5;z++)d.pp[z].name.length&&(D=z,d.pp[z].type.length||v.push(`pp_${z}_type`));if(D===null)v.push("pp_0_id");else for(let z=D;z>=0;z--)d.pp[z].name.length||v.push(`pp_${z}_id`)}if(["apoiada","apoia"].forEach(D=>{if(d[`${D}_base`]==="sim"){let z=null;for(let k=0;k<5;k++)(d[D][k].instituicao_name.length||d[D][k].iniciativa_name.length)&&(z=k,D==="apoia"&&d[D][k].iniciativa_name===""&&v.push(`apoia_${k}_iniciativa_id`),d[D][k].instituicao_name===""&&v.push(`${D}_${k}_instituicao_id`),d[D][k].type.length||v.push(`${D}_${k}_type`));if(z===null)v.push(`${D}_0_instituicao_id`);else for(let k=z;k>=0;k--)d[D][k].instituicao_name.length||v.push(`${D}_${k}_instituicao_id`)}}),g(v),v.length)return;const Z=s("Gravando...",{persist:!0,anchorOrigin:{vertical:"top",horizontal:"right"}});try{await H.mutateAsync(d),h.invalidateQueries("project_info"),h.invalidateQueries("project_indics"),i(Z),s("Registro gravado com sucesso!",{variant:"success",anchorOrigin:{vertical:"top",horizontal:"right"}})}catch(D){i(Z),console.error(D),s("Erro ao gravar o registro!",{variant:"error",anchorOrigin:{vertical:"top",horizontal:"right"}})}};return c.jsx(c.Fragment,{children:d&&c.jsx("div",{className:"page-content",children:c.jsxs("div",{className:"page-body",children:[c.jsx($n,{middle:!0,headerless:!0,children:c.jsxs("div",{className:"p-3",children:[c.jsxs("section",{id:"pp",children:[c.jsxs("div",{className:"section-header",children:[c.jsxs("div",{className:"section-title",style:{display:"flex",alignItems:"center"},children:[c.jsx("div",{children:"A ação/projeto se conecta com alguma Política Pública de Educação Ambiental?"}),c.jsx(mt,{keyRef:["politicas"],openHelpbox:T})]}),c.jsxs("div",{className:"section-actions",children:[c.jsx(Ci,{tab:"conexoes"}),c.jsxs("button",{className:"button-primary",onClick:()=>G(),children:[c.jsx(ei,{}),"Gravar"]})]})]}),c.jsx("div",{className:"row",children:c.jsx("div",{className:"col-xs-6",styles:{display:"flex"},children:c.jsxs(ht,{select:!0,id:"money-select",label:"",className:"input-text",value:d.pp_base,onChange:v=>M("pp_base")(v.target.value),error:_.includes("pp_base"),children:[c.jsx(nt,{value:"none",children:"Selecione uma opção"}),c.jsx(nt,{value:"sim",children:"Sim"}),c.jsx(nt,{value:"nao",children:"Não"})]})})})]}),d.pp_base==="sim"&&c.jsxs("section",{id:"pp_detalhe",children:[c.jsx("div",{className:"section-header",children:c.jsx("div",{className:"section-title",children:"Indique as políticas em ordem de relevância"})}),[0,1,2,3,4].map(v=>{var Z,D,z,k;return c.jsxs("div",{className:"row",children:[c.jsx("div",{className:"col-xs-3",children:c.jsx(te,{label:`Política ${v+1}`,url:"policy",value:(Z=d.pp[v])==null?void 0:Z.id,onChange:M("pp",v,"id"),inputValue:((D=d.pp[v])==null?void 0:D.name)||"",onInputChange:(j,P,I)=>M("pp",v,"name")({value:P,reason:I}),freeSolo:!0,error:_.includes(`pp_${v}_id`)})}),c.jsx("div",{className:"col-xs-6",children:c.jsx(Ei,{multiple:!0,id:"fixed-tags-demo",className:"input-autocomplete",value:(z=d.pp[v])==null?void 0:z.type,onChange:(j,P)=>M("pp",v,"type")(P),options:[{value:"principios",title:"Alinhamento com princípios e diretrizes"},{value:"instrumentos",title:"Atuação em instrumentos específicos"},{value:"planos",title:"Atuação em planos e programas conectados à política"},{value:"atividades",title:"Atuação em atividades vinculadas à política"}],getOptionLabel:j=>j.title,renderTags:(j,P)=>j.map((I,Y)=>c.jsx(jn,{label:I.title,...P({index:Y})})),renderInput:j=>c.jsx(ht,{...j,label:"Relação",error:_.includes(`pp_${v}_type`)})})}),c.jsx("div",{className:"col-xs-3",children:c.jsx(ht,{className:"input-text",id:"text-email",label:"Outra relação",value:(k=d.pp[v])==null?void 0:k.other_type,onChange:j=>M("pp",v,"other_type")(j.target.value)})})]},v)})]}),c.jsx("hr",{className:"hr-spacer my-4"}),c.jsxs("section",{id:"apoiada",children:[c.jsx("div",{className:"section-header",children:c.jsxs("div",{className:"section-title",style:{display:"flex",alignItems:"center"},children:[c.jsxs("div",{children:["A sua iniciativa (ação ou projeto) ",c.jsx("strong",{children:"é apoiada ou recebe algum suporte"})," de alguma outra instituição para viabilizar suas ações?"]}),c.jsx(mt,{keyRef:["apoiada"],openHelpbox:T})]})}),c.jsx("div",{className:"row",children:c.jsx("div",{className:"col-xs-6",styles:{display:"flex"},children:c.jsxs(ht,{select:!0,id:"money-select",label:"",className:"input-text",value:d.apoiada_base,onChange:v=>M("apoiada_base")(v.target.value),error:_.includes("apoiada_base"),children:[c.jsx(nt,{value:"none",children:"Selecione uma opção"}),c.jsx(nt,{value:"sim",children:"Sim"}),c.jsx(nt,{value:"nao",children:"Não"})]})})})]}),d.apoiada_base==="sim"&&c.jsxs("section",{id:"apoiada_detalhe",children:[c.jsx("div",{className:"section-header",children:c.jsx("div",{className:"section-title",children:"Indique as instituições em ordem de relevância"})}),[0,1,2,3,4].map(v=>{var Z,D,z,k,j,P,I,Y,at;return c.jsxs("div",{className:"row",children:[c.jsx("div",{className:"col-xs-3",children:c.jsx(te,{label:`Instituição ${v+1}`,url:"institution",value:(Z=d.apoiada[v])==null?void 0:Z.instituicao_id,onChange:M("apoiada",v,"instituicao_id"),inputValue:((D=d.apoiada[v])==null?void 0:D.instituicao_name)||"",onInputChange:(A,K,B)=>M("apoiada",v,"instituicao_name")({value:K,reason:B}),freeSolo:!0,error:_.includes(`apoiada_${v}_instituicao_id`)})}),c.jsx("div",{className:"col-xs-3",children:c.jsx(te,{label:`Iniciativa ${v+1}`,url:"project/opt_relations",urlSingle:"project/opt_relations",query:`?${(z=d.apoiada[v])!=null&&z.instituicao_id?`&institution=${(k=d.apoiada[v])==null?void 0:k.instituicao_id}`:(j=d.apoiada[v])!=null&&j.instituicao_name.length?"&institution=0":""}`,value:(P=d.apoiada[v])==null?void 0:P.iniciativa_id,onChange:M("apoiada",v,"iniciativa_id"),inputValue:((I=d.apoiada[v])==null?void 0:I.iniciativa_name)||"",onInputChange:(A,K,B)=>M("apoiada",v,"iniciativa_name")({value:K,reason:B}),freeSolo:!0})}),c.jsx("div",{className:"col-xs-3",children:c.jsx(Ei,{multiple:!0,id:"fixed-tags-demo",className:"input-autocomplete",value:(Y=d.apoiada[v])==null?void 0:Y.type,onChange:(A,K)=>M("apoiada",v,"type")(K),options:[{value:"financiamento",title:"Fomento financeiro/financiamento"},{value:"infraestrutura",title:"Compartilhamento de infraestrutura"},{value:"rh",title:"Compartilhamento de recursos humanos"},{value:"info",title:"Compartilhamento de informações"}],getOptionLabel:A=>A.title,renderTags:(A,K)=>A.map((B,$)=>c.jsx(jn,{label:B.title,...K({index:$})})),renderInput:A=>c.jsx(ht,{...A,label:"Relação",error:_.includes(`apoiada_${v}_type`)})})}),c.jsx("div",{className:"col-xs-3",children:c.jsx(ht,{className:"input-text",id:"text-email",label:"Outra relação",value:(at=d.apoiada[v])==null?void 0:at.other_type,onChange:A=>M("apoiada",v,"other_type")(A.target.value)})})]},v)})]}),c.jsx("hr",{className:"hr-spacer my-4"}),c.jsxs("section",{id:"apoia",children:[c.jsx("div",{className:"section-header",children:c.jsxs("div",{className:"section-title",style:{display:"flex",alignItems:"center"},children:[c.jsxs("div",{children:["A sua iniciativa (ação ou projeto) ",c.jsx("strong",{children:"apoia ou dá algum tipo de suporte"})," a outra ação/projeto na Zona Costeira e Marinha do Brasil?"]}),c.jsx(mt,{keyRef:["apoia"],openHelpbox:T})]})}),c.jsx("div",{className:"row",children:c.jsx("div",{className:"col-xs-6",styles:{display:"flex"},children:c.jsxs(ht,{select:!0,id:"money-select",label:"",className:"input-text",value:d.apoia_base,onChange:v=>M("apoia_base")(v.target.value),error:_.includes("apoia_base"),children:[c.jsx(nt,{value:"none",children:"Selecione uma opção"}),c.jsx(nt,{value:"sim",children:"Sim"}),c.jsx(nt,{value:"nao",children:"Não"})]})})})]}),d.apoia_base==="sim"&&c.jsxs("section",{id:"apoia_detalhe",children:[c.jsx("div",{className:"section-header",children:c.jsx("div",{className:"section-title",children:"Indique as iniciativas em ordem de relevância"})}),[0,1,2,3,4].map(v=>{var Z,D,z,k,j,P,I,Y,at;return c.jsxs("div",{className:"row",children:[c.jsx("div",{className:"col-xs-3",children:c.jsx(te,{label:`Instituição ${v+1}`,url:"institution",value:(Z=d.apoia[v])==null?void 0:Z.instituicao_id,onChange:M("apoia",v,"instituicao_id"),inputValue:((D=d.apoia[v])==null?void 0:D.instituicao_name)||"",onInputChange:(A,K,B)=>M("apoia",v,"instituicao_name")({value:K,reason:B}),freeSolo:!0,error:_.includes(`apoia_${v}_instituicao_id`)})}),c.jsx("div",{className:"col-xs-3",children:c.jsx(te,{label:`Iniciativa ${v+1}`,url:"project/opt_relations",urlSingle:"project/opt_relations",query:`?${(z=d.apoia[v])!=null&&z.instituicao_id?`&institution=${(k=d.apoia[v])==null?void 0:k.instituicao_id}`:(j=d.apoia[v])!=null&&j.instituicao_name.length?"&institution=0":""}`,value:(P=d.apoia[v])==null?void 0:P.iniciativa_id,onChange:M("apoia",v,"iniciativa_id"),inputValue:((I=d.apoia[v])==null?void 0:I.iniciativa_name)||"",onInputChange:(A,K,B)=>M("apoia",v,"iniciativa_name")({value:K,reason:B}),freeSolo:!0,error:_.includes(`apoia_${v}_iniciativa_id`)})}),c.jsx("div",{className:"col-xs-3",children:c.jsx(Ei,{multiple:!0,id:"fixed-tags-demo",className:"input-autocomplete",value:(Y=d.apoia[v])==null?void 0:Y.type,onChange:(A,K)=>M("apoia",v,"type")(K),options:[{value:"financiamento",title:"Fomento financeiro/financiamento"},{value:"infraestrutura",title:"Compartilhamento de infraestrutura"},{value:"rh",title:"Compartilhamento de recursos humanos"},{value:"info",title:"Compartilhamento de informações"}],getOptionLabel:A=>A.title,renderTags:(A,K)=>A.map((B,$)=>c.jsx(jn,{label:B.title,...K({index:$})})),renderInput:A=>c.jsx(ht,{...A,label:"Relação",error:_.includes(`apoia_${v}_type`)})})}),c.jsx("div",{className:"col-xs-3",children:c.jsx(ht,{className:"input-text",id:"text-email",label:"Outra relação",value:(at=d.apoia[v])==null?void 0:at.other_type,onChange:A=>M("apoia",v,"other_type")(A.target.value)})})]},v)})]}),c.jsxs("div",{className:"section-header",children:[c.jsx("div",{className:"section-title"}),c.jsx("div",{className:"section-actions",children:c.jsxs("button",{className:"button-primary",onClick:()=>G(),children:[c.jsx(ei,{}),"Gravar"]})})]})]})}),c.jsx(Hn,{content:b,onClose:()=>T(null)})]})})})}wt.forwardRef(function(a,n){const{onChange:h,...s}=a;return c.jsx(Si,{...s,getInputRef:n,onValueChange:i=>{h({target:{name:a.name,value:parseFloat(i.value)}})},decimalSeparator:",",thousandSeparator:".",allowNegative:!1,fixedDecimalScale:!0,decimalScale:2})});const Qs=wt.forwardRef(function(a,n){const{onChange:h,...s}=a;return c.jsx(Si,{...s,getInputRef:n,onValueChange:i=>{h({target:{name:a.name,value:parseInt(i.value,10)}})},decimalSeparator:!1,thousandSeparator:".",allowNegative:!1})});wt.forwardRef(function(a,n){const{onChange:h,...s}=a;return c.jsx(Si,{...s,getInputRef:n,onValueChange:i=>{h({target:{name:a.name,value:parseFloat(i.value)}})},decimalSeparator:",",thousandSeparator:".",allowNegative:!1,fixedDecimalScale:!0,decimalScale:2})});wt.forwardRef(function(a,n){const{onChange:h,...s}=a;return c.jsx(Si,{...s,getInputRef:n,onValueChange:i=>{h({target:{name:a.name,value:i.value}})},format:"###.###.###-##"})});function yr(){return c.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[c.jsx("path",{d:"M22 11.08V12a10 10 0 1 1-5.93-9.14"}),c.jsx("polyline",{points:"22 4 12 14.01 9 11.01"})]})}function tl(a){let n=[];for(let h of Object.keys(a.analysis.dims)){const s=a.analysis.dims[h];s.id=h,s.indics=[],n.push(s)}for(let h of Object.keys(a.analysis.indics)){const s=a.analysis.indics[h];s.id=h;const i=h.split("_")[0];n.find(r=>r.id===i).indics.push(s)}return n}const Gt={INT:1,TEXT:2,TEXT_M:3,SEL_S:5,SEL_M:6,SEL_SO:7,SEL_MO:8,ITEMS:9,SN:10};function el({analysis:a}){const{currentCommunity:n,changeRoute:h,params:s}=ii(),{server:i}=ee(),r=ji(),{enqueueSnackbar:d,closeSnackbar:p}=ue(),[_,g]=w.useState(null),[b,T]=w.useState(null),[O,H]=w.useState(null),[M,G]=w.useState([]),[v,Z]=w.useState(!1),[D,z]=w.useState(null),[k,j]=w.useState(null),[P,I]=w.useState(null),[Y,at]=w.useState(null),[A,K]=w.useReducer((C,ot)=>{switch(ot.type){case"setup":return ot.payload;case"change":return console.log("change",ot.payload.question,ot.payload.value),{...C,[ot.payload.question]:ot.payload.value};default:return C}},null),{data:B}=Vt("project",{queryFn:async()=>(await ut.get(`${i}project/id_from_community/${n.id}`)).data}),{data:$}=Vt(["indic_data",{project_id:B==null?void 0:B.id,currentIndics:b}],{queryFn:async()=>(await ut.get(`${i}project/${B==null?void 0:B.id}/indic/${b}`)).data,enabled:!!(B!=null&&B.id)&&!!b}),lt=ce(()=>ut.put(`${i}project/${B==null?void 0:B.id}/indic/${b}`,A),{onSuccess:()=>{r.invalidateQueries("indic_data"),r.invalidateQueries("project_indics")}});w.useEffect(()=>{a&&g(tl(a)),console.log("analysis",a)},[a]),w.useEffect(()=>{s&&s[1]?T(s[1]):T("1_1")},[s]),w.useEffect(()=>{b&&j(b.split("_")[0])},[b]),w.useEffect(()=>{async function C(){await K({type:"setup",payload:$.data}),Z(!1)}$&&(console.log("indicData",$),H($.indic),G($.problems),C())},[$]),w.useEffect(()=>{},[M]);const S=C=>ot=>{K({type:"change",payload:{question:C,value:ot}}),Z(!0)},W=C=>!v&&M.includes(`${b}_${C}`),et=async()=>{const C=d("Gravando...",{persist:!0,anchorOrigin:{vertical:"top",horizontal:"right"}});try{await lt.mutateAsync(),r.invalidateQueries("project_indics"),p(C),d("Indicador gravado com sucesso!",{variant:"success",anchorOrigin:{vertical:"top",horizontal:"right"}}),Z(!1)}catch(ot){p(C),console.error(ot),d("Erro ao gravar o indicador!",{variant:"error",anchorOrigin:{vertical:"top",horizontal:"right"}})}},xt=async()=>{await K({type:"setup",payload:$.data}),Z(!1)},R=(C,ot)=>()=>{I(ot),v?z(C):h({params:["indicadores",C]})},fe=C=>{I(P!==C?C:null)},J=async C=>{C==="confirm"&&h({params:["indicadores",D]}),z(null)};return c.jsxs(c.Fragment,{children:[c.jsxs("div",{className:"page-content",children:[c.jsx("div",{className:"page-sidebar",children:c.jsx("div",{className:`sidebar-body ${F.tree}`,children:_&&c.jsx("ul",{children:_.map(C=>c.jsxs("li",{className:`mb-3 ${F.li_lae_titles}`,onClick:()=>fe(C.id),children:[c.jsx(Jo,{title:C.title,ready:C.ready,className:k===C.id||P===C.id?F.strong:""}),c.jsx("ul",{className:`${k===C.id||P===C.id?F.show:F.hide}`,children:C.indics.map(ot=>c.jsx("li",{className:`${F.li_indicators}`,onClick:R(ot.id,C.id),children:c.jsx(Jo,{title:ot.title,ready:ot.ready,className:`${F.indic} ${b===ot.id?F.selected:""}`})},ot.id))})]},C.id))})})}),c.jsxs("div",{className:"page-body",children:[O&&c.jsx(ys,{sx:{button:{color:"inherit"}},headerless:!0,children:c.jsxs("div",{className:"p-3",children:[c.jsxs("div",{className:`${F["indic-header"]} mb-3`,children:[c.jsx("div",{className:`${F.title_box}`,children:c.jsx("strong",{children:`${O.lae_title} >> ${O.name}`})}),c.jsxs("div",{className:F.actions,children:[c.jsx(Ci,{tab:"indicadores"}),c.jsx("button",{className:"button-primary",onClick:et,disabled:!v,children:"Gravar"}),c.jsx("button",{className:F.button_delete,onClick:xt,disabled:!v,children:"Restaurar"})]})]}),c.jsx("div",{children:c.jsx(Xo,{question:{title:O.base_question,type:"base"},data:A==null?void 0:A.base,onChange:S("base"),hasError:W("base"),keyRef:[O.lae_id,O.id,"base"],openHelpbox:C=>at(C)})}),A&&A.base==="sim"&&c.jsx("div",{children:O.questions.map(C=>c.jsx(Xo,{question:C,data:A?A[C.id]:null,onChange:S(C.id),hasError:W(C.id),keyRef:[O.lae_id,O.id,C.id],openHelpbox:ot=>at(ot)},C.id))})]})}),c.jsx(Hn,{content:Y,onClose:()=>at(null)})]})]}),c.jsx(pr,{open:!!D,content:"Você deseja sair do indicador sem salvar as alterações?",confirmButtonText:"Confirmar",onClose:J})]})}function Jo({title:a,ready:n,className:h}){let s=n?c.jsx(yr,{}):c.jsx(Ct,{});return c.jsxs("div",{className:`${F["item-container"]} ${h}`,children:[c.jsx("div",{className:`${F[n?"done":"error"]}`,children:s}),c.jsx("div",{children:a})]})}function Xo({question:{title:a,type:n,options:h},data:s,hasError:i,onChange:r,keyRef:d,openHelpbox:p}){return c.jsxs("div",{className:`${F.field}`,children:[n==="base"&&c.jsxs(At,{fullWidth:!0,children:[c.jsx(Wt,{id:"base-label",children:c.jsxs("div",{className:F.title_box,children:[i&&c.jsx("div",{className:`${F.error}`,children:c.jsx(Ct,{})}),c.jsx("div",{className:`${F["form-label-title"]}`,children:a}),c.jsx(mt,{keyRef:d,openHelpbox:p})]})}),c.jsxs(ti,{id:"base-select",value:s||"none",onChange:_=>r(_.target.value),className:"input-select",children:[c.jsx(nt,{value:"none",children:" -- Selecione -- "}),c.jsx(nt,{value:"sim",children:"Sim"}),c.jsx(nt,{value:"nao",children:"Não"}),c.jsx(nt,{value:"nao_aplica",children:"Não se aplica"})]})]}),n===Gt.INT&&c.jsxs(At,{fullWidth:!0,children:[c.jsx(Wt,{id:"int-label",children:c.jsxs("div",{className:F.title_box,children:[i&&c.jsx("div",{className:`${F.error}`,children:c.jsx(Ct,{})}),c.jsx("div",{className:`${F["form-label-title"]}`,children:a}),c.jsx(mt,{keyRef:d,openHelpbox:p})]})}),c.jsx(ht,{className:"input-text",sx:{maxWidth:"200px",width:"50%"},value:s||"",onChange:_=>r(_.target.value||""),InputProps:{inputComponent:Qs}})]}),n===Gt.TEXT&&c.jsxs(At,{fullWidth:!0,children:[c.jsx(Wt,{id:"text-label",children:c.jsxs("div",{className:F.title_box,children:[i&&c.jsx("div",{className:`${F.error}`,children:c.jsx(Ct,{})}),c.jsx("div",{className:`${F["form-label-title"]}`,children:a}),c.jsx(mt,{keyRef:d,openHelpbox:p})]})}),c.jsx(ht,{className:"input-text",value:s||"",onChange:_=>r(_.target.value)})]}),n===Gt.TEXT_M&&c.jsxs(At,{fullWidth:!0,children:[c.jsx(Wt,{id:"text-label",children:c.jsxs("div",{className:F.title_box,children:[i&&c.jsx("div",{className:`${F.error}`,children:c.jsx(Ct,{})}),c.jsx("div",{className:`${F["form-label-title"]}`,children:a}),c.jsx(mt,{keyRef:d,openHelpbox:p})]})}),c.jsx(ht,{className:"input-text",value:s||"",onChange:_=>r(_.target.value),multiline:!0,rows:4})]}),n===Gt.SEL_S&&c.jsxs(At,{fullWidth:!0,children:[c.jsx(Wt,{id:"sels-label",children:c.jsxs("div",{className:F.title_box,children:[i&&c.jsx("div",{className:`${F.error}`,children:c.jsx(Ct,{})}),c.jsx("div",{className:`${F["form-label-title"]}`,children:a}),c.jsx(mt,{keyRef:d,openHelpbox:p})]})}),c.jsxs(ti,{id:"base-select",value:s||"none",onChange:_=>r(_.target.value),className:"input-select",children:[c.jsx(nt,{value:"none",children:" -- Selecione -- "}),h&&h.map(_=>c.jsx(nt,{value:_.value,children:_.title},_.value))]})]}),n===Gt.SEL_M&&c.jsx(c.Fragment,{children:c.jsx(Lr,{title:a,value:s||[],options:h,onChange:r,hasError:i,keyRef:d,openHelpbox:p})}),n===Gt.SEL_SO&&c.jsx(il,{title:a,value:s||"none",options:h,onChange:r,hasError:i,keyRef:d,openHelpbox:p}),n===Gt.SEL_MO&&c.jsx(nl,{title:a,value:s||[],options:h,onChange:r,hasError:i,keyRef:d,openHelpbox:p}),n===Gt.ITEMS&&c.jsx(c.Fragment,{children:c.jsxs(At,{fullWidth:!0,children:[c.jsx(Wt,{id:"sn-label",children:c.jsxs("div",{className:F.title_box,children:[i&&c.jsx("div",{className:`${F.error}`,children:c.jsx(Ct,{})}),c.jsx("div",{className:`${F["form-label-title"]}`,children:a}),c.jsx(mt,{keyRef:d,openHelpbox:p})]})}),c.jsx(Me,{data:s||"",onChange:r})]})}),n===Gt.SN&&c.jsxs(At,{fullWidth:!0,children:[c.jsx(Wt,{id:"sn-label",children:c.jsxs("div",{className:F.title_box,children:[i&&c.jsx("div",{className:`${F.error}`,children:c.jsx(Ct,{})}),c.jsx("div",{className:`${F["form-label-title"]}`,children:a}),c.jsx(mt,{keyRef:d,openHelpbox:p})]})}),c.jsxs(ti,{id:"sn-select",value:s||"none",onChange:_=>r(_.target.value),className:"input-select",children:[c.jsx(nt,{value:"none",children:" -- Selecione -- "}),c.jsx(nt,{value:"sim",children:"Sim"}),c.jsx(nt,{value:"nao",children:"Não"})]})]}),c.jsx("hr",{className:"hr-spacer my-4"})]})}function Lr({title:a,value:n,options:h,hasError:s,onChange:i,keyRef:r,openHelpbox:d}){const p=_=>g=>{g.target.checked?i([...n,_]):i(n.filter(b=>b!==_))};return c.jsxs(At,{fullWidth:!0,children:[c.jsx(Wt,{id:"base-label",children:c.jsxs("div",{className:F.title_box,children:[s&&c.jsx("div",{className:`${F.error}`,children:c.jsx(Ct,{})}),c.jsx("div",{className:`${F["form-label-title"]}`,children:a}),c.jsx(mt,{keyRef:r,openHelpbox:d})]})}),c.jsx(vr,{children:h&&h.map(_=>c.jsx(vs,{control:c.jsx(fs,{checked:n&&n.includes(_.value),onChange:p(_.value),name:_.title}),label:_.title},_.value))})]})}function il({title:a,value:n,options:h,hasError:s,onChange:i,keyRef:r,openHelpbox:d}){const p=_=>g=>{i({...n,[_]:g.target.value})};return c.jsxs(c.Fragment,{children:[c.jsx("div",{className:"row",children:c.jsx("div",{className:"col-md-12",children:c.jsxs(At,{fullWidth:!0,children:[c.jsx(Wt,{id:"so-label",children:c.jsxs("div",{className:F.title_box,children:[s&&c.jsx("div",{className:`${F.error}`,children:c.jsx(Ct,{})}),c.jsx("div",{className:`${F["form-label-title"]}`,children:a}),c.jsx(mt,{keyRef:r,openHelpbox:d})]})}),c.jsxs(ti,{id:"base-select",value:n?n.value:"none",onChange:p("value"),className:"input-select",children:[c.jsx(nt,{value:"none",children:" -- Selecione -- "}),h&&h.map(_=>c.jsx(nt,{value:_.value,children:_.title},_.value))]})]})})}),c.jsx("div",{className:"row",children:c.jsx("div",{className:"col-md-12",children:c.jsx(ht,{className:"input-text",label:"outro",value:n&&n.other||"",onChange:p("other")})})})]})}function nl({title:a,value:n,options:h,hasError:s,onChange:i,keyRef:r,openHelpbox:d}){const p=_=>g=>{i({...n,[_]:g})};return c.jsxs(c.Fragment,{children:[c.jsx("div",{className:"row",children:c.jsx("div",{className:"col-md-12",children:c.jsx(Lr,{title:a,value:n&&n.items?n.items:[],options:h,onChange:p("items"),hasError:s,keyRef:r,openHelpbox:d})})}),c.jsx("div",{className:"row",children:c.jsx("div",{className:"col-md-12",children:c.jsx(ht,{className:"input-text",label:"outro",value:n&&n.other||"",onChange:_=>p("other")(_.target.value)})})})]})}var zn={exports:{}};/* @preserve
 * Leaflet 1.3.4, a JS library for interactive maps. http://leafletjs.com
 * (c) 2010-2018 Vladimir Agafonkin, (c) 2010-2011 CloudMade
 */(function(a,n){(function(h,s){s(n)})($a,function(h){var s="1.3.4",i=Object.freeze;Object.freeze=function(t){return t};function r(t){var e,o,l,u;for(o=1,l=arguments.length;o<l;o++){u=arguments[o];for(e in u)t[e]=u[e]}return t}var d=Object.create||function(){function t(){}return function(e){return t.prototype=e,new t}}();function p(t,e){var o=Array.prototype.slice;if(t.bind)return t.bind.apply(t,o.call(arguments,1));var l=o.call(arguments,2);return function(){return t.apply(e,l.length?l.concat(o.call(arguments)):arguments)}}var _=0;function g(t){return t._leaflet_id=t._leaflet_id||++_,t._leaflet_id}function b(t,e,o){var l,u,f,m;return m=function(){l=!1,u&&(f.apply(o,u),u=!1)},f=function(){l?u=arguments:(t.apply(o,arguments),setTimeout(m,e),l=!0)},f}function T(t,e,o){var l=e[1],u=e[0],f=l-u;return t===l&&o?t:((t-u)%f+f)%f+u}function O(){return!1}function H(t,e){var o=Math.pow(10,e===void 0?6:e);return Math.round(t*o)/o}function M(t){return t.trim?t.trim():t.replace(/^\s+|\s+$/g,"")}function G(t){return M(t).split(/\s+/)}function v(t,e){t.hasOwnProperty("options")||(t.options=t.options?d(t.options):{});for(var o in e)t.options[o]=e[o];return t.options}function Z(t,e,o){var l=[];for(var u in t)l.push(encodeURIComponent(o?u.toUpperCase():u)+"="+encodeURIComponent(t[u]));return(!e||e.indexOf("?")===-1?"?":"&")+l.join("&")}var D=/\{ *([\w_-]+) *\}/g;function z(t,e){return t.replace(D,function(o,l){var u=e[l];if(u===void 0)throw new Error("No value provided for variable "+o);return typeof u=="function"&&(u=u(e)),u})}var k=Array.isArray||function(t){return Object.prototype.toString.call(t)==="[object Array]"};function j(t,e){for(var o=0;o<t.length;o++)if(t[o]===e)return o;return-1}var P="data:image/gif;base64,R0lGODlhAQABAAD/ACwAAAAAAQABAAACADs=";function I(t){return window["webkit"+t]||window["moz"+t]||window["ms"+t]}var Y=0;function at(t){var e=+new Date,o=Math.max(0,16-(e-Y));return Y=e+o,window.setTimeout(t,o)}var A=window.requestAnimationFrame||I("RequestAnimationFrame")||at,K=window.cancelAnimationFrame||I("CancelAnimationFrame")||I("CancelRequestAnimationFrame")||function(t){window.clearTimeout(t)};function B(t,e,o){if(o&&A===at)t.call(e);else return A.call(window,p(t,e))}function $(t){t&&K.call(window,t)}var lt=(Object.freeze||Object)({freeze:i,extend:r,create:d,bind:p,lastId:_,stamp:g,throttle:b,wrapNum:T,falseFn:O,formatNum:H,trim:M,splitWords:G,setOptions:v,getParamString:Z,template:z,isArray:k,indexOf:j,emptyImageUrl:P,requestFn:A,cancelFn:K,requestAnimFrame:B,cancelAnimFrame:$});function S(){}S.extend=function(t){var e=function(){this.initialize&&this.initialize.apply(this,arguments),this.callInitHooks()},o=e.__super__=this.prototype,l=d(o);l.constructor=e,e.prototype=l;for(var u in this)this.hasOwnProperty(u)&&u!=="prototype"&&u!=="__super__"&&(e[u]=this[u]);return t.statics&&(r(e,t.statics),delete t.statics),t.includes&&(W(t.includes),r.apply(null,[l].concat(t.includes)),delete t.includes),l.options&&(t.options=r(d(l.options),t.options)),r(l,t),l._initHooks=[],l.callInitHooks=function(){if(!this._initHooksCalled){o.callInitHooks&&o.callInitHooks.call(this),this._initHooksCalled=!0;for(var f=0,m=l._initHooks.length;f<m;f++)l._initHooks[f].call(this)}},e},S.include=function(t){return r(this.prototype,t),this},S.mergeOptions=function(t){return r(this.prototype.options,t),this},S.addInitHook=function(t){var e=Array.prototype.slice.call(arguments,1),o=typeof t=="function"?t:function(){this[t].apply(this,e)};return this.prototype._initHooks=this.prototype._initHooks||[],this.prototype._initHooks.push(o),this};function W(t){if(!(typeof L>"u"||!L||!L.Mixin)){t=k(t)?t:[t];for(var e=0;e<t.length;e++)t[e]===L.Mixin.Events&&console.warn("Deprecated include of L.Mixin.Events: this property will be removed in future releases, please inherit from L.Evented instead.",new Error().stack)}}var et={on:function(t,e,o){if(typeof t=="object")for(var l in t)this._on(l,t[l],e);else{t=G(t);for(var u=0,f=t.length;u<f;u++)this._on(t[u],e,o)}return this},off:function(t,e,o){if(!t)delete this._events;else if(typeof t=="object")for(var l in t)this._off(l,t[l],e);else{t=G(t);for(var u=0,f=t.length;u<f;u++)this._off(t[u],e,o)}return this},_on:function(t,e,o){this._events=this._events||{};var l=this._events[t];l||(l=[],this._events[t]=l),o===this&&(o=void 0);for(var u={fn:e,ctx:o},f=l,m=0,y=f.length;m<y;m++)if(f[m].fn===e&&f[m].ctx===o)return;f.push(u)},_off:function(t,e,o){var l,u,f;if(this._events&&(l=this._events[t],!!l)){if(!e){for(u=0,f=l.length;u<f;u++)l[u].fn=O;delete this._events[t];return}if(o===this&&(o=void 0),l)for(u=0,f=l.length;u<f;u++){var m=l[u];if(m.ctx===o&&m.fn===e){m.fn=O,this._firingCount&&(this._events[t]=l=l.slice()),l.splice(u,1);return}}}},fire:function(t,e,o){if(!this.listens(t,o))return this;var l=r({},e,{type:t,target:this,sourceTarget:e&&e.sourceTarget||this});if(this._events){var u=this._events[t];if(u){this._firingCount=this._firingCount+1||1;for(var f=0,m=u.length;f<m;f++){var y=u[f];y.fn.call(y.ctx||this,l)}this._firingCount--}}return o&&this._propagateEvent(l),this},listens:function(t,e){var o=this._events&&this._events[t];if(o&&o.length)return!0;if(e){for(var l in this._eventParents)if(this._eventParents[l].listens(t,e))return!0}return!1},once:function(t,e,o){if(typeof t=="object"){for(var l in t)this.once(l,t[l],e);return this}var u=p(function(){this.off(t,e,o).off(t,u,o)},this);return this.on(t,e,o).on(t,u,o)},addEventParent:function(t){return this._eventParents=this._eventParents||{},this._eventParents[g(t)]=t,this},removeEventParent:function(t){return this._eventParents&&delete this._eventParents[g(t)],this},_propagateEvent:function(t){for(var e in this._eventParents)this._eventParents[e].fire(t.type,r({layer:t.target,propagatedFrom:t.target},t),!0)}};et.addEventListener=et.on,et.removeEventListener=et.clearAllEventListeners=et.off,et.addOneTimeEventListener=et.once,et.fireEvent=et.fire,et.hasEventListeners=et.listens;var xt=S.extend(et);function R(t,e,o){this.x=o?Math.round(t):t,this.y=o?Math.round(e):e}var fe=Math.trunc||function(t){return t>0?Math.floor(t):Math.ceil(t)};R.prototype={clone:function(){return new R(this.x,this.y)},add:function(t){return this.clone()._add(J(t))},_add:function(t){return this.x+=t.x,this.y+=t.y,this},subtract:function(t){return this.clone()._subtract(J(t))},_subtract:function(t){return this.x-=t.x,this.y-=t.y,this},divideBy:function(t){return this.clone()._divideBy(t)},_divideBy:function(t){return this.x/=t,this.y/=t,this},multiplyBy:function(t){return this.clone()._multiplyBy(t)},_multiplyBy:function(t){return this.x*=t,this.y*=t,this},scaleBy:function(t){return new R(this.x*t.x,this.y*t.y)},unscaleBy:function(t){return new R(this.x/t.x,this.y/t.y)},round:function(){return this.clone()._round()},_round:function(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this},floor:function(){return this.clone()._floor()},_floor:function(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this},ceil:function(){return this.clone()._ceil()},_ceil:function(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this},trunc:function(){return this.clone()._trunc()},_trunc:function(){return this.x=fe(this.x),this.y=fe(this.y),this},distanceTo:function(t){t=J(t);var e=t.x-this.x,o=t.y-this.y;return Math.sqrt(e*e+o*o)},equals:function(t){return t=J(t),t.x===this.x&&t.y===this.y},contains:function(t){return t=J(t),Math.abs(t.x)<=Math.abs(this.x)&&Math.abs(t.y)<=Math.abs(this.y)},toString:function(){return"Point("+H(this.x)+", "+H(this.y)+")"}};function J(t,e,o){return t instanceof R?t:k(t)?new R(t[0],t[1]):t==null?t:typeof t=="object"&&"x"in t&&"y"in t?new R(t.x,t.y):new R(t,e,o)}function C(t,e){if(t)for(var o=e?[t,e]:t,l=0,u=o.length;l<u;l++)this.extend(o[l])}C.prototype={extend:function(t){return t=J(t),!this.min&&!this.max?(this.min=t.clone(),this.max=t.clone()):(this.min.x=Math.min(t.x,this.min.x),this.max.x=Math.max(t.x,this.max.x),this.min.y=Math.min(t.y,this.min.y),this.max.y=Math.max(t.y,this.max.y)),this},getCenter:function(t){return new R((this.min.x+this.max.x)/2,(this.min.y+this.max.y)/2,t)},getBottomLeft:function(){return new R(this.min.x,this.max.y)},getTopRight:function(){return new R(this.max.x,this.min.y)},getTopLeft:function(){return this.min},getBottomRight:function(){return this.max},getSize:function(){return this.max.subtract(this.min)},contains:function(t){var e,o;return typeof t[0]=="number"||t instanceof R?t=J(t):t=ot(t),t instanceof C?(e=t.min,o=t.max):e=o=t,e.x>=this.min.x&&o.x<=this.max.x&&e.y>=this.min.y&&o.y<=this.max.y},intersects:function(t){t=ot(t);var e=this.min,o=this.max,l=t.min,u=t.max,f=u.x>=e.x&&l.x<=o.x,m=u.y>=e.y&&l.y<=o.y;return f&&m},overlaps:function(t){t=ot(t);var e=this.min,o=this.max,l=t.min,u=t.max,f=u.x>e.x&&l.x<o.x,m=u.y>e.y&&l.y<o.y;return f&&m},isValid:function(){return!!(this.min&&this.max)}};function ot(t,e){return!t||t instanceof C?t:new C(t,e)}function Et(t,e){if(t)for(var o=e?[t,e]:t,l=0,u=o.length;l<u;l++)this.extend(o[l])}Et.prototype={extend:function(t){var e=this._southWest,o=this._northEast,l,u;if(t instanceof st)l=t,u=t;else if(t instanceof Et){if(l=t._southWest,u=t._northEast,!l||!u)return this}else return t?this.extend(ft(t)||Lt(t)):this;return!e&&!o?(this._southWest=new st(l.lat,l.lng),this._northEast=new st(u.lat,u.lng)):(e.lat=Math.min(l.lat,e.lat),e.lng=Math.min(l.lng,e.lng),o.lat=Math.max(u.lat,o.lat),o.lng=Math.max(u.lng,o.lng)),this},pad:function(t){var e=this._southWest,o=this._northEast,l=Math.abs(e.lat-o.lat)*t,u=Math.abs(e.lng-o.lng)*t;return new Et(new st(e.lat-l,e.lng-u),new st(o.lat+l,o.lng+u))},getCenter:function(){return new st((this._southWest.lat+this._northEast.lat)/2,(this._southWest.lng+this._northEast.lng)/2)},getSouthWest:function(){return this._southWest},getNorthEast:function(){return this._northEast},getNorthWest:function(){return new st(this.getNorth(),this.getWest())},getSouthEast:function(){return new st(this.getSouth(),this.getEast())},getWest:function(){return this._southWest.lng},getSouth:function(){return this._southWest.lat},getEast:function(){return this._northEast.lng},getNorth:function(){return this._northEast.lat},contains:function(t){typeof t[0]=="number"||t instanceof st||"lat"in t?t=ft(t):t=Lt(t);var e=this._southWest,o=this._northEast,l,u;return t instanceof Et?(l=t.getSouthWest(),u=t.getNorthEast()):l=u=t,l.lat>=e.lat&&u.lat<=o.lat&&l.lng>=e.lng&&u.lng<=o.lng},intersects:function(t){t=Lt(t);var e=this._southWest,o=this._northEast,l=t.getSouthWest(),u=t.getNorthEast(),f=u.lat>=e.lat&&l.lat<=o.lat,m=u.lng>=e.lng&&l.lng<=o.lng;return f&&m},overlaps:function(t){t=Lt(t);var e=this._southWest,o=this._northEast,l=t.getSouthWest(),u=t.getNorthEast(),f=u.lat>e.lat&&l.lat<o.lat,m=u.lng>e.lng&&l.lng<o.lng;return f&&m},toBBoxString:function(){return[this.getWest(),this.getSouth(),this.getEast(),this.getNorth()].join(",")},equals:function(t,e){return t?(t=Lt(t),this._southWest.equals(t.getSouthWest(),e)&&this._northEast.equals(t.getNorthEast(),e)):!1},isValid:function(){return!!(this._southWest&&this._northEast)}};function Lt(t,e){return t instanceof Et?t:new Et(t,e)}function st(t,e,o){if(isNaN(t)||isNaN(e))throw new Error("Invalid LatLng object: ("+t+", "+e+")");this.lat=+t,this.lng=+e,o!==void 0&&(this.alt=+o)}st.prototype={equals:function(t,e){if(!t)return!1;t=ft(t);var o=Math.max(Math.abs(this.lat-t.lat),Math.abs(this.lng-t.lng));return o<=(e===void 0?1e-9:e)},toString:function(t){return"LatLng("+H(this.lat,t)+", "+H(this.lng,t)+")"},distanceTo:function(t){return qt.distance(this,ft(t))},wrap:function(){return qt.wrapLatLng(this)},toBounds:function(t){var e=180*t/40075017,o=e/Math.cos(Math.PI/180*this.lat);return Lt([this.lat-e,this.lng-o],[this.lat+e,this.lng+o])},clone:function(){return new st(this.lat,this.lng,this.alt)}};function ft(t,e,o){return t instanceof st?t:k(t)&&typeof t[0]!="object"?t.length===3?new st(t[0],t[1],t[2]):t.length===2?new st(t[0],t[1]):null:t==null?t:typeof t=="object"&&"lat"in t?new st(t.lat,"lng"in t?t.lng:t.lon,t.alt):e===void 0?null:new st(t,e,o)}var Bt={latLngToPoint:function(t,e){var o=this.projection.project(t),l=this.scale(e);return this.transformation._transform(o,l)},pointToLatLng:function(t,e){var o=this.scale(e),l=this.transformation.untransform(t,o);return this.projection.unproject(l)},project:function(t){return this.projection.project(t)},unproject:function(t){return this.projection.unproject(t)},scale:function(t){return 256*Math.pow(2,t)},zoom:function(t){return Math.log(t/256)/Math.LN2},getProjectedBounds:function(t){if(this.infinite)return null;var e=this.projection.bounds,o=this.scale(t),l=this.transformation.transform(e.min,o),u=this.transformation.transform(e.max,o);return new C(l,u)},infinite:!1,wrapLatLng:function(t){var e=this.wrapLng?T(t.lng,this.wrapLng,!0):t.lng,o=this.wrapLat?T(t.lat,this.wrapLat,!0):t.lat,l=t.alt;return new st(o,e,l)},wrapLatLngBounds:function(t){var e=t.getCenter(),o=this.wrapLatLng(e),l=e.lat-o.lat,u=e.lng-o.lng;if(l===0&&u===0)return t;var f=t.getSouthWest(),m=t.getNorthEast(),y=new st(f.lat-l,f.lng-u),x=new st(m.lat-l,m.lng-u);return new Et(y,x)}},qt=r({},Bt,{wrapLng:[-180,180],R:6371e3,distance:function(t,e){var o=Math.PI/180,l=t.lat*o,u=e.lat*o,f=Math.sin((e.lat-t.lat)*o/2),m=Math.sin((e.lng-t.lng)*o/2),y=f*f+Math.cos(l)*Math.cos(u)*m*m,x=2*Math.atan2(Math.sqrt(y),Math.sqrt(1-y));return this.R*x}}),Ai={R:6378137,MAX_LATITUDE:85.0511287798,project:function(t){var e=Math.PI/180,o=this.MAX_LATITUDE,l=Math.max(Math.min(o,t.lat),-o),u=Math.sin(l*e);return new R(this.R*t.lng*e,this.R*Math.log((1+u)/(1-u))/2)},unproject:function(t){var e=180/Math.PI;return new st((2*Math.atan(Math.exp(t.y/this.R))-Math.PI/2)*e,t.x*e/this.R)},bounds:function(){var t=6378137*Math.PI;return new C([-t,-t],[t,t])}()};function Bi(t,e,o,l){if(k(t)){this._a=t[0],this._b=t[1],this._c=t[2],this._d=t[3];return}this._a=t,this._b=e,this._c=o,this._d=l}Bi.prototype={transform:function(t,e){return this._transform(t.clone(),e)},_transform:function(t,e){return e=e||1,t.x=e*(this._a*t.x+this._b),t.y=e*(this._c*t.y+this._d),t},untransform:function(t,e){return e=e||1,new R((t.x/e-this._b)/this._a,(t.y/e-this._d)/this._c)}};function Ne(t,e,o,l){return new Bi(t,e,o,l)}var Zi=r({},qt,{code:"EPSG:3857",projection:Ai,transformation:function(){var t=.5/(Math.PI*Ai.R);return Ne(t,.5,-t,.5)}()}),Nr=r({},Zi,{code:"EPSG:900913"});function Jn(t){return document.createElementNS("http://www.w3.org/2000/svg",t)}function Xn(t,e){var o="",l,u,f,m,y,x;for(l=0,f=t.length;l<f;l++){for(y=t[l],u=0,m=y.length;u<m;u++)x=y[u],o+=(u?"L":"M")+x.x+" "+x.y;o+=e?oi?"z":"x":""}return o||"M0 0"}var $i=document.documentElement.style,ni="ActiveXObject"in window,pe=ni&&!document.addEventListener,ze="msLaunchUri"in navigator&&!("documentMode"in document),Ui=Nt("webkit"),me=Nt("android"),Ie=Nt("android 2")||Nt("android 3"),zr=parseInt(/WebKit\/([0-9]+)|$/.exec(navigator.userAgent)[1],10),Qn=me&&Nt("Google")&&zr<537&&!("AudioNode"in window),Fi=!!window.opera,Re=Nt("chrome"),Hi=Nt("gecko")&&!Ui&&!Fi&&!ni,to=!Re&&Nt("safari"),eo=Nt("phantom"),io="OTransition"in $i,no=navigator.platform.indexOf("Win")===0,Gi=ni&&"transition"in $i,Wi="WebKitCSSMatrix"in window&&"m11"in new window.WebKitCSSMatrix&&!Ie,oo="MozPerspective"in $i,Pt=!window.L_DISABLE_3D&&(Gi||Wi||oo)&&!io&&!eo,_e=typeof orientation<"u"||Nt("mobile"),Ir=_e&&Ui,Rr=_e&&Wi,Yt=!window.PointerEvent&&window.MSPointerEvent,Mt=!!(window.PointerEvent||Yt),Dt=!window.L_NO_TOUCH&&(Mt||"ontouchstart"in window||window.DocumentTouch&&document instanceof window.DocumentTouch),ro=_e&&Fi,Ar=_e&&Hi,Kt=(window.devicePixelRatio||window.screen.deviceXDPI/window.screen.logicalXDPI)>1,ao=function(){return!!document.createElement("canvas").getContext}(),oi=!!(document.createElementNS&&Jn("svg").createSVGRect),ri=!oi&&function(){try{var t=document.createElement("div");t.innerHTML='<v:shape adj="1"/>';var e=t.firstChild;return e.style.behavior="url(#default#VML)",e&&typeof e.adj=="object"}catch{return!1}}();function Nt(t){return navigator.userAgent.toLowerCase().indexOf(t)>=0}var Br=(Object.freeze||Object)({ie:ni,ielt9:pe,edge:ze,webkit:Ui,android:me,android23:Ie,androidStock:Qn,opera:Fi,chrome:Re,gecko:Hi,safari:to,phantom:eo,opera12:io,win:no,ie3d:Gi,webkit3d:Wi,gecko3d:oo,any3d:Pt,mobile:_e,mobileWebkit:Ir,mobileWebkit3d:Rr,msPointer:Yt,pointer:Mt,touch:Dt,mobileOpera:ro,mobileGecko:Ar,retina:Kt,canvas:ao,svg:oi,vml:ri}),Vi=Yt?"MSPointerDown":"pointerdown",qi=Yt?"MSPointerMove":"pointermove",Yi=Yt?"MSPointerUp":"pointerup",Ki=Yt?"MSPointerCancel":"pointercancel",Zr=["INPUT","SELECT","OPTION"],ge={},so=!1,Ji=0;function $r(t,e,o,l){return e==="touchstart"?Fr(t,o,l):e==="touchmove"?Wr(t,o,l):e==="touchend"&&Vr(t,o,l),this}function Ur(t,e,o){var l=t["_leaflet_"+e+o];return e==="touchstart"?t.removeEventListener(Vi,l,!1):e==="touchmove"?t.removeEventListener(qi,l,!1):e==="touchend"&&(t.removeEventListener(Yi,l,!1),t.removeEventListener(Ki,l,!1)),this}function Fr(t,e,o){var l=p(function(u){if(u.pointerType!=="mouse"&&u.MSPOINTER_TYPE_MOUSE&&u.pointerType!==u.MSPOINTER_TYPE_MOUSE)if(Zr.indexOf(u.target.tagName)<0)Ot(u);else return;Xi(u,e)});t["_leaflet_touchstart"+o]=l,t.addEventListener(Vi,l,!1),so||(document.documentElement.addEventListener(Vi,Hr,!0),document.documentElement.addEventListener(qi,Gr,!0),document.documentElement.addEventListener(Yi,lo,!0),document.documentElement.addEventListener(Ki,lo,!0),so=!0)}function Hr(t){ge[t.pointerId]=t,Ji++}function Gr(t){ge[t.pointerId]&&(ge[t.pointerId]=t)}function lo(t){delete ge[t.pointerId],Ji--}function Xi(t,e){t.touches=[];for(var o in ge)t.touches.push(ge[o]);t.changedTouches=[t],e(t)}function Wr(t,e,o){var l=function(u){(u.pointerType===u.MSPOINTER_TYPE_MOUSE||u.pointerType==="mouse")&&u.buttons===0||Xi(u,e)};t["_leaflet_touchmove"+o]=l,t.addEventListener(qi,l,!1)}function Vr(t,e,o){var l=function(u){Xi(u,e)};t["_leaflet_touchend"+o]=l,t.addEventListener(Yi,l,!1),t.addEventListener(Ki,l,!1)}var ai=Yt?"MSPointerDown":Mt?"pointerdown":"touchstart",si=Yt?"MSPointerUp":Mt?"pointerup":"touchend",ve="_leaflet_";function ho(t,e,o){var l,u,f=!1,m=250;function y(E){var N;if(Mt){if(!ze||E.pointerType==="mouse")return;N=Ji}else N=E.touches.length;if(!(N>1)){var U=Date.now(),Q=U-(l||U);u=E.touches?E.touches[0]:E,f=Q>0&&Q<=m,l=U}}function x(E){if(f&&!u.cancelBubble){if(Mt){if(!ze||E.pointerType==="mouse")return;var N={},U,Q;for(Q in u)U=u[Q],N[Q]=U&&U.bind?U.bind(u):U;u=N}u.type="dblclick",e(u),l=null}}return t[ve+ai+o]=y,t[ve+si+o]=x,t[ve+"dblclick"+o]=e,t.addEventListener(ai,y,!1),t.addEventListener(si,x,!1),t.addEventListener("dblclick",e,!1),this}function co(t,e){var o=t[ve+ai+e],l=t[ve+si+e],u=t[ve+"dblclick"+e];return t.removeEventListener(ai,o,!1),t.removeEventListener(si,l,!1),ze||t.removeEventListener("dblclick",u,!1),this}var Qi=hi(["transform","webkitTransform","OTransform","MozTransform","msTransform"]),Ae=hi(["webkitTransition","transition","OTransition","MozTransition","msTransition"]),uo=Ae==="webkitTransition"||Ae==="OTransition"?Ae+"End":"transitionend";function fo(t){return typeof t=="string"?document.getElementById(t):t}function Be(t,e){var o=t.style[e]||t.currentStyle&&t.currentStyle[e];if((!o||o==="auto")&&document.defaultView){var l=document.defaultView.getComputedStyle(t,null);o=l?l[e]:null}return o==="auto"?null:o}function it(t,e,o){var l=document.createElement(t);return l.className=e||"",o&&o.appendChild(l),l}function ct(t){var e=t.parentNode;e&&e.removeChild(t)}function tn(t){for(;t.firstChild;)t.removeChild(t.firstChild)}function ye(t){var e=t.parentNode;e.lastChild!==t&&e.appendChild(t)}function Le(t){var e=t.parentNode;e.firstChild!==t&&e.insertBefore(t,e.firstChild)}function en(t,e){if(t.classList!==void 0)return t.classList.contains(e);var o=li(t);return o.length>0&&new RegExp("(^|\\s)"+e+"(\\s|$)").test(o)}function V(t,e){if(t.classList!==void 0)for(var o=G(e),l=0,u=o.length;l<u;l++)t.classList.add(o[l]);else if(!en(t,e)){var f=li(t);nn(t,(f?f+" ":"")+e)}}function pt(t,e){t.classList!==void 0?t.classList.remove(e):nn(t,M((" "+li(t)+" ").replace(" "+e+" "," ")))}function nn(t,e){t.className.baseVal===void 0?t.className=e:t.className.baseVal=e}function li(t){return t.className.baseVal===void 0?t.className:t.className.baseVal}function Tt(t,e){"opacity"in t.style?t.style.opacity=e:"filter"in t.style&&qr(t,e)}function qr(t,e){var o=!1,l="DXImageTransform.Microsoft.Alpha";try{o=t.filters.item(l)}catch{if(e===1)return}e=Math.round(e*100),o?(o.Enabled=e!==100,o.Opacity=e):t.style.filter+=" progid:"+l+"(opacity="+e+")"}function hi(t){for(var e=document.documentElement.style,o=0;o<t.length;o++)if(t[o]in e)return t[o];return!1}function ne(t,e,o){var l=e||new R(0,0);t.style[Qi]=(Gi?"translate("+l.x+"px,"+l.y+"px)":"translate3d("+l.x+"px,"+l.y+"px,0)")+(o?" scale("+o+")":"")}function gt(t,e){t._leaflet_pos=e,Pt?ne(t,e):(t.style.left=e.x+"px",t.style.top=e.y+"px")}function Jt(t){return t._leaflet_pos||new R(0,0)}var Ze,$e,on;if("onselectstart"in document)Ze=function(){q(window,"selectstart",Ot)},$e=function(){_t(window,"selectstart",Ot)};else{var Ue=hi(["userSelect","WebkitUserSelect","OUserSelect","MozUserSelect","msUserSelect"]);Ze=function(){if(Ue){var t=document.documentElement.style;on=t[Ue],t[Ue]="none"}},$e=function(){Ue&&(document.documentElement.style[Ue]=on,on=void 0)}}function rn(){q(window,"dragstart",Ot)}function an(){_t(window,"dragstart",Ot)}var ci,sn;function ln(t){for(;t.tabIndex===-1;)t=t.parentNode;t.style&&(ui(),ci=t,sn=t.style.outline,t.style.outline="none",q(window,"keydown",ui))}function ui(){ci&&(ci.style.outline=sn,ci=void 0,sn=void 0,_t(window,"keydown",ui))}function po(t){do t=t.parentNode;while((!t.offsetWidth||!t.offsetHeight)&&t!==document.body);return t}function hn(t){var e=t.getBoundingClientRect();return{x:e.width/t.offsetWidth||1,y:e.height/t.offsetHeight||1,boundingClientRect:e}}var Yr=(Object.freeze||Object)({TRANSFORM:Qi,TRANSITION:Ae,TRANSITION_END:uo,get:fo,getStyle:Be,create:it,remove:ct,empty:tn,toFront:ye,toBack:Le,hasClass:en,addClass:V,removeClass:pt,setClass:nn,getClass:li,setOpacity:Tt,testProp:hi,setTransform:ne,setPosition:gt,getPosition:Jt,disableTextSelection:Ze,enableTextSelection:$e,disableImageDrag:rn,enableImageDrag:an,preventOutline:ln,restoreOutline:ui,getSizedParentNode:po,getScale:hn});function q(t,e,o,l){if(typeof e=="object")for(var u in e)di(t,u,e[u],o);else{e=G(e);for(var f=0,m=e.length;f<m;f++)di(t,e[f],o,l)}return this}var jt="_leaflet_events";function _t(t,e,o,l){if(typeof e=="object")for(var u in e)cn(t,u,e[u],o);else if(e){e=G(e);for(var f=0,m=e.length;f<m;f++)cn(t,e[f],o,l)}else{for(var y in t[jt])cn(t,y,t[jt][y]);delete t[jt]}return this}function di(t,e,o,l){var u=e+g(o)+(l?"_"+g(l):"");if(t[jt]&&t[jt][u])return this;var f=function(y){return o.call(l||t,y||window.event)},m=f;Mt&&e.indexOf("touch")===0?$r(t,e,f,u):Dt&&e==="dblclick"&&ho&&!(Mt&&Re)?ho(t,f,u):"addEventListener"in t?e==="mousewheel"?t.addEventListener("onwheel"in t?"wheel":"mousewheel",f,!1):e==="mouseenter"||e==="mouseleave"?(f=function(y){y=y||window.event,fi(t,y)&&m(y)},t.addEventListener(e==="mouseenter"?"mouseover":"mouseout",f,!1)):(e==="click"&&me&&(f=function(y){Jr(y,m)}),t.addEventListener(e,f,!1)):"attachEvent"in t&&t.attachEvent("on"+e,f),t[jt]=t[jt]||{},t[jt][u]=f}function cn(t,e,o,l){var u=e+g(o)+(l?"_"+g(l):""),f=t[jt]&&t[jt][u];if(!f)return this;Mt&&e.indexOf("touch")===0?Ur(t,e,u):Dt&&e==="dblclick"&&co&&!(Mt&&Re)?co(t,u):"removeEventListener"in t?e==="mousewheel"?t.removeEventListener("onwheel"in t?"wheel":"mousewheel",f,!1):t.removeEventListener(e==="mouseenter"?"mouseover":e==="mouseleave"?"mouseout":e,f,!1):"detachEvent"in t&&t.detachEvent("on"+e,f),t[jt][u]=null}function oe(t){return t.stopPropagation?t.stopPropagation():t.originalEvent?t.originalEvent._stopped=!0:t.cancelBubble=!0,pn(t),this}function un(t){return di(t,"mousewheel",oe),this}function Fe(t){return q(t,"mousedown touchstart dblclick",oe),di(t,"click",fn),this}function Ot(t){return t.preventDefault?t.preventDefault():t.returnValue=!1,this}function zt(t){return Ot(t),oe(t),this}function mo(t,e){if(!e)return new R(t.clientX,t.clientY);var o=hn(e),l=o.boundingClientRect;return new R((t.clientX-l.left)/o.x-e.clientLeft,(t.clientY-l.top)/o.y-e.clientTop)}var Kr=no&&Re?2*window.devicePixelRatio:Hi?window.devicePixelRatio:1;function _o(t){return ze?t.wheelDeltaY/2:t.deltaY&&t.deltaMode===0?-t.deltaY/Kr:t.deltaY&&t.deltaMode===1?-t.deltaY*20:t.deltaY&&t.deltaMode===2?-t.deltaY*60:t.deltaX||t.deltaZ?0:t.wheelDelta?(t.wheelDeltaY||t.wheelDelta)/2:t.detail&&Math.abs(t.detail)<32765?-t.detail*20:t.detail?t.detail/-32765*60:0}var dn={};function fn(t){dn[t.type]=!0}function pn(t){var e=dn[t.type];return dn[t.type]=!1,e}function fi(t,e){var o=e.relatedTarget;if(!o)return!0;try{for(;o&&o!==t;)o=o.parentNode}catch{return!1}return o!==t}var mn;function Jr(t,e){var o=t.timeStamp||t.originalEvent&&t.originalEvent.timeStamp,l=mn&&o-mn;if(l&&l>100&&l<500||t.target._simulatedClick&&!t._simulated){zt(t);return}mn=o,e(t)}var Xr=(Object.freeze||Object)({on:q,off:_t,stopPropagation:oe,disableScrollPropagation:un,disableClickPropagation:Fe,preventDefault:Ot,stop:zt,getMousePosition:mo,getWheelDelta:_o,fakeStop:fn,skipped:pn,isExternalTarget:fi,addListener:q,removeListener:_t}),go=xt.extend({run:function(t,e,o,l){this.stop(),this._el=t,this._inProgress=!0,this._duration=o||.25,this._easeOutPower=1/Math.max(l||.5,.2),this._startPos=Jt(t),this._offset=e.subtract(this._startPos),this._startTime=+new Date,this.fire("start"),this._animate()},stop:function(){this._inProgress&&(this._step(!0),this._complete())},_animate:function(){this._animId=B(this._animate,this),this._step()},_step:function(t){var e=+new Date-this._startTime,o=this._duration*1e3;e<o?this._runFrame(this._easeOut(e/o),t):(this._runFrame(1),this._complete())},_runFrame:function(t,e){var o=this._startPos.add(this._offset.multiplyBy(t));e&&o._round(),gt(this._el,o),this.fire("step")},_complete:function(){$(this._animId),this._inProgress=!1,this.fire("end")},_easeOut:function(t){return 1-Math.pow(1-t,this._easeOutPower)}}),tt=xt.extend({options:{crs:Zi,center:void 0,zoom:void 0,minZoom:void 0,maxZoom:void 0,layers:[],maxBounds:void 0,renderer:void 0,zoomAnimation:!0,zoomAnimationThreshold:4,fadeAnimation:!0,markerZoomAnimation:!0,transform3DLimit:8388608,zoomSnap:1,zoomDelta:1,trackResize:!0},initialize:function(t,e){e=v(this,e),this._initContainer(t),this._initLayout(),this._onResize=p(this._onResize,this),this._initEvents(),e.maxBounds&&this.setMaxBounds(e.maxBounds),e.zoom!==void 0&&(this._zoom=this._limitZoom(e.zoom)),e.center&&e.zoom!==void 0&&this.setView(ft(e.center),e.zoom,{reset:!0}),this._handlers=[],this._layers={},this._zoomBoundLayers={},this._sizeChanged=!0,this.callInitHooks(),this._zoomAnimated=Ae&&Pt&&!ro&&this.options.zoomAnimation,this._zoomAnimated&&(this._createAnimProxy(),q(this._proxy,uo,this._catchTransitionEnd,this)),this._addLayers(this.options.layers)},setView:function(t,e,o){if(e=e===void 0?this._zoom:this._limitZoom(e),t=this._limitCenter(ft(t),e,this.options.maxBounds),o=o||{},this._stop(),this._loaded&&!o.reset&&o!==!0){o.animate!==void 0&&(o.zoom=r({animate:o.animate},o.zoom),o.pan=r({animate:o.animate,duration:o.duration},o.pan));var l=this._zoom!==e?this._tryAnimatedZoom&&this._tryAnimatedZoom(t,e,o.zoom):this._tryAnimatedPan(t,o.pan);if(l)return clearTimeout(this._sizeTimer),this}return this._resetView(t,e),this},setZoom:function(t,e){return this._loaded?this.setView(this.getCenter(),t,{zoom:e}):(this._zoom=t,this)},zoomIn:function(t,e){return t=t||(Pt?this.options.zoomDelta:1),this.setZoom(this._zoom+t,e)},zoomOut:function(t,e){return t=t||(Pt?this.options.zoomDelta:1),this.setZoom(this._zoom-t,e)},setZoomAround:function(t,e,o){var l=this.getZoomScale(e),u=this.getSize().divideBy(2),f=t instanceof R?t:this.latLngToContainerPoint(t),m=f.subtract(u).multiplyBy(1-1/l),y=this.containerPointToLatLng(u.add(m));return this.setView(y,e,{zoom:o})},_getBoundsCenterZoom:function(t,e){e=e||{},t=t.getBounds?t.getBounds():Lt(t);var o=J(e.paddingTopLeft||e.padding||[0,0]),l=J(e.paddingBottomRight||e.padding||[0,0]),u=this.getBoundsZoom(t,!1,o.add(l));if(u=typeof e.maxZoom=="number"?Math.min(e.maxZoom,u):u,u===1/0)return{center:t.getCenter(),zoom:u};var f=l.subtract(o).divideBy(2),m=this.project(t.getSouthWest(),u),y=this.project(t.getNorthEast(),u),x=this.unproject(m.add(y).divideBy(2).add(f),u);return{center:x,zoom:u}},fitBounds:function(t,e){if(t=Lt(t),!t.isValid())throw new Error("Bounds are not valid.");var o=this._getBoundsCenterZoom(t,e);return this.setView(o.center,o.zoom,e)},fitWorld:function(t){return this.fitBounds([[-90,-180],[90,180]],t)},panTo:function(t,e){return this.setView(t,this._zoom,{pan:e})},panBy:function(t,e){if(t=J(t).round(),e=e||{},!t.x&&!t.y)return this.fire("moveend");if(e.animate!==!0&&!this.getSize().contains(t))return this._resetView(this.unproject(this.project(this.getCenter()).add(t)),this.getZoom()),this;if(this._panAnim||(this._panAnim=new go,this._panAnim.on({step:this._onPanTransitionStep,end:this._onPanTransitionEnd},this)),e.noMoveStart||this.fire("movestart"),e.animate!==!1){V(this._mapPane,"leaflet-pan-anim");var o=this._getMapPanePos().subtract(t).round();this._panAnim.run(this._mapPane,o,e.duration||.25,e.easeLinearity)}else this._rawPanBy(t),this.fire("move").fire("moveend");return this},flyTo:function(t,e,o){if(o=o||{},o.animate===!1||!Pt)return this.setView(t,e,o);this._stop();var l=this.project(this.getCenter()),u=this.project(t),f=this.getSize(),m=this._zoom;t=ft(t),e=e===void 0?m:e;var y=Math.max(f.x,f.y),x=y*this.getZoomScale(m,e),E=u.distanceTo(l)||1,N=1.42,U=N*N;function Q(vt){var xi=vt?-1:1,Ra=vt?x:y,Aa=x*x-y*y+xi*U*U*E*E,Ba=2*Ra*U*E,Mn=Aa/Ba,qo=Math.sqrt(Mn*Mn+1)-Mn,Za=qo<1e-9?-18:Math.log(qo);return Za}function Ht(vt){return(Math.exp(vt)-Math.exp(-vt))/2}function le(vt){return(Math.exp(vt)+Math.exp(-vt))/2}function Li(vt){return Ht(vt)/le(vt)}var Qt=Q(0);function kn(vt){return y*(le(Qt)/le(Qt+N*vt))}function Da(vt){return y*(le(Qt)*Li(Qt+N*vt)-Ht(Qt))/U}function Na(vt){return 1-Math.pow(1-vt,1.5)}var za=Date.now(),Wo=(Q(1)-Qt)/N,Ia=o.duration?1e3*o.duration:1e3*Wo*.8;function Vo(){var vt=(Date.now()-za)/Ia,xi=Na(vt)*Wo;vt<=1?(this._flyToFrame=B(Vo,this),this._move(this.unproject(l.add(u.subtract(l).multiplyBy(Da(xi)/E)),m),this.getScaleZoom(y/kn(xi),m),{flyTo:!0})):this._move(t,e)._moveEnd(!0)}return this._moveStart(!0,o.noMoveStart),Vo.call(this),this},flyToBounds:function(t,e){var o=this._getBoundsCenterZoom(t,e);return this.flyTo(o.center,o.zoom,e)},setMaxBounds:function(t){if(t=Lt(t),t.isValid())this.options.maxBounds&&this.off("moveend",this._panInsideMaxBounds);else return this.options.maxBounds=null,this.off("moveend",this._panInsideMaxBounds);return this.options.maxBounds=t,this._loaded&&this._panInsideMaxBounds(),this.on("moveend",this._panInsideMaxBounds)},setMinZoom:function(t){var e=this.options.minZoom;return this.options.minZoom=t,this._loaded&&e!==t&&(this.fire("zoomlevelschange"),this.getZoom()<this.options.minZoom)?this.setZoom(t):this},setMaxZoom:function(t){var e=this.options.maxZoom;return this.options.maxZoom=t,this._loaded&&e!==t&&(this.fire("zoomlevelschange"),this.getZoom()>this.options.maxZoom)?this.setZoom(t):this},panInsideBounds:function(t,e){this._enforcingBounds=!0;var o=this.getCenter(),l=this._limitCenter(o,this._zoom,Lt(t));return o.equals(l)||this.panTo(l,e),this._enforcingBounds=!1,this},invalidateSize:function(t){if(!this._loaded)return this;t=r({animate:!1,pan:!0},t===!0?{animate:!0}:t);var e=this.getSize();this._sizeChanged=!0,this._lastCenter=null;var o=this.getSize(),l=e.divideBy(2).round(),u=o.divideBy(2).round(),f=l.subtract(u);return!f.x&&!f.y?this:(t.animate&&t.pan?this.panBy(f):(t.pan&&this._rawPanBy(f),this.fire("move"),t.debounceMoveend?(clearTimeout(this._sizeTimer),this._sizeTimer=setTimeout(p(this.fire,this,"moveend"),200)):this.fire("moveend")),this.fire("resize",{oldSize:e,newSize:o}))},stop:function(){return this.setZoom(this._limitZoom(this._zoom)),this.options.zoomSnap||this.fire("viewreset"),this._stop()},locate:function(t){if(t=this._locateOptions=r({timeout:1e4,watch:!1},t),!("geolocation"in navigator))return this._handleGeolocationError({code:0,message:"Geolocation not supported."}),this;var e=p(this._handleGeolocationResponse,this),o=p(this._handleGeolocationError,this);return t.watch?this._locationWatchId=navigator.geolocation.watchPosition(e,o,t):navigator.geolocation.getCurrentPosition(e,o,t),this},stopLocate:function(){return navigator.geolocation&&navigator.geolocation.clearWatch&&navigator.geolocation.clearWatch(this._locationWatchId),this._locateOptions&&(this._locateOptions.setView=!1),this},_handleGeolocationError:function(t){var e=t.code,o=t.message||(e===1?"permission denied":e===2?"position unavailable":"timeout");this._locateOptions.setView&&!this._loaded&&this.fitWorld(),this.fire("locationerror",{code:e,message:"Geolocation error: "+o+"."})},_handleGeolocationResponse:function(t){var e=t.coords.latitude,o=t.coords.longitude,l=new st(e,o),u=l.toBounds(t.coords.accuracy*2),f=this._locateOptions;if(f.setView){var m=this.getBoundsZoom(u);this.setView(l,f.maxZoom?Math.min(m,f.maxZoom):m)}var y={latlng:l,bounds:u,timestamp:t.timestamp};for(var x in t.coords)typeof t.coords[x]=="number"&&(y[x]=t.coords[x]);this.fire("locationfound",y)},addHandler:function(t,e){if(!e)return this;var o=this[t]=new e(this);return this._handlers.push(o),this.options[t]&&o.enable(),this},remove:function(){if(this._initEvents(!0),this._containerId!==this._container._leaflet_id)throw new Error("Map container is being reused by another instance");try{delete this._container._leaflet_id,delete this._containerId}catch{this._container._leaflet_id=void 0,this._containerId=void 0}this._locationWatchId!==void 0&&this.stopLocate(),this._stop(),ct(this._mapPane),this._clearControlPos&&this._clearControlPos(),this._resizeRequest&&($(this._resizeRequest),this._resizeRequest=null),this._clearHandlers(),this._loaded&&this.fire("unload");var t;for(t in this._layers)this._layers[t].remove();for(t in this._panes)ct(this._panes[t]);return this._layers=[],this._panes=[],delete this._mapPane,delete this._renderer,this},createPane:function(t,e){var o="leaflet-pane"+(t?" leaflet-"+t.replace("Pane","")+"-pane":""),l=it("div",o,e||this._mapPane);return t&&(this._panes[t]=l),l},getCenter:function(){return this._checkIfLoaded(),this._lastCenter&&!this._moved()?this._lastCenter:this.layerPointToLatLng(this._getCenterLayerPoint())},getZoom:function(){return this._zoom},getBounds:function(){var t=this.getPixelBounds(),e=this.unproject(t.getBottomLeft()),o=this.unproject(t.getTopRight());return new Et(e,o)},getMinZoom:function(){return this.options.minZoom===void 0?this._layersMinZoom||0:this.options.minZoom},getMaxZoom:function(){return this.options.maxZoom===void 0?this._layersMaxZoom===void 0?1/0:this._layersMaxZoom:this.options.maxZoom},getBoundsZoom:function(t,e,o){t=Lt(t),o=J(o||[0,0]);var l=this.getZoom()||0,u=this.getMinZoom(),f=this.getMaxZoom(),m=t.getNorthWest(),y=t.getSouthEast(),x=this.getSize().subtract(o),E=ot(this.project(y,l),this.project(m,l)).getSize(),N=Pt?this.options.zoomSnap:1,U=x.x/E.x,Q=x.y/E.y,Ht=e?Math.max(U,Q):Math.min(U,Q);return l=this.getScaleZoom(Ht,l),N&&(l=Math.round(l/(N/100))*(N/100),l=e?Math.ceil(l/N)*N:Math.floor(l/N)*N),Math.max(u,Math.min(f,l))},getSize:function(){return(!this._size||this._sizeChanged)&&(this._size=new R(this._container.clientWidth||0,this._container.clientHeight||0),this._sizeChanged=!1),this._size.clone()},getPixelBounds:function(t,e){var o=this._getTopLeftPoint(t,e);return new C(o,o.add(this.getSize()))},getPixelOrigin:function(){return this._checkIfLoaded(),this._pixelOrigin},getPixelWorldBounds:function(t){return this.options.crs.getProjectedBounds(t===void 0?this.getZoom():t)},getPane:function(t){return typeof t=="string"?this._panes[t]:t},getPanes:function(){return this._panes},getContainer:function(){return this._container},getZoomScale:function(t,e){var o=this.options.crs;return e=e===void 0?this._zoom:e,o.scale(t)/o.scale(e)},getScaleZoom:function(t,e){var o=this.options.crs;e=e===void 0?this._zoom:e;var l=o.zoom(t*o.scale(e));return isNaN(l)?1/0:l},project:function(t,e){return e=e===void 0?this._zoom:e,this.options.crs.latLngToPoint(ft(t),e)},unproject:function(t,e){return e=e===void 0?this._zoom:e,this.options.crs.pointToLatLng(J(t),e)},layerPointToLatLng:function(t){var e=J(t).add(this.getPixelOrigin());return this.unproject(e)},latLngToLayerPoint:function(t){var e=this.project(ft(t))._round();return e._subtract(this.getPixelOrigin())},wrapLatLng:function(t){return this.options.crs.wrapLatLng(ft(t))},wrapLatLngBounds:function(t){return this.options.crs.wrapLatLngBounds(Lt(t))},distance:function(t,e){return this.options.crs.distance(ft(t),ft(e))},containerPointToLayerPoint:function(t){return J(t).subtract(this._getMapPanePos())},layerPointToContainerPoint:function(t){return J(t).add(this._getMapPanePos())},containerPointToLatLng:function(t){var e=this.containerPointToLayerPoint(J(t));return this.layerPointToLatLng(e)},latLngToContainerPoint:function(t){return this.layerPointToContainerPoint(this.latLngToLayerPoint(ft(t)))},mouseEventToContainerPoint:function(t){return mo(t,this._container)},mouseEventToLayerPoint:function(t){return this.containerPointToLayerPoint(this.mouseEventToContainerPoint(t))},mouseEventToLatLng:function(t){return this.layerPointToLatLng(this.mouseEventToLayerPoint(t))},_initContainer:function(t){var e=this._container=fo(t);if(e){if(e._leaflet_id)throw new Error("Map container is already initialized.")}else throw new Error("Map container not found.");q(e,"scroll",this._onScroll,this),this._containerId=g(e)},_initLayout:function(){var t=this._container;this._fadeAnimated=this.options.fadeAnimation&&Pt,V(t,"leaflet-container"+(Dt?" leaflet-touch":"")+(Kt?" leaflet-retina":"")+(pe?" leaflet-oldie":"")+(to?" leaflet-safari":"")+(this._fadeAnimated?" leaflet-fade-anim":""));var e=Be(t,"position");e!=="absolute"&&e!=="relative"&&e!=="fixed"&&(t.style.position="relative"),this._initPanes(),this._initControlPos&&this._initControlPos()},_initPanes:function(){var t=this._panes={};this._paneRenderers={},this._mapPane=this.createPane("mapPane",this._container),gt(this._mapPane,new R(0,0)),this.createPane("tilePane"),this.createPane("shadowPane"),this.createPane("overlayPane"),this.createPane("markerPane"),this.createPane("tooltipPane"),this.createPane("popupPane"),this.options.markerZoomAnimation||(V(t.markerPane,"leaflet-zoom-hide"),V(t.shadowPane,"leaflet-zoom-hide"))},_resetView:function(t,e){gt(this._mapPane,new R(0,0));var o=!this._loaded;this._loaded=!0,e=this._limitZoom(e),this.fire("viewprereset");var l=this._zoom!==e;this._moveStart(l,!1)._move(t,e)._moveEnd(l),this.fire("viewreset"),o&&this.fire("load")},_moveStart:function(t,e){return t&&this.fire("zoomstart"),e||this.fire("movestart"),this},_move:function(t,e,o){e===void 0&&(e=this._zoom);var l=this._zoom!==e;return this._zoom=e,this._lastCenter=t,this._pixelOrigin=this._getNewPixelOrigin(t),(l||o&&o.pinch)&&this.fire("zoom",o),this.fire("move",o)},_moveEnd:function(t){return t&&this.fire("zoomend"),this.fire("moveend")},_stop:function(){return $(this._flyToFrame),this._panAnim&&this._panAnim.stop(),this},_rawPanBy:function(t){gt(this._mapPane,this._getMapPanePos().subtract(t))},_getZoomSpan:function(){return this.getMaxZoom()-this.getMinZoom()},_panInsideMaxBounds:function(){this._enforcingBounds||this.panInsideBounds(this.options.maxBounds)},_checkIfLoaded:function(){if(!this._loaded)throw new Error("Set map center and zoom first.")},_initEvents:function(t){this._targets={},this._targets[g(this._container)]=this;var e=t?_t:q;e(this._container,"click dblclick mousedown mouseup mouseover mouseout mousemove contextmenu keypress",this._handleDOMEvent,this),this.options.trackResize&&e(window,"resize",this._onResize,this),Pt&&this.options.transform3DLimit&&(t?this.off:this.on).call(this,"moveend",this._onMoveEnd)},_onResize:function(){$(this._resizeRequest),this._resizeRequest=B(function(){this.invalidateSize({debounceMoveend:!0})},this)},_onScroll:function(){this._container.scrollTop=0,this._container.scrollLeft=0},_onMoveEnd:function(){var t=this._getMapPanePos();Math.max(Math.abs(t.x),Math.abs(t.y))>=this.options.transform3DLimit&&this._resetView(this.getCenter(),this.getZoom())},_findEventTargets:function(t,e){for(var o=[],l,u=e==="mouseout"||e==="mouseover",f=t.target||t.srcElement,m=!1;f;){if(l=this._targets[g(f)],l&&(e==="click"||e==="preclick")&&!t._simulated&&this._draggableMoved(l)){m=!0;break}if(l&&l.listens(e,!0)&&(u&&!fi(f,t)||(o.push(l),u))||f===this._container)break;f=f.parentNode}return!o.length&&!m&&!u&&fi(f,t)&&(o=[this]),o},_handleDOMEvent:function(t){if(!(!this._loaded||pn(t))){var e=t.type;(e==="mousedown"||e==="keypress")&&ln(t.target||t.srcElement),this._fireDOMEvent(t,e)}},_mouseEvents:["click","dblclick","mouseover","mouseout","contextmenu"],_fireDOMEvent:function(t,e,o){if(t.type==="click"){var l=r({},t);l.type="preclick",this._fireDOMEvent(l,l.type,o)}if(!t._stopped&&(o=(o||[]).concat(this._findEventTargets(t,e)),!!o.length)){var u=o[0];e==="contextmenu"&&u.listens(e,!0)&&Ot(t);var f={originalEvent:t};if(t.type!=="keypress"){var m=u.getLatLng&&(!u._radius||u._radius<=10);f.containerPoint=m?this.latLngToContainerPoint(u.getLatLng()):this.mouseEventToContainerPoint(t),f.layerPoint=this.containerPointToLayerPoint(f.containerPoint),f.latlng=m?u.getLatLng():this.layerPointToLatLng(f.layerPoint)}for(var y=0;y<o.length;y++)if(o[y].fire(e,f,!0),f.originalEvent._stopped||o[y].options.bubblingMouseEvents===!1&&j(this._mouseEvents,e)!==-1)return}},_draggableMoved:function(t){return t=t.dragging&&t.dragging.enabled()?t:this,t.dragging&&t.dragging.moved()||this.boxZoom&&this.boxZoom.moved()},_clearHandlers:function(){for(var t=0,e=this._handlers.length;t<e;t++)this._handlers[t].disable()},whenReady:function(t,e){return this._loaded?t.call(e||this,{target:this}):this.on("load",t,e),this},_getMapPanePos:function(){return Jt(this._mapPane)||new R(0,0)},_moved:function(){var t=this._getMapPanePos();return t&&!t.equals([0,0])},_getTopLeftPoint:function(t,e){var o=t&&e!==void 0?this._getNewPixelOrigin(t,e):this.getPixelOrigin();return o.subtract(this._getMapPanePos())},_getNewPixelOrigin:function(t,e){var o=this.getSize()._divideBy(2);return this.project(t,e)._subtract(o)._add(this._getMapPanePos())._round()},_latLngToNewLayerPoint:function(t,e,o){var l=this._getNewPixelOrigin(o,e);return this.project(t,e)._subtract(l)},_latLngBoundsToNewLayerBounds:function(t,e,o){var l=this._getNewPixelOrigin(o,e);return ot([this.project(t.getSouthWest(),e)._subtract(l),this.project(t.getNorthWest(),e)._subtract(l),this.project(t.getSouthEast(),e)._subtract(l),this.project(t.getNorthEast(),e)._subtract(l)])},_getCenterLayerPoint:function(){return this.containerPointToLayerPoint(this.getSize()._divideBy(2))},_getCenterOffset:function(t){return this.latLngToLayerPoint(t).subtract(this._getCenterLayerPoint())},_limitCenter:function(t,e,o){if(!o)return t;var l=this.project(t,e),u=this.getSize().divideBy(2),f=new C(l.subtract(u),l.add(u)),m=this._getBoundsOffset(f,o,e);return m.round().equals([0,0])?t:this.unproject(l.add(m),e)},_limitOffset:function(t,e){if(!e)return t;var o=this.getPixelBounds(),l=new C(o.min.add(t),o.max.add(t));return t.add(this._getBoundsOffset(l,e))},_getBoundsOffset:function(t,e,o){var l=ot(this.project(e.getNorthEast(),o),this.project(e.getSouthWest(),o)),u=l.min.subtract(t.min),f=l.max.subtract(t.max),m=this._rebound(u.x,-f.x),y=this._rebound(u.y,-f.y);return new R(m,y)},_rebound:function(t,e){return t+e>0?Math.round(t-e)/2:Math.max(0,Math.ceil(t))-Math.max(0,Math.floor(e))},_limitZoom:function(t){var e=this.getMinZoom(),o=this.getMaxZoom(),l=Pt?this.options.zoomSnap:1;return l&&(t=Math.round(t/l)*l),Math.max(e,Math.min(o,t))},_onPanTransitionStep:function(){this.fire("move")},_onPanTransitionEnd:function(){pt(this._mapPane,"leaflet-pan-anim"),this.fire("moveend")},_tryAnimatedPan:function(t,e){var o=this._getCenterOffset(t)._trunc();return(e&&e.animate)!==!0&&!this.getSize().contains(o)?!1:(this.panBy(o,e),!0)},_createAnimProxy:function(){var t=this._proxy=it("div","leaflet-proxy leaflet-zoom-animated");this._panes.mapPane.appendChild(t),this.on("zoomanim",function(e){var o=Qi,l=this._proxy.style[o];ne(this._proxy,this.project(e.center,e.zoom),this.getZoomScale(e.zoom,1)),l===this._proxy.style[o]&&this._animatingZoom&&this._onZoomTransitionEnd()},this),this.on("load moveend",function(){var e=this.getCenter(),o=this.getZoom();ne(this._proxy,this.project(e,o),this.getZoomScale(o,1))},this),this._on("unload",this._destroyAnimProxy,this)},_destroyAnimProxy:function(){ct(this._proxy),delete this._proxy},_catchTransitionEnd:function(t){this._animatingZoom&&t.propertyName.indexOf("transform")>=0&&this._onZoomTransitionEnd()},_nothingToAnimate:function(){return!this._container.getElementsByClassName("leaflet-zoom-animated").length},_tryAnimatedZoom:function(t,e,o){if(this._animatingZoom)return!0;if(o=o||{},!this._zoomAnimated||o.animate===!1||this._nothingToAnimate()||Math.abs(e-this._zoom)>this.options.zoomAnimationThreshold)return!1;var l=this.getZoomScale(e),u=this._getCenterOffset(t)._divideBy(1-1/l);return o.animate!==!0&&!this.getSize().contains(u)?!1:(B(function(){this._moveStart(!0,!1)._animateZoom(t,e,!0)},this),!0)},_animateZoom:function(t,e,o,l){this._mapPane&&(o&&(this._animatingZoom=!0,this._animateToCenter=t,this._animateToZoom=e,V(this._mapPane,"leaflet-zoom-anim")),this.fire("zoomanim",{center:t,zoom:e,noUpdate:l}),setTimeout(p(this._onZoomTransitionEnd,this),250))},_onZoomTransitionEnd:function(){this._animatingZoom&&(this._mapPane&&pt(this._mapPane,"leaflet-zoom-anim"),this._animatingZoom=!1,this._move(this._animateToCenter,this._animateToZoom),B(function(){this._moveEnd(!0)},this))}});function Qr(t,e){return new tt(t,e)}var St=S.extend({options:{position:"topright"},initialize:function(t){v(this,t)},getPosition:function(){return this.options.position},setPosition:function(t){var e=this._map;return e&&e.removeControl(this),this.options.position=t,e&&e.addControl(this),this},getContainer:function(){return this._container},addTo:function(t){this.remove(),this._map=t;var e=this._container=this.onAdd(t),o=this.getPosition(),l=t._controlCorners[o];return V(e,"leaflet-control"),o.indexOf("bottom")!==-1?l.insertBefore(e,l.firstChild):l.appendChild(e),this},remove:function(){return this._map?(ct(this._container),this.onRemove&&this.onRemove(this._map),this._map=null,this):this},_refocusOnMap:function(t){this._map&&t&&t.screenX>0&&t.screenY>0&&this._map.getContainer().focus()}}),He=function(t){return new St(t)};tt.include({addControl:function(t){return t.addTo(this),this},removeControl:function(t){return t.remove(),this},_initControlPos:function(){var t=this._controlCorners={},e="leaflet-",o=this._controlContainer=it("div",e+"control-container",this._container);function l(u,f){var m=e+u+" "+e+f;t[u+f]=it("div",m,o)}l("top","left"),l("top","right"),l("bottom","left"),l("bottom","right")},_clearControlPos:function(){for(var t in this._controlCorners)ct(this._controlCorners[t]);ct(this._controlContainer),delete this._controlCorners,delete this._controlContainer}});var vo=St.extend({options:{collapsed:!0,position:"topright",autoZIndex:!0,hideSingleBase:!1,sortLayers:!1,sortFunction:function(t,e,o,l){return o<l?-1:l<o?1:0}},initialize:function(t,e,o){v(this,o),this._layerControlInputs=[],this._layers=[],this._lastZIndex=0,this._handlingClick=!1;for(var l in t)this._addLayer(t[l],l);for(l in e)this._addLayer(e[l],l,!0)},onAdd:function(t){this._initLayout(),this._update(),this._map=t,t.on("zoomend",this._checkDisabledLayers,this);for(var e=0;e<this._layers.length;e++)this._layers[e].layer.on("add remove",this._onLayerChange,this);return this._container},addTo:function(t){return St.prototype.addTo.call(this,t),this._expandIfNotCollapsed()},onRemove:function(){this._map.off("zoomend",this._checkDisabledLayers,this);for(var t=0;t<this._layers.length;t++)this._layers[t].layer.off("add remove",this._onLayerChange,this)},addBaseLayer:function(t,e){return this._addLayer(t,e),this._map?this._update():this},addOverlay:function(t,e){return this._addLayer(t,e,!0),this._map?this._update():this},removeLayer:function(t){t.off("add remove",this._onLayerChange,this);var e=this._getLayer(g(t));return e&&this._layers.splice(this._layers.indexOf(e),1),this._map?this._update():this},expand:function(){V(this._container,"leaflet-control-layers-expanded"),this._form.style.height=null;var t=this._map.getSize().y-(this._container.offsetTop+50);return t<this._form.clientHeight?(V(this._form,"leaflet-control-layers-scrollbar"),this._form.style.height=t+"px"):pt(this._form,"leaflet-control-layers-scrollbar"),this._checkDisabledLayers(),this},collapse:function(){return pt(this._container,"leaflet-control-layers-expanded"),this},_initLayout:function(){var t="leaflet-control-layers",e=this._container=it("div",t),o=this.options.collapsed;e.setAttribute("aria-haspopup",!0),Fe(e),un(e);var l=this._form=it("form",t+"-list");o&&(this._map.on("click",this.collapse,this),me||q(e,{mouseenter:this.expand,mouseleave:this.collapse},this));var u=this._layersLink=it("a",t+"-toggle",e);u.href="#",u.title="Layers",Dt?(q(u,"click",zt),q(u,"click",this.expand,this)):q(u,"focus",this.expand,this),o||this.expand(),this._baseLayersList=it("div",t+"-base",l),this._separator=it("div",t+"-separator",l),this._overlaysList=it("div",t+"-overlays",l),e.appendChild(l)},_getLayer:function(t){for(var e=0;e<this._layers.length;e++)if(this._layers[e]&&g(this._layers[e].layer)===t)return this._layers[e]},_addLayer:function(t,e,o){this._map&&t.on("add remove",this._onLayerChange,this),this._layers.push({layer:t,name:e,overlay:o}),this.options.sortLayers&&this._layers.sort(p(function(l,u){return this.options.sortFunction(l.layer,u.layer,l.name,u.name)},this)),this.options.autoZIndex&&t.setZIndex&&(this._lastZIndex++,t.setZIndex(this._lastZIndex)),this._expandIfNotCollapsed()},_update:function(){if(!this._container)return this;tn(this._baseLayersList),tn(this._overlaysList),this._layerControlInputs=[];var t,e,o,l,u=0;for(o=0;o<this._layers.length;o++)l=this._layers[o],this._addItem(l),e=e||l.overlay,t=t||!l.overlay,u+=l.overlay?0:1;return this.options.hideSingleBase&&(t=t&&u>1,this._baseLayersList.style.display=t?"":"none"),this._separator.style.display=e&&t?"":"none",this},_onLayerChange:function(t){this._handlingClick||this._update();var e=this._getLayer(g(t.target)),o=e.overlay?t.type==="add"?"overlayadd":"overlayremove":t.type==="add"?"baselayerchange":null;o&&this._map.fire(o,e)},_createRadioElement:function(t,e){var o='<input type="radio" class="leaflet-control-layers-selector" name="'+t+'"'+(e?' checked="checked"':"")+"/>",l=document.createElement("div");return l.innerHTML=o,l.firstChild},_addItem:function(t){var e=document.createElement("label"),o=this._map.hasLayer(t.layer),l;t.overlay?(l=document.createElement("input"),l.type="checkbox",l.className="leaflet-control-layers-selector",l.defaultChecked=o):l=this._createRadioElement("leaflet-base-layers",o),this._layerControlInputs.push(l),l.layerId=g(t.layer),q(l,"click",this._onInputClick,this);var u=document.createElement("span");u.innerHTML=" "+t.name;var f=document.createElement("div");e.appendChild(f),f.appendChild(l),f.appendChild(u);var m=t.overlay?this._overlaysList:this._baseLayersList;return m.appendChild(e),this._checkDisabledLayers(),e},_onInputClick:function(){var t=this._layerControlInputs,e,o,l=[],u=[];this._handlingClick=!0;for(var f=t.length-1;f>=0;f--)e=t[f],o=this._getLayer(e.layerId).layer,e.checked?l.push(o):e.checked||u.push(o);for(f=0;f<u.length;f++)this._map.hasLayer(u[f])&&this._map.removeLayer(u[f]);for(f=0;f<l.length;f++)this._map.hasLayer(l[f])||this._map.addLayer(l[f]);this._handlingClick=!1,this._refocusOnMap()},_checkDisabledLayers:function(){for(var t=this._layerControlInputs,e,o,l=this._map.getZoom(),u=t.length-1;u>=0;u--)e=t[u],o=this._getLayer(e.layerId).layer,e.disabled=o.options.minZoom!==void 0&&l<o.options.minZoom||o.options.maxZoom!==void 0&&l>o.options.maxZoom},_expandIfNotCollapsed:function(){return this._map&&!this.options.collapsed&&this.expand(),this},_expand:function(){return this.expand()},_collapse:function(){return this.collapse()}}),ta=function(t,e,o){return new vo(t,e,o)},_n=St.extend({options:{position:"topleft",zoomInText:"+",zoomInTitle:"Zoom in",zoomOutText:"&#x2212;",zoomOutTitle:"Zoom out"},onAdd:function(t){var e="leaflet-control-zoom",o=it("div",e+" leaflet-bar"),l=this.options;return this._zoomInButton=this._createButton(l.zoomInText,l.zoomInTitle,e+"-in",o,this._zoomIn),this._zoomOutButton=this._createButton(l.zoomOutText,l.zoomOutTitle,e+"-out",o,this._zoomOut),this._updateDisabled(),t.on("zoomend zoomlevelschange",this._updateDisabled,this),o},onRemove:function(t){t.off("zoomend zoomlevelschange",this._updateDisabled,this)},disable:function(){return this._disabled=!0,this._updateDisabled(),this},enable:function(){return this._disabled=!1,this._updateDisabled(),this},_zoomIn:function(t){!this._disabled&&this._map._zoom<this._map.getMaxZoom()&&this._map.zoomIn(this._map.options.zoomDelta*(t.shiftKey?3:1))},_zoomOut:function(t){!this._disabled&&this._map._zoom>this._map.getMinZoom()&&this._map.zoomOut(this._map.options.zoomDelta*(t.shiftKey?3:1))},_createButton:function(t,e,o,l,u){var f=it("a",o,l);return f.innerHTML=t,f.href="#",f.title=e,f.setAttribute("role","button"),f.setAttribute("aria-label",e),Fe(f),q(f,"click",zt),q(f,"click",u,this),q(f,"click",this._refocusOnMap,this),f},_updateDisabled:function(){var t=this._map,e="leaflet-disabled";pt(this._zoomInButton,e),pt(this._zoomOutButton,e),(this._disabled||t._zoom===t.getMinZoom())&&V(this._zoomOutButton,e),(this._disabled||t._zoom===t.getMaxZoom())&&V(this._zoomInButton,e)}});tt.mergeOptions({zoomControl:!0}),tt.addInitHook(function(){this.options.zoomControl&&(this.zoomControl=new _n,this.addControl(this.zoomControl))});var ea=function(t){return new _n(t)},yo=St.extend({options:{position:"bottomleft",maxWidth:100,metric:!0,imperial:!0},onAdd:function(t){var e="leaflet-control-scale",o=it("div",e),l=this.options;return this._addScales(l,e+"-line",o),t.on(l.updateWhenIdle?"moveend":"move",this._update,this),t.whenReady(this._update,this),o},onRemove:function(t){t.off(this.options.updateWhenIdle?"moveend":"move",this._update,this)},_addScales:function(t,e,o){t.metric&&(this._mScale=it("div",e,o)),t.imperial&&(this._iScale=it("div",e,o))},_update:function(){var t=this._map,e=t.getSize().y/2,o=t.distance(t.containerPointToLatLng([0,e]),t.containerPointToLatLng([this.options.maxWidth,e]));this._updateScales(o)},_updateScales:function(t){this.options.metric&&t&&this._updateMetric(t),this.options.imperial&&t&&this._updateImperial(t)},_updateMetric:function(t){var e=this._getRoundNum(t),o=e<1e3?e+" m":e/1e3+" km";this._updateScale(this._mScale,o,e/t)},_updateImperial:function(t){var e=t*3.2808399,o,l,u;e>5280?(o=e/5280,l=this._getRoundNum(o),this._updateScale(this._iScale,l+" mi",l/o)):(u=this._getRoundNum(e),this._updateScale(this._iScale,u+" ft",u/e))},_updateScale:function(t,e,o){t.style.width=Math.round(this.options.maxWidth*o)+"px",t.innerHTML=e},_getRoundNum:function(t){var e=Math.pow(10,(Math.floor(t)+"").length-1),o=t/e;return o=o>=10?10:o>=5?5:o>=3?3:o>=2?2:1,e*o}}),ia=function(t){return new yo(t)},gn=St.extend({options:{position:"bottomright",prefix:'<a href="http://leafletjs.com" title="A JS library for interactive maps">Leaflet</a>'},initialize:function(t){v(this,t),this._attributions={}},onAdd:function(t){t.attributionControl=this,this._container=it("div","leaflet-control-attribution"),Fe(this._container);for(var e in t._layers)t._layers[e].getAttribution&&this.addAttribution(t._layers[e].getAttribution());return this._update(),this._container},setPrefix:function(t){return this.options.prefix=t,this._update(),this},addAttribution:function(t){return t?(this._attributions[t]||(this._attributions[t]=0),this._attributions[t]++,this._update(),this):this},removeAttribution:function(t){return t?(this._attributions[t]&&(this._attributions[t]--,this._update()),this):this},_update:function(){if(this._map){var t=[];for(var e in this._attributions)this._attributions[e]&&t.push(e);var o=[];this.options.prefix&&o.push(this.options.prefix),t.length&&o.push(t.join(", ")),this._container.innerHTML=o.join(" | ")}}});tt.mergeOptions({attributionControl:!0}),tt.addInitHook(function(){this.options.attributionControl&&new gn().addTo(this)});var na=function(t){return new gn(t)};St.Layers=vo,St.Zoom=_n,St.Scale=yo,St.Attribution=gn,He.layers=ta,He.zoom=ea,He.scale=ia,He.attribution=na;var It=S.extend({initialize:function(t){this._map=t},enable:function(){return this._enabled?this:(this._enabled=!0,this.addHooks(),this)},disable:function(){return this._enabled?(this._enabled=!1,this.removeHooks(),this):this},enabled:function(){return!!this._enabled}});It.addTo=function(t,e){return t.addHandler(e,this),this};var oa={Events:et},Lo=Dt?"touchstart mousedown":"mousedown",xo={mousedown:"mouseup",touchstart:"touchend",pointerdown:"touchend",MSPointerDown:"touchend"},vn={mousedown:"mousemove",touchstart:"touchmove",pointerdown:"touchmove",MSPointerDown:"touchmove"},re=xt.extend({options:{clickTolerance:3},initialize:function(t,e,o,l){v(this,l),this._element=t,this._dragStartTarget=e||t,this._preventOutline=o},enable:function(){this._enabled||(q(this._dragStartTarget,Lo,this._onDown,this),this._enabled=!0)},disable:function(){this._enabled&&(re._dragging===this&&this.finishDrag(),_t(this._dragStartTarget,Lo,this._onDown,this),this._enabled=!1,this._moved=!1)},_onDown:function(t){if(!(t._simulated||!this._enabled)&&(this._moved=!1,!en(this._element,"leaflet-zoom-anim")&&!(re._dragging||t.shiftKey||t.which!==1&&t.button!==1&&!t.touches)&&(re._dragging=this,this._preventOutline&&ln(this._element),rn(),Ze(),!this._moving))){this.fire("down");var e=t.touches?t.touches[0]:t,o=po(this._element);this._startPoint=new R(e.clientX,e.clientY),this._parentScale=hn(o),q(document,vn[t.type],this._onMove,this),q(document,xo[t.type],this._onUp,this)}},_onMove:function(t){if(!(t._simulated||!this._enabled)){if(t.touches&&t.touches.length>1){this._moved=!0;return}var e=t.touches&&t.touches.length===1?t.touches[0]:t,o=new R(e.clientX,e.clientY)._subtract(this._startPoint);!o.x&&!o.y||Math.abs(o.x)+Math.abs(o.y)<this.options.clickTolerance||(o.x/=this._parentScale.x,o.y/=this._parentScale.y,Ot(t),this._moved||(this.fire("dragstart"),this._moved=!0,this._startPos=Jt(this._element).subtract(o),V(document.body,"leaflet-dragging"),this._lastTarget=t.target||t.srcElement,window.SVGElementInstance&&this._lastTarget instanceof SVGElementInstance&&(this._lastTarget=this._lastTarget.correspondingUseElement),V(this._lastTarget,"leaflet-drag-target")),this._newPos=this._startPos.add(o),this._moving=!0,$(this._animRequest),this._lastEvent=t,this._animRequest=B(this._updatePosition,this,!0))}},_updatePosition:function(){var t={originalEvent:this._lastEvent};this.fire("predrag",t),gt(this._element,this._newPos),this.fire("drag",t)},_onUp:function(t){t._simulated||!this._enabled||this.finishDrag()},finishDrag:function(){pt(document.body,"leaflet-dragging"),this._lastTarget&&(pt(this._lastTarget,"leaflet-drag-target"),this._lastTarget=null);for(var t in vn)_t(document,vn[t],this._onMove,this),_t(document,xo[t],this._onUp,this);an(),$e(),this._moved&&this._moving&&($(this._animRequest),this.fire("dragend",{distance:this._newPos.distanceTo(this._startPos)})),this._moving=!1,re._dragging=!1}});function bo(t,e){if(!e||!t.length)return t.slice();var o=e*e;return t=sa(t,o),t=aa(t,o),t}function wo(t,e,o){return Math.sqrt(Ge(t,e,o,!0))}function ra(t,e,o){return Ge(t,e,o)}function aa(t,e){var o=t.length,l=typeof Uint8Array<"u"?Uint8Array:Array,u=new l(o);u[0]=u[o-1]=1,yn(t,u,e,0,o-1);var f,m=[];for(f=0;f<o;f++)u[f]&&m.push(t[f]);return m}function yn(t,e,o,l,u){var f=0,m,y,x;for(y=l+1;y<=u-1;y++)x=Ge(t[y],t[l],t[u],!0),x>f&&(m=y,f=x);f>o&&(e[m]=1,yn(t,e,o,l,m),yn(t,e,o,m,u))}function sa(t,e){for(var o=[t[0]],l=1,u=0,f=t.length;l<f;l++)la(t[l],t[u])>e&&(o.push(t[l]),u=l);return u<f-1&&o.push(t[f-1]),o}var Eo;function Po(t,e,o,l,u){var f=l?Eo:ae(t,o),m=ae(e,o),y,x,E;for(Eo=m;;){if(!(f|m))return[t,e];if(f&m)return!1;y=f||m,x=pi(t,e,y,o,u),E=ae(x,o),y===f?(t=x,f=E):(e=x,m=E)}}function pi(t,e,o,l,u){var f=e.x-t.x,m=e.y-t.y,y=l.min,x=l.max,E,N;return o&8?(E=t.x+f*(x.y-t.y)/m,N=x.y):o&4?(E=t.x+f*(y.y-t.y)/m,N=y.y):o&2?(E=x.x,N=t.y+m*(x.x-t.x)/f):o&1&&(E=y.x,N=t.y+m*(y.x-t.x)/f),new R(E,N,u)}function ae(t,e){var o=0;return t.x<e.min.x?o|=1:t.x>e.max.x&&(o|=2),t.y<e.min.y?o|=4:t.y>e.max.y&&(o|=8),o}function la(t,e){var o=e.x-t.x,l=e.y-t.y;return o*o+l*l}function Ge(t,e,o,l){var u=e.x,f=e.y,m=o.x-u,y=o.y-f,x=m*m+y*y,E;return x>0&&(E=((t.x-u)*m+(t.y-f)*y)/x,E>1?(u=o.x,f=o.y):E>0&&(u+=m*E,f+=y*E)),m=t.x-u,y=t.y-f,l?m*m+y*y:new R(u,f)}function Zt(t){return!k(t[0])||typeof t[0][0]!="object"&&typeof t[0][0]<"u"}function To(t){return console.warn("Deprecated use of _flat, please use L.LineUtil.isFlat instead."),Zt(t)}var ha=(Object.freeze||Object)({simplify:bo,pointToSegmentDistance:wo,closestPointOnSegment:ra,clipSegment:Po,_getEdgeIntersection:pi,_getBitCode:ae,_sqClosestPointOnSegment:Ge,isFlat:Zt,_flat:To});function Oo(t,e,o){var l,u=[1,4,2,8],f,m,y,x,E,N,U,Q;for(f=0,N=t.length;f<N;f++)t[f]._code=ae(t[f],e);for(y=0;y<4;y++){for(U=u[y],l=[],f=0,N=t.length,m=N-1;f<N;m=f++)x=t[f],E=t[m],x._code&U?E._code&U||(Q=pi(E,x,U,e,o),Q._code=ae(Q,e),l.push(Q)):(E._code&U&&(Q=pi(E,x,U,e,o),Q._code=ae(Q,e),l.push(Q)),l.push(x));t=l}return t}var ca=(Object.freeze||Object)({clipPolygon:Oo}),Ln={project:function(t){return new R(t.lng,t.lat)},unproject:function(t){return new st(t.y,t.x)},bounds:new C([-180,-90],[180,90])},xn={R:6378137,R_MINOR:6356752314245179e-9,bounds:new C([-2003750834279e-5,-1549657073972e-5],[2003750834279e-5,1876465623138e-5]),project:function(t){var e=Math.PI/180,o=this.R,l=t.lat*e,u=this.R_MINOR/o,f=Math.sqrt(1-u*u),m=f*Math.sin(l),y=Math.tan(Math.PI/4-l/2)/Math.pow((1-m)/(1+m),f/2);return l=-o*Math.log(Math.max(y,1e-10)),new R(t.lng*e*o,l)},unproject:function(t){for(var e=180/Math.PI,o=this.R,l=this.R_MINOR/o,u=Math.sqrt(1-l*l),f=Math.exp(-t.y/o),m=Math.PI/2-2*Math.atan(f),y=0,x=.1,E;y<15&&Math.abs(x)>1e-7;y++)E=u*Math.sin(m),E=Math.pow((1-E)/(1+E),u/2),x=Math.PI/2-2*Math.atan(f*E)-m,m+=x;return new st(m*e,t.x*e/o)}},ua=(Object.freeze||Object)({LonLat:Ln,Mercator:xn,SphericalMercator:Ai}),da=r({},qt,{code:"EPSG:3395",projection:xn,transformation:function(){var t=.5/(Math.PI*xn.R);return Ne(t,.5,-t,.5)}()}),ko=r({},qt,{code:"EPSG:4326",projection:Ln,transformation:Ne(1/180,1,-1/180,.5)}),fa=r({},Bt,{projection:Ln,transformation:Ne(1,0,-1,0),scale:function(t){return Math.pow(2,t)},zoom:function(t){return Math.log(t)/Math.LN2},distance:function(t,e){var o=e.lng-t.lng,l=e.lat-t.lat;return Math.sqrt(o*o+l*l)},infinite:!0});Bt.Earth=qt,Bt.EPSG3395=da,Bt.EPSG3857=Zi,Bt.EPSG900913=Nr,Bt.EPSG4326=ko,Bt.Simple=fa;var kt=xt.extend({options:{pane:"overlayPane",attribution:null,bubblingMouseEvents:!0},addTo:function(t){return t.addLayer(this),this},remove:function(){return this.removeFrom(this._map||this._mapToAdd)},removeFrom:function(t){return t&&t.removeLayer(this),this},getPane:function(t){return this._map.getPane(t?this.options[t]||t:this.options.pane)},addInteractiveTarget:function(t){return this._map._targets[g(t)]=this,this},removeInteractiveTarget:function(t){return delete this._map._targets[g(t)],this},getAttribution:function(){return this.options.attribution},_layerAdd:function(t){var e=t.target;if(e.hasLayer(this)){if(this._map=e,this._zoomAnimated=e._zoomAnimated,this.getEvents){var o=this.getEvents();e.on(o,this),this.once("remove",function(){e.off(o,this)},this)}this.onAdd(e),this.getAttribution&&e.attributionControl&&e.attributionControl.addAttribution(this.getAttribution()),this.fire("add"),e.fire("layeradd",{layer:this})}}});tt.include({addLayer:function(t){if(!t._layerAdd)throw new Error("The provided object is not a Layer.");var e=g(t);return this._layers[e]?this:(this._layers[e]=t,t._mapToAdd=this,t.beforeAdd&&t.beforeAdd(this),this.whenReady(t._layerAdd,t),this)},removeLayer:function(t){var e=g(t);return this._layers[e]?(this._loaded&&t.onRemove(this),t.getAttribution&&this.attributionControl&&this.attributionControl.removeAttribution(t.getAttribution()),delete this._layers[e],this._loaded&&(this.fire("layerremove",{layer:t}),t.fire("remove")),t._map=t._mapToAdd=null,this):this},hasLayer:function(t){return!!t&&g(t)in this._layers},eachLayer:function(t,e){for(var o in this._layers)t.call(e,this._layers[o]);return this},_addLayers:function(t){t=t?k(t)?t:[t]:[];for(var e=0,o=t.length;e<o;e++)this.addLayer(t[e])},_addZoomLimit:function(t){(isNaN(t.options.maxZoom)||!isNaN(t.options.minZoom))&&(this._zoomBoundLayers[g(t)]=t,this._updateZoomLevels())},_removeZoomLimit:function(t){var e=g(t);this._zoomBoundLayers[e]&&(delete this._zoomBoundLayers[e],this._updateZoomLevels())},_updateZoomLevels:function(){var t=1/0,e=-1/0,o=this._getZoomSpan();for(var l in this._zoomBoundLayers){var u=this._zoomBoundLayers[l].options;t=u.minZoom===void 0?t:Math.min(t,u.minZoom),e=u.maxZoom===void 0?e:Math.max(e,u.maxZoom)}this._layersMaxZoom=e===-1/0?void 0:e,this._layersMinZoom=t===1/0?void 0:t,o!==this._getZoomSpan()&&this.fire("zoomlevelschange"),this.options.maxZoom===void 0&&this._layersMaxZoom&&this.getZoom()>this._layersMaxZoom&&this.setZoom(this._layersMaxZoom),this.options.minZoom===void 0&&this._layersMinZoom&&this.getZoom()<this._layersMinZoom&&this.setZoom(this._layersMinZoom)}});var xe=kt.extend({initialize:function(t,e){v(this,e),this._layers={};var o,l;if(t)for(o=0,l=t.length;o<l;o++)this.addLayer(t[o])},addLayer:function(t){var e=this.getLayerId(t);return this._layers[e]=t,this._map&&this._map.addLayer(t),this},removeLayer:function(t){var e=t in this._layers?t:this.getLayerId(t);return this._map&&this._layers[e]&&this._map.removeLayer(this._layers[e]),delete this._layers[e],this},hasLayer:function(t){return!!t&&(t in this._layers||this.getLayerId(t)in this._layers)},clearLayers:function(){return this.eachLayer(this.removeLayer,this)},invoke:function(t){var e=Array.prototype.slice.call(arguments,1),o,l;for(o in this._layers)l=this._layers[o],l[t]&&l[t].apply(l,e);return this},onAdd:function(t){this.eachLayer(t.addLayer,t)},onRemove:function(t){this.eachLayer(t.removeLayer,t)},eachLayer:function(t,e){for(var o in this._layers)t.call(e,this._layers[o]);return this},getLayer:function(t){return this._layers[t]},getLayers:function(){var t=[];return this.eachLayer(t.push,t),t},setZIndex:function(t){return this.invoke("setZIndex",t)},getLayerId:function(t){return g(t)}}),pa=function(t,e){return new xe(t,e)},se=xe.extend({addLayer:function(t){return this.hasLayer(t)?this:(t.addEventParent(this),xe.prototype.addLayer.call(this,t),this.fire("layeradd",{layer:t}))},removeLayer:function(t){return this.hasLayer(t)?(t in this._layers&&(t=this._layers[t]),t.removeEventParent(this),xe.prototype.removeLayer.call(this,t),this.fire("layerremove",{layer:t})):this},setStyle:function(t){return this.invoke("setStyle",t)},bringToFront:function(){return this.invoke("bringToFront")},bringToBack:function(){return this.invoke("bringToBack")},getBounds:function(){var t=new Et;for(var e in this._layers){var o=this._layers[e];t.extend(o.getBounds?o.getBounds():o.getLatLng())}return t}}),ma=function(t){return new se(t)},be=S.extend({options:{popupAnchor:[0,0],tooltipAnchor:[0,0]},initialize:function(t){v(this,t)},createIcon:function(t){return this._createIcon("icon",t)},createShadow:function(t){return this._createIcon("shadow",t)},_createIcon:function(t,e){var o=this._getIconUrl(t);if(!o){if(t==="icon")throw new Error("iconUrl not set in Icon options (see the docs).");return null}var l=this._createImg(o,e&&e.tagName==="IMG"?e:null);return this._setIconStyles(l,t),l},_setIconStyles:function(t,e){var o=this.options,l=o[e+"Size"];typeof l=="number"&&(l=[l,l]);var u=J(l),f=J(e==="shadow"&&o.shadowAnchor||o.iconAnchor||u&&u.divideBy(2,!0));t.className="leaflet-marker-"+e+" "+(o.className||""),f&&(t.style.marginLeft=-f.x+"px",t.style.marginTop=-f.y+"px"),u&&(t.style.width=u.x+"px",t.style.height=u.y+"px")},_createImg:function(t,e){return e=e||document.createElement("img"),e.src=t,e},_getIconUrl:function(t){return Kt&&this.options[t+"RetinaUrl"]||this.options[t+"Url"]}});function _a(t){return new be(t)}var We=be.extend({options:{iconUrl:"marker-icon.png",iconRetinaUrl:"marker-icon-2x.png",shadowUrl:"marker-shadow.png",iconSize:[25,41],iconAnchor:[12,41],popupAnchor:[1,-34],tooltipAnchor:[16,-28],shadowSize:[41,41]},_getIconUrl:function(t){return We.imagePath||(We.imagePath=this._detectIconPath()),(this.options.imagePath||We.imagePath)+be.prototype._getIconUrl.call(this,t)},_detectIconPath:function(){var t=it("div","leaflet-default-icon-path",document.body),e=Be(t,"background-image")||Be(t,"backgroundImage");return document.body.removeChild(t),e===null||e.indexOf("url")!==0?e="":e=e.replace(/^url\(["']?/,"").replace(/marker-icon\.png["']?\)$/,""),e}}),Mo=It.extend({initialize:function(t){this._marker=t},addHooks:function(){var t=this._marker._icon;this._draggable||(this._draggable=new re(t,t,!0)),this._draggable.on({dragstart:this._onDragStart,predrag:this._onPreDrag,drag:this._onDrag,dragend:this._onDragEnd},this).enable(),V(t,"leaflet-marker-draggable")},removeHooks:function(){this._draggable.off({dragstart:this._onDragStart,predrag:this._onPreDrag,drag:this._onDrag,dragend:this._onDragEnd},this).disable(),this._marker._icon&&pt(this._marker._icon,"leaflet-marker-draggable")},moved:function(){return this._draggable&&this._draggable._moved},_adjustPan:function(t){var e=this._marker,o=e._map,l=this._marker.options.autoPanSpeed,u=this._marker.options.autoPanPadding,f=Jt(e._icon),m=o.getPixelBounds(),y=o.getPixelOrigin(),x=ot(m.min._subtract(y).add(u),m.max._subtract(y).subtract(u));if(!x.contains(f)){var E=J((Math.max(x.max.x,f.x)-x.max.x)/(m.max.x-x.max.x)-(Math.min(x.min.x,f.x)-x.min.x)/(m.min.x-x.min.x),(Math.max(x.max.y,f.y)-x.max.y)/(m.max.y-x.max.y)-(Math.min(x.min.y,f.y)-x.min.y)/(m.min.y-x.min.y)).multiplyBy(l);o.panBy(E,{animate:!1}),this._draggable._newPos._add(E),this._draggable._startPos._add(E),gt(e._icon,this._draggable._newPos),this._onDrag(t),this._panRequest=B(this._adjustPan.bind(this,t))}},_onDragStart:function(){this._oldLatLng=this._marker.getLatLng(),this._marker.closePopup().fire("movestart").fire("dragstart")},_onPreDrag:function(t){this._marker.options.autoPan&&($(this._panRequest),this._panRequest=B(this._adjustPan.bind(this,t)))},_onDrag:function(t){var e=this._marker,o=e._shadow,l=Jt(e._icon),u=e._map.layerPointToLatLng(l);o&&gt(o,l),e._latlng=u,t.latlng=u,t.oldLatLng=this._oldLatLng,e.fire("move",t).fire("drag",t)},_onDragEnd:function(t){$(this._panRequest),delete this._oldLatLng,this._marker.fire("moveend").fire("dragend",t)}}),Ve=kt.extend({options:{icon:new We,interactive:!0,keyboard:!0,title:"",alt:"",zIndexOffset:0,opacity:1,riseOnHover:!1,riseOffset:250,pane:"markerPane",bubblingMouseEvents:!1,draggable:!1,autoPan:!1,autoPanPadding:[50,50],autoPanSpeed:10},initialize:function(t,e){v(this,e),this._latlng=ft(t)},onAdd:function(t){this._zoomAnimated=this._zoomAnimated&&t.options.markerZoomAnimation,this._zoomAnimated&&t.on("zoomanim",this._animateZoom,this),this._initIcon(),this.update()},onRemove:function(t){this.dragging&&this.dragging.enabled()&&(this.options.draggable=!0,this.dragging.removeHooks()),delete this.dragging,this._zoomAnimated&&t.off("zoomanim",this._animateZoom,this),this._removeIcon(),this._removeShadow()},getEvents:function(){return{zoom:this.update,viewreset:this.update}},getLatLng:function(){return this._latlng},setLatLng:function(t){var e=this._latlng;return this._latlng=ft(t),this.update(),this.fire("move",{oldLatLng:e,latlng:this._latlng})},setZIndexOffset:function(t){return this.options.zIndexOffset=t,this.update()},setIcon:function(t){return this.options.icon=t,this._map&&(this._initIcon(),this.update()),this._popup&&this.bindPopup(this._popup,this._popup.options),this},getElement:function(){return this._icon},update:function(){if(this._icon&&this._map){var t=this._map.latLngToLayerPoint(this._latlng).round();this._setPos(t)}return this},_initIcon:function(){var t=this.options,e="leaflet-zoom-"+(this._zoomAnimated?"animated":"hide"),o=t.icon.createIcon(this._icon),l=!1;o!==this._icon&&(this._icon&&this._removeIcon(),l=!0,t.title&&(o.title=t.title),o.tagName==="IMG"&&(o.alt=t.alt||"")),V(o,e),t.keyboard&&(o.tabIndex="0"),this._icon=o,t.riseOnHover&&this.on({mouseover:this._bringToFront,mouseout:this._resetZIndex});var u=t.icon.createShadow(this._shadow),f=!1;u!==this._shadow&&(this._removeShadow(),f=!0),u&&(V(u,e),u.alt=""),this._shadow=u,t.opacity<1&&this._updateOpacity(),l&&this.getPane().appendChild(this._icon),this._initInteraction(),u&&f&&this.getPane("shadowPane").appendChild(this._shadow)},_removeIcon:function(){this.options.riseOnHover&&this.off({mouseover:this._bringToFront,mouseout:this._resetZIndex}),ct(this._icon),this.removeInteractiveTarget(this._icon),this._icon=null},_removeShadow:function(){this._shadow&&ct(this._shadow),this._shadow=null},_setPos:function(t){gt(this._icon,t),this._shadow&&gt(this._shadow,t),this._zIndex=t.y+this.options.zIndexOffset,this._resetZIndex()},_updateZIndex:function(t){this._icon.style.zIndex=this._zIndex+t},_animateZoom:function(t){var e=this._map._latLngToNewLayerPoint(this._latlng,t.zoom,t.center).round();this._setPos(e)},_initInteraction:function(){if(this.options.interactive&&(V(this._icon,"leaflet-interactive"),this.addInteractiveTarget(this._icon),Mo)){var t=this.options.draggable;this.dragging&&(t=this.dragging.enabled(),this.dragging.disable()),this.dragging=new Mo(this),t&&this.dragging.enable()}},setOpacity:function(t){return this.options.opacity=t,this._map&&this._updateOpacity(),this},_updateOpacity:function(){var t=this.options.opacity;Tt(this._icon,t),this._shadow&&Tt(this._shadow,t)},_bringToFront:function(){this._updateZIndex(this.options.riseOffset)},_resetZIndex:function(){this._updateZIndex(0)},_getPopupAnchor:function(){return this.options.icon.options.popupAnchor},_getTooltipAnchor:function(){return this.options.icon.options.tooltipAnchor}});function ga(t,e){return new Ve(t,e)}var Xt=kt.extend({options:{stroke:!0,color:"#3388ff",weight:3,opacity:1,lineCap:"round",lineJoin:"round",dashArray:null,dashOffset:null,fill:!1,fillColor:null,fillOpacity:.2,fillRule:"evenodd",interactive:!0,bubblingMouseEvents:!0},beforeAdd:function(t){this._renderer=t.getRenderer(this)},onAdd:function(){this._renderer._initPath(this),this._reset(),this._renderer._addPath(this)},onRemove:function(){this._renderer._removePath(this)},redraw:function(){return this._map&&this._renderer._updatePath(this),this},setStyle:function(t){return v(this,t),this._renderer&&this._renderer._updateStyle(this),this},bringToFront:function(){return this._renderer&&this._renderer._bringToFront(this),this},bringToBack:function(){return this._renderer&&this._renderer._bringToBack(this),this},getElement:function(){return this._path},_reset:function(){this._project(),this._update()},_clickTolerance:function(){return(this.options.stroke?this.options.weight/2:0)+this._renderer.options.tolerance}}),mi=Xt.extend({options:{fill:!0,radius:10},initialize:function(t,e){v(this,e),this._latlng=ft(t),this._radius=this.options.radius},setLatLng:function(t){return this._latlng=ft(t),this.redraw(),this.fire("move",{latlng:this._latlng})},getLatLng:function(){return this._latlng},setRadius:function(t){return this.options.radius=this._radius=t,this.redraw()},getRadius:function(){return this._radius},setStyle:function(t){var e=t&&t.radius||this._radius;return Xt.prototype.setStyle.call(this,t),this.setRadius(e),this},_project:function(){this._point=this._map.latLngToLayerPoint(this._latlng),this._updateBounds()},_updateBounds:function(){var t=this._radius,e=this._radiusY||t,o=this._clickTolerance(),l=[t+o,e+o];this._pxBounds=new C(this._point.subtract(l),this._point.add(l))},_update:function(){this._map&&this._updatePath()},_updatePath:function(){this._renderer._updateCircle(this)},_empty:function(){return this._radius&&!this._renderer._bounds.intersects(this._pxBounds)},_containsPoint:function(t){return t.distanceTo(this._point)<=this._radius+this._clickTolerance()}});function va(t,e){return new mi(t,e)}var bn=mi.extend({initialize:function(t,e,o){if(typeof e=="number"&&(e=r({},o,{radius:e})),v(this,e),this._latlng=ft(t),isNaN(this.options.radius))throw new Error("Circle radius cannot be NaN");this._mRadius=this.options.radius},setRadius:function(t){return this._mRadius=t,this.redraw()},getRadius:function(){return this._mRadius},getBounds:function(){var t=[this._radius,this._radiusY||this._radius];return new Et(this._map.layerPointToLatLng(this._point.subtract(t)),this._map.layerPointToLatLng(this._point.add(t)))},setStyle:Xt.prototype.setStyle,_project:function(){var t=this._latlng.lng,e=this._latlng.lat,o=this._map,l=o.options.crs;if(l.distance===qt.distance){var u=Math.PI/180,f=this._mRadius/qt.R/u,m=o.project([e+f,t]),y=o.project([e-f,t]),x=m.add(y).divideBy(2),E=o.unproject(x).lat,N=Math.acos((Math.cos(f*u)-Math.sin(e*u)*Math.sin(E*u))/(Math.cos(e*u)*Math.cos(E*u)))/u;(isNaN(N)||N===0)&&(N=f/Math.cos(Math.PI/180*e)),this._point=x.subtract(o.getPixelOrigin()),this._radius=isNaN(N)?0:x.x-o.project([E,t-N]).x,this._radiusY=x.y-m.y}else{var U=l.unproject(l.project(this._latlng).subtract([this._mRadius,0]));this._point=o.latLngToLayerPoint(this._latlng),this._radius=this._point.x-o.latLngToLayerPoint(U).x}this._updateBounds()}});function ya(t,e,o){return new bn(t,e,o)}var $t=Xt.extend({options:{smoothFactor:1,noClip:!1},initialize:function(t,e){v(this,e),this._setLatLngs(t)},getLatLngs:function(){return this._latlngs},setLatLngs:function(t){return this._setLatLngs(t),this.redraw()},isEmpty:function(){return!this._latlngs.length},closestLayerPoint:function(t){for(var e=1/0,o=null,l=Ge,u,f,m=0,y=this._parts.length;m<y;m++)for(var x=this._parts[m],E=1,N=x.length;E<N;E++){u=x[E-1],f=x[E];var U=l(t,u,f,!0);U<e&&(e=U,o=l(t,u,f))}return o&&(o.distance=Math.sqrt(e)),o},getCenter:function(){if(!this._map)throw new Error("Must add layer to map before using getCenter()");var t,e,o,l,u,f,m,y=this._rings[0],x=y.length;if(!x)return null;for(t=0,e=0;t<x-1;t++)e+=y[t].distanceTo(y[t+1])/2;if(e===0)return this._map.layerPointToLatLng(y[0]);for(t=0,l=0;t<x-1;t++)if(u=y[t],f=y[t+1],o=u.distanceTo(f),l+=o,l>e)return m=(l-e)/o,this._map.layerPointToLatLng([f.x-m*(f.x-u.x),f.y-m*(f.y-u.y)])},getBounds:function(){return this._bounds},addLatLng:function(t,e){return e=e||this._defaultShape(),t=ft(t),e.push(t),this._bounds.extend(t),this.redraw()},_setLatLngs:function(t){this._bounds=new Et,this._latlngs=this._convertLatLngs(t)},_defaultShape:function(){return Zt(this._latlngs)?this._latlngs:this._latlngs[0]},_convertLatLngs:function(t){for(var e=[],o=Zt(t),l=0,u=t.length;l<u;l++)o?(e[l]=ft(t[l]),this._bounds.extend(e[l])):e[l]=this._convertLatLngs(t[l]);return e},_project:function(){var t=new C;this._rings=[],this._projectLatlngs(this._latlngs,this._rings,t);var e=this._clickTolerance(),o=new R(e,e);this._bounds.isValid()&&t.isValid()&&(t.min._subtract(o),t.max._add(o),this._pxBounds=t)},_projectLatlngs:function(t,e,o){var l=t[0]instanceof st,u=t.length,f,m;if(l){for(m=[],f=0;f<u;f++)m[f]=this._map.latLngToLayerPoint(t[f]),o.extend(m[f]);e.push(m)}else for(f=0;f<u;f++)this._projectLatlngs(t[f],e,o)},_clipPoints:function(){var t=this._renderer._bounds;if(this._parts=[],!(!this._pxBounds||!this._pxBounds.intersects(t))){if(this.options.noClip){this._parts=this._rings;return}var e=this._parts,o,l,u,f,m,y,x;for(o=0,u=0,f=this._rings.length;o<f;o++)for(x=this._rings[o],l=0,m=x.length;l<m-1;l++)y=Po(x[l],x[l+1],t,l,!0),y&&(e[u]=e[u]||[],e[u].push(y[0]),(y[1]!==x[l+1]||l===m-2)&&(e[u].push(y[1]),u++))}},_simplifyPoints:function(){for(var t=this._parts,e=this.options.smoothFactor,o=0,l=t.length;o<l;o++)t[o]=bo(t[o],e)},_update:function(){this._map&&(this._clipPoints(),this._simplifyPoints(),this._updatePath())},_updatePath:function(){this._renderer._updatePoly(this)},_containsPoint:function(t,e){var o,l,u,f,m,y,x=this._clickTolerance();if(!this._pxBounds||!this._pxBounds.contains(t))return!1;for(o=0,f=this._parts.length;o<f;o++)for(y=this._parts[o],l=0,m=y.length,u=m-1;l<m;u=l++)if(!(!e&&l===0)&&wo(t,y[u],y[l])<=x)return!0;return!1}});function La(t,e){return new $t(t,e)}$t._flat=To;var we=$t.extend({options:{fill:!0},isEmpty:function(){return!this._latlngs.length||!this._latlngs[0].length},getCenter:function(){if(!this._map)throw new Error("Must add layer to map before using getCenter()");var t,e,o,l,u,f,m,y,x,E=this._rings[0],N=E.length;if(!N)return null;for(f=m=y=0,t=0,e=N-1;t<N;e=t++)o=E[t],l=E[e],u=o.y*l.x-l.y*o.x,m+=(o.x+l.x)*u,y+=(o.y+l.y)*u,f+=u*3;return f===0?x=E[0]:x=[m/f,y/f],this._map.layerPointToLatLng(x)},_convertLatLngs:function(t){var e=$t.prototype._convertLatLngs.call(this,t),o=e.length;return o>=2&&e[0]instanceof st&&e[0].equals(e[o-1])&&e.pop(),e},_setLatLngs:function(t){$t.prototype._setLatLngs.call(this,t),Zt(this._latlngs)&&(this._latlngs=[this._latlngs])},_defaultShape:function(){return Zt(this._latlngs[0])?this._latlngs[0]:this._latlngs[0][0]},_clipPoints:function(){var t=this._renderer._bounds,e=this.options.weight,o=new R(e,e);if(t=new C(t.min.subtract(o),t.max.add(o)),this._parts=[],!(!this._pxBounds||!this._pxBounds.intersects(t))){if(this.options.noClip){this._parts=this._rings;return}for(var l=0,u=this._rings.length,f;l<u;l++)f=Oo(this._rings[l],t,!0),f.length&&this._parts.push(f)}},_updatePath:function(){this._renderer._updatePoly(this,!0)},_containsPoint:function(t){var e=!1,o,l,u,f,m,y,x,E;if(!this._pxBounds||!this._pxBounds.contains(t))return!1;for(f=0,x=this._parts.length;f<x;f++)for(o=this._parts[f],m=0,E=o.length,y=E-1;m<E;y=m++)l=o[m],u=o[y],l.y>t.y!=u.y>t.y&&t.x<(u.x-l.x)*(t.y-l.y)/(u.y-l.y)+l.x&&(e=!e);return e||$t.prototype._containsPoint.call(this,t,!0)}});function xa(t,e){return new we(t,e)}var Ut=se.extend({initialize:function(t,e){v(this,e),this._layers={},t&&this.addData(t)},addData:function(t){var e=k(t)?t:t.features,o,l,u;if(e){for(o=0,l=e.length;o<l;o++)u=e[o],(u.geometries||u.geometry||u.features||u.coordinates)&&this.addData(u);return this}var f=this.options;if(f.filter&&!f.filter(t))return this;var m=wn(t,f);return m?(m.feature=vi(t),m.defaultOptions=m.options,this.resetStyle(m),f.onEachFeature&&f.onEachFeature(t,m),this.addLayer(m)):this},resetStyle:function(t){return t.options=r({},t.defaultOptions),this._setLayerStyle(t,this.options.style),this},setStyle:function(t){return this.eachLayer(function(e){this._setLayerStyle(e,t)},this)},_setLayerStyle:function(t,e){typeof e=="function"&&(e=e(t.feature)),t.setStyle&&t.setStyle(e)}});function wn(t,e){var o=t.type==="Feature"?t.geometry:t,l=o?o.coordinates:null,u=[],f=e&&e.pointToLayer,m=e&&e.coordsToLatLng||En,y,x,E,N;if(!l&&!o)return null;switch(o.type){case"Point":return y=m(l),f?f(t,y):new Ve(y);case"MultiPoint":for(E=0,N=l.length;E<N;E++)y=m(l[E]),u.push(f?f(t,y):new Ve(y));return new se(u);case"LineString":case"MultiLineString":return x=_i(l,o.type==="LineString"?0:1,m),new $t(x,e);case"Polygon":case"MultiPolygon":return x=_i(l,o.type==="Polygon"?1:2,m),new we(x,e);case"GeometryCollection":for(E=0,N=o.geometries.length;E<N;E++){var U=wn({geometry:o.geometries[E],type:"Feature",properties:t.properties},e);U&&u.push(U)}return new se(u);default:throw new Error("Invalid GeoJSON object.")}}function En(t){return new st(t[1],t[0],t[2])}function _i(t,e,o){for(var l=[],u=0,f=t.length,m;u<f;u++)m=e?_i(t[u],e-1,o):(o||En)(t[u]),l.push(m);return l}function Pn(t,e){return e=typeof e=="number"?e:6,t.alt!==void 0?[H(t.lng,e),H(t.lat,e),H(t.alt,e)]:[H(t.lng,e),H(t.lat,e)]}function gi(t,e,o,l){for(var u=[],f=0,m=t.length;f<m;f++)u.push(e?gi(t[f],e-1,o,l):Pn(t[f],l));return!e&&o&&u.push(u[0]),u}function Ee(t,e){return t.feature?r({},t.feature,{geometry:e}):vi(e)}function vi(t){return t.type==="Feature"||t.type==="FeatureCollection"?t:{type:"Feature",properties:{},geometry:t}}var Tn={toGeoJSON:function(t){return Ee(this,{type:"Point",coordinates:Pn(this.getLatLng(),t)})}};Ve.include(Tn),bn.include(Tn),mi.include(Tn),$t.include({toGeoJSON:function(t){var e=!Zt(this._latlngs),o=gi(this._latlngs,e?1:0,!1,t);return Ee(this,{type:(e?"Multi":"")+"LineString",coordinates:o})}}),we.include({toGeoJSON:function(t){var e=!Zt(this._latlngs),o=e&&!Zt(this._latlngs[0]),l=gi(this._latlngs,o?2:e?1:0,!0,t);return e||(l=[l]),Ee(this,{type:(o?"Multi":"")+"Polygon",coordinates:l})}}),xe.include({toMultiPoint:function(t){var e=[];return this.eachLayer(function(o){e.push(o.toGeoJSON(t).geometry.coordinates)}),Ee(this,{type:"MultiPoint",coordinates:e})},toGeoJSON:function(t){var e=this.feature&&this.feature.geometry&&this.feature.geometry.type;if(e==="MultiPoint")return this.toMultiPoint(t);var o=e==="GeometryCollection",l=[];return this.eachLayer(function(u){if(u.toGeoJSON){var f=u.toGeoJSON(t);if(o)l.push(f.geometry);else{var m=vi(f);m.type==="FeatureCollection"?l.push.apply(l,m.features):l.push(m)}}}),o?Ee(this,{geometries:l,type:"GeometryCollection"}):{type:"FeatureCollection",features:l}}});function jo(t,e){return new Ut(t,e)}var ba=jo,On=kt.extend({options:{opacity:1,alt:"",interactive:!1,crossOrigin:!1,errorOverlayUrl:"",zIndex:1,className:""},initialize:function(t,e,o){this._url=t,this._bounds=Lt(e),v(this,o)},onAdd:function(){this._image||(this._initImage(),this.options.opacity<1&&this._updateOpacity()),this.options.interactive&&(V(this._image,"leaflet-interactive"),this.addInteractiveTarget(this._image)),this.getPane().appendChild(this._image),this._reset()},onRemove:function(){ct(this._image),this.options.interactive&&this.removeInteractiveTarget(this._image)},setOpacity:function(t){return this.options.opacity=t,this._image&&this._updateOpacity(),this},setStyle:function(t){return t.opacity&&this.setOpacity(t.opacity),this},bringToFront:function(){return this._map&&ye(this._image),this},bringToBack:function(){return this._map&&Le(this._image),this},setUrl:function(t){return this._url=t,this._image&&(this._image.src=t),this},setBounds:function(t){return this._bounds=Lt(t),this._map&&this._reset(),this},getEvents:function(){var t={zoom:this._reset,viewreset:this._reset};return this._zoomAnimated&&(t.zoomanim=this._animateZoom),t},setZIndex:function(t){return this.options.zIndex=t,this._updateZIndex(),this},getBounds:function(){return this._bounds},getElement:function(){return this._image},_initImage:function(){var t=this._url.tagName==="IMG",e=this._image=t?this._url:it("img");if(V(e,"leaflet-image-layer"),this._zoomAnimated&&V(e,"leaflet-zoom-animated"),this.options.className&&V(e,this.options.className),e.onselectstart=O,e.onmousemove=O,e.onload=p(this.fire,this,"load"),e.onerror=p(this._overlayOnError,this,"error"),(this.options.crossOrigin||this.options.crossOrigin==="")&&(e.crossOrigin=this.options.crossOrigin===!0?"":this.options.crossOrigin),this.options.zIndex&&this._updateZIndex(),t){this._url=e.src;return}e.src=this._url,e.alt=this.options.alt},_animateZoom:function(t){var e=this._map.getZoomScale(t.zoom),o=this._map._latLngBoundsToNewLayerBounds(this._bounds,t.zoom,t.center).min;ne(this._image,o,e)},_reset:function(){var t=this._image,e=new C(this._map.latLngToLayerPoint(this._bounds.getNorthWest()),this._map.latLngToLayerPoint(this._bounds.getSouthEast())),o=e.getSize();gt(t,e.min),t.style.width=o.x+"px",t.style.height=o.y+"px"},_updateOpacity:function(){Tt(this._image,this.options.opacity)},_updateZIndex:function(){this._image&&this.options.zIndex!==void 0&&this.options.zIndex!==null&&(this._image.style.zIndex=this.options.zIndex)},_overlayOnError:function(){this.fire("error");var t=this.options.errorOverlayUrl;t&&this._url!==t&&(this._url=t,this._image.src=t)}}),wa=function(t,e,o){return new On(t,e,o)},So=On.extend({options:{autoplay:!0,loop:!0},_initImage:function(){var t=this._url.tagName==="VIDEO",e=this._image=t?this._url:it("video");if(V(e,"leaflet-image-layer"),this._zoomAnimated&&V(e,"leaflet-zoom-animated"),e.onselectstart=O,e.onmousemove=O,e.onloadeddata=p(this.fire,this,"load"),t){for(var o=e.getElementsByTagName("source"),l=[],u=0;u<o.length;u++)l.push(o[u].src);this._url=o.length>0?l:[e.src];return}k(this._url)||(this._url=[this._url]),e.autoplay=!!this.options.autoplay,e.loop=!!this.options.loop;for(var f=0;f<this._url.length;f++){var m=it("source");m.src=this._url[f],e.appendChild(m)}}});function Ea(t,e,o){return new So(t,e,o)}var Ft=kt.extend({options:{offset:[0,7],className:"",pane:"popupPane"},initialize:function(t,e){v(this,t),this._source=e},onAdd:function(t){this._zoomAnimated=t._zoomAnimated,this._container||this._initLayout(),t._fadeAnimated&&Tt(this._container,0),clearTimeout(this._removeTimeout),this.getPane().appendChild(this._container),this.update(),t._fadeAnimated&&Tt(this._container,1),this.bringToFront()},onRemove:function(t){t._fadeAnimated?(Tt(this._container,0),this._removeTimeout=setTimeout(p(ct,void 0,this._container),200)):ct(this._container)},getLatLng:function(){return this._latlng},setLatLng:function(t){return this._latlng=ft(t),this._map&&(this._updatePosition(),this._adjustPan()),this},getContent:function(){return this._content},setContent:function(t){return this._content=t,this.update(),this},getElement:function(){return this._container},update:function(){this._map&&(this._container.style.visibility="hidden",this._updateContent(),this._updateLayout(),this._updatePosition(),this._container.style.visibility="",this._adjustPan())},getEvents:function(){var t={zoom:this._updatePosition,viewreset:this._updatePosition};return this._zoomAnimated&&(t.zoomanim=this._animateZoom),t},isOpen:function(){return!!this._map&&this._map.hasLayer(this)},bringToFront:function(){return this._map&&ye(this._container),this},bringToBack:function(){return this._map&&Le(this._container),this},_updateContent:function(){if(this._content){var t=this._contentNode,e=typeof this._content=="function"?this._content(this._source||this):this._content;if(typeof e=="string")t.innerHTML=e;else{for(;t.hasChildNodes();)t.removeChild(t.firstChild);t.appendChild(e)}this.fire("contentupdate")}},_updatePosition:function(){if(this._map){var t=this._map.latLngToLayerPoint(this._latlng),e=J(this.options.offset),o=this._getAnchor();this._zoomAnimated?gt(this._container,t.add(o)):e=e.add(t).add(o);var l=this._containerBottom=-e.y,u=this._containerLeft=-Math.round(this._containerWidth/2)+e.x;this._container.style.bottom=l+"px",this._container.style.left=u+"px"}},_getAnchor:function(){return[0,0]}}),Pe=Ft.extend({options:{maxWidth:300,minWidth:50,maxHeight:null,autoPan:!0,autoPanPaddingTopLeft:null,autoPanPaddingBottomRight:null,autoPanPadding:[5,5],keepInView:!1,closeButton:!0,autoClose:!0,closeOnEscapeKey:!0,className:""},openOn:function(t){return t.openPopup(this),this},onAdd:function(t){Ft.prototype.onAdd.call(this,t),t.fire("popupopen",{popup:this}),this._source&&(this._source.fire("popupopen",{popup:this},!0),this._source instanceof Xt||this._source.on("preclick",oe))},onRemove:function(t){Ft.prototype.onRemove.call(this,t),t.fire("popupclose",{popup:this}),this._source&&(this._source.fire("popupclose",{popup:this},!0),this._source instanceof Xt||this._source.off("preclick",oe))},getEvents:function(){var t=Ft.prototype.getEvents.call(this);return(this.options.closeOnClick!==void 0?this.options.closeOnClick:this._map.options.closePopupOnClick)&&(t.preclick=this._close),this.options.keepInView&&(t.moveend=this._adjustPan),t},_close:function(){this._map&&this._map.closePopup(this)},_initLayout:function(){var t="leaflet-popup",e=this._container=it("div",t+" "+(this.options.className||"")+" leaflet-zoom-animated"),o=this._wrapper=it("div",t+"-content-wrapper",e);if(this._contentNode=it("div",t+"-content",o),Fe(o),un(this._contentNode),q(o,"contextmenu",oe),this._tipContainer=it("div",t+"-tip-container",e),this._tip=it("div",t+"-tip",this._tipContainer),this.options.closeButton){var l=this._closeButton=it("a",t+"-close-button",e);l.href="#close",l.innerHTML="&#215;",q(l,"click",this._onCloseButtonClick,this)}},_updateLayout:function(){var t=this._contentNode,e=t.style;e.width="",e.whiteSpace="nowrap";var o=t.offsetWidth;o=Math.min(o,this.options.maxWidth),o=Math.max(o,this.options.minWidth),e.width=o+1+"px",e.whiteSpace="",e.height="";var l=t.offsetHeight,u=this.options.maxHeight,f="leaflet-popup-scrolled";u&&l>u?(e.height=u+"px",V(t,f)):pt(t,f),this._containerWidth=this._container.offsetWidth},_animateZoom:function(t){var e=this._map._latLngToNewLayerPoint(this._latlng,t.zoom,t.center),o=this._getAnchor();gt(this._container,e.add(o))},_adjustPan:function(){if(!(!this.options.autoPan||this._map._panAnim&&this._map._panAnim._inProgress)){var t=this._map,e=parseInt(Be(this._container,"marginBottom"),10)||0,o=this._container.offsetHeight+e,l=this._containerWidth,u=new R(this._containerLeft,-o-this._containerBottom);u._add(Jt(this._container));var f=t.layerPointToContainerPoint(u),m=J(this.options.autoPanPadding),y=J(this.options.autoPanPaddingTopLeft||m),x=J(this.options.autoPanPaddingBottomRight||m),E=t.getSize(),N=0,U=0;f.x+l+x.x>E.x&&(N=f.x+l-E.x+x.x),f.x-N-y.x<0&&(N=f.x-y.x),f.y+o+x.y>E.y&&(U=f.y+o-E.y+x.y),f.y-U-y.y<0&&(U=f.y-y.y),(N||U)&&t.fire("autopanstart").panBy([N,U])}},_onCloseButtonClick:function(t){this._close(),zt(t)},_getAnchor:function(){return J(this._source&&this._source._getPopupAnchor?this._source._getPopupAnchor():[0,0])}}),Pa=function(t,e){return new Pe(t,e)};tt.mergeOptions({closePopupOnClick:!0}),tt.include({openPopup:function(t,e,o){return t instanceof Pe||(t=new Pe(o).setContent(t)),e&&t.setLatLng(e),this.hasLayer(t)?this:(this._popup&&this._popup.options.autoClose&&this.closePopup(),this._popup=t,this.addLayer(t))},closePopup:function(t){return(!t||t===this._popup)&&(t=this._popup,this._popup=null),t&&this.removeLayer(t),this}}),kt.include({bindPopup:function(t,e){return t instanceof Pe?(v(t,e),this._popup=t,t._source=this):((!this._popup||e)&&(this._popup=new Pe(e,this)),this._popup.setContent(t)),this._popupHandlersAdded||(this.on({click:this._openPopup,keypress:this._onKeyPress,remove:this.closePopup,move:this._movePopup}),this._popupHandlersAdded=!0),this},unbindPopup:function(){return this._popup&&(this.off({click:this._openPopup,keypress:this._onKeyPress,remove:this.closePopup,move:this._movePopup}),this._popupHandlersAdded=!1,this._popup=null),this},openPopup:function(t,e){if(t instanceof kt||(e=t,t=this),t instanceof se)for(var o in this._layers){t=this._layers[o];break}return e||(e=t.getCenter?t.getCenter():t.getLatLng()),this._popup&&this._map&&(this._popup._source=t,this._popup.update(),this._map.openPopup(this._popup,e)),this},closePopup:function(){return this._popup&&this._popup._close(),this},togglePopup:function(t){return this._popup&&(this._popup._map?this.closePopup():this.openPopup(t)),this},isPopupOpen:function(){return this._popup?this._popup.isOpen():!1},setPopupContent:function(t){return this._popup&&this._popup.setContent(t),this},getPopup:function(){return this._popup},_openPopup:function(t){var e=t.layer||t.target;if(this._popup&&this._map){if(zt(t),e instanceof Xt){this.openPopup(t.layer||t.target,t.latlng);return}this._map.hasLayer(this._popup)&&this._popup._source===e?this.closePopup():this.openPopup(e,t.latlng)}},_movePopup:function(t){this._popup.setLatLng(t.latlng)},_onKeyPress:function(t){t.originalEvent.keyCode===13&&this._openPopup(t)}});var Te=Ft.extend({options:{pane:"tooltipPane",offset:[0,0],direction:"auto",permanent:!1,sticky:!1,interactive:!1,opacity:.9},onAdd:function(t){Ft.prototype.onAdd.call(this,t),this.setOpacity(this.options.opacity),t.fire("tooltipopen",{tooltip:this}),this._source&&this._source.fire("tooltipopen",{tooltip:this},!0)},onRemove:function(t){Ft.prototype.onRemove.call(this,t),t.fire("tooltipclose",{tooltip:this}),this._source&&this._source.fire("tooltipclose",{tooltip:this},!0)},getEvents:function(){var t=Ft.prototype.getEvents.call(this);return Dt&&!this.options.permanent&&(t.preclick=this._close),t},_close:function(){this._map&&this._map.closeTooltip(this)},_initLayout:function(){var t="leaflet-tooltip",e=t+" "+(this.options.className||"")+" leaflet-zoom-"+(this._zoomAnimated?"animated":"hide");this._contentNode=this._container=it("div",e)},_updateLayout:function(){},_adjustPan:function(){},_setPosition:function(t){var e=this._map,o=this._container,l=e.latLngToContainerPoint(e.getCenter()),u=e.layerPointToContainerPoint(t),f=this.options.direction,m=o.offsetWidth,y=o.offsetHeight,x=J(this.options.offset),E=this._getAnchor();f==="top"?t=t.add(J(-m/2+x.x,-y+x.y+E.y,!0)):f==="bottom"?t=t.subtract(J(m/2-x.x,-x.y,!0)):f==="center"?t=t.subtract(J(m/2+x.x,y/2-E.y+x.y,!0)):f==="right"||f==="auto"&&u.x<l.x?(f="right",t=t.add(J(x.x+E.x,E.y-y/2+x.y,!0))):(f="left",t=t.subtract(J(m+E.x-x.x,y/2-E.y-x.y,!0))),pt(o,"leaflet-tooltip-right"),pt(o,"leaflet-tooltip-left"),pt(o,"leaflet-tooltip-top"),pt(o,"leaflet-tooltip-bottom"),V(o,"leaflet-tooltip-"+f),gt(o,t)},_updatePosition:function(){var t=this._map.latLngToLayerPoint(this._latlng);this._setPosition(t)},setOpacity:function(t){this.options.opacity=t,this._container&&Tt(this._container,t)},_animateZoom:function(t){var e=this._map._latLngToNewLayerPoint(this._latlng,t.zoom,t.center);this._setPosition(e)},_getAnchor:function(){return J(this._source&&this._source._getTooltipAnchor&&!this.options.sticky?this._source._getTooltipAnchor():[0,0])}}),Ta=function(t,e){return new Te(t,e)};tt.include({openTooltip:function(t,e,o){return t instanceof Te||(t=new Te(o).setContent(t)),e&&t.setLatLng(e),this.hasLayer(t)?this:this.addLayer(t)},closeTooltip:function(t){return t&&this.removeLayer(t),this}}),kt.include({bindTooltip:function(t,e){return t instanceof Te?(v(t,e),this._tooltip=t,t._source=this):((!this._tooltip||e)&&(this._tooltip=new Te(e,this)),this._tooltip.setContent(t)),this._initTooltipInteractions(),this._tooltip.options.permanent&&this._map&&this._map.hasLayer(this)&&this.openTooltip(),this},unbindTooltip:function(){return this._tooltip&&(this._initTooltipInteractions(!0),this.closeTooltip(),this._tooltip=null),this},_initTooltipInteractions:function(t){if(!(!t&&this._tooltipHandlersAdded)){var e=t?"off":"on",o={remove:this.closeTooltip,move:this._moveTooltip};this._tooltip.options.permanent?o.add=this._openTooltip:(o.mouseover=this._openTooltip,o.mouseout=this.closeTooltip,this._tooltip.options.sticky&&(o.mousemove=this._moveTooltip),Dt&&(o.click=this._openTooltip)),this[e](o),this._tooltipHandlersAdded=!t}},openTooltip:function(t,e){if(t instanceof kt||(e=t,t=this),t instanceof se)for(var o in this._layers){t=this._layers[o];break}return e||(e=t.getCenter?t.getCenter():t.getLatLng()),this._tooltip&&this._map&&(this._tooltip._source=t,this._tooltip.update(),this._map.openTooltip(this._tooltip,e),this._tooltip.options.interactive&&this._tooltip._container&&(V(this._tooltip._container,"leaflet-clickable"),this.addInteractiveTarget(this._tooltip._container))),this},closeTooltip:function(){return this._tooltip&&(this._tooltip._close(),this._tooltip.options.interactive&&this._tooltip._container&&(pt(this._tooltip._container,"leaflet-clickable"),this.removeInteractiveTarget(this._tooltip._container))),this},toggleTooltip:function(t){return this._tooltip&&(this._tooltip._map?this.closeTooltip():this.openTooltip(t)),this},isTooltipOpen:function(){return this._tooltip.isOpen()},setTooltipContent:function(t){return this._tooltip&&this._tooltip.setContent(t),this},getTooltip:function(){return this._tooltip},_openTooltip:function(t){var e=t.layer||t.target;!this._tooltip||!this._map||this.openTooltip(e,this._tooltip.options.sticky?t.latlng:void 0)},_moveTooltip:function(t){var e=t.latlng,o,l;this._tooltip.options.sticky&&t.originalEvent&&(o=this._map.mouseEventToContainerPoint(t.originalEvent),l=this._map.containerPointToLayerPoint(o),e=this._map.layerPointToLatLng(l)),this._tooltip.setLatLng(e)}});var Co=be.extend({options:{iconSize:[12,12],html:!1,bgPos:null,className:"leaflet-div-icon"},createIcon:function(t){var e=t&&t.tagName==="DIV"?t:document.createElement("div"),o=this.options;if(e.innerHTML=o.html!==!1?o.html:"",o.bgPos){var l=J(o.bgPos);e.style.backgroundPosition=-l.x+"px "+-l.y+"px"}return this._setIconStyles(e,"icon"),e},createShadow:function(){return null}});function Oa(t){return new Co(t)}be.Default=We;var qe=kt.extend({options:{tileSize:256,opacity:1,updateWhenIdle:_e,updateWhenZooming:!0,updateInterval:200,zIndex:1,bounds:null,minZoom:0,maxZoom:void 0,maxNativeZoom:void 0,minNativeZoom:void 0,noWrap:!1,pane:"tilePane",className:"",keepBuffer:2},initialize:function(t){v(this,t)},onAdd:function(){this._initContainer(),this._levels={},this._tiles={},this._resetView(),this._update()},beforeAdd:function(t){t._addZoomLimit(this)},onRemove:function(t){this._removeAllTiles(),ct(this._container),t._removeZoomLimit(this),this._container=null,this._tileZoom=void 0},bringToFront:function(){return this._map&&(ye(this._container),this._setAutoZIndex(Math.max)),this},bringToBack:function(){return this._map&&(Le(this._container),this._setAutoZIndex(Math.min)),this},getContainer:function(){return this._container},setOpacity:function(t){return this.options.opacity=t,this._updateOpacity(),this},setZIndex:function(t){return this.options.zIndex=t,this._updateZIndex(),this},isLoading:function(){return this._loading},redraw:function(){return this._map&&(this._removeAllTiles(),this._update()),this},getEvents:function(){var t={viewprereset:this._invalidateAll,viewreset:this._resetView,zoom:this._resetView,moveend:this._onMoveEnd};return this.options.updateWhenIdle||(this._onMove||(this._onMove=b(this._onMoveEnd,this.options.updateInterval,this)),t.move=this._onMove),this._zoomAnimated&&(t.zoomanim=this._animateZoom),t},createTile:function(){return document.createElement("div")},getTileSize:function(){var t=this.options.tileSize;return t instanceof R?t:new R(t,t)},_updateZIndex:function(){this._container&&this.options.zIndex!==void 0&&this.options.zIndex!==null&&(this._container.style.zIndex=this.options.zIndex)},_setAutoZIndex:function(t){for(var e=this.getPane().children,o=-t(-1/0,1/0),l=0,u=e.length,f;l<u;l++)f=e[l].style.zIndex,e[l]!==this._container&&f&&(o=t(o,+f));isFinite(o)&&(this.options.zIndex=o+t(-1,1),this._updateZIndex())},_updateOpacity:function(){if(this._map&&!pe){Tt(this._container,this.options.opacity);var t=+new Date,e=!1,o=!1;for(var l in this._tiles){var u=this._tiles[l];if(!(!u.current||!u.loaded)){var f=Math.min(1,(t-u.loaded)/200);Tt(u.el,f),f<1?e=!0:(u.active?o=!0:this._onOpaqueTile(u),u.active=!0)}}o&&!this._noPrune&&this._pruneTiles(),e&&($(this._fadeFrame),this._fadeFrame=B(this._updateOpacity,this))}},_onOpaqueTile:O,_initContainer:function(){this._container||(this._container=it("div","leaflet-layer "+(this.options.className||"")),this._updateZIndex(),this.options.opacity<1&&this._updateOpacity(),this.getPane().appendChild(this._container))},_updateLevels:function(){var t=this._tileZoom,e=this.options.maxZoom;if(t!==void 0){for(var o in this._levels)this._levels[o].el.children.length||o===t?(this._levels[o].el.style.zIndex=e-Math.abs(t-o),this._onUpdateLevel(o)):(ct(this._levels[o].el),this._removeTilesAtZoom(o),this._onRemoveLevel(o),delete this._levels[o]);var l=this._levels[t],u=this._map;return l||(l=this._levels[t]={},l.el=it("div","leaflet-tile-container leaflet-zoom-animated",this._container),l.el.style.zIndex=e,l.origin=u.project(u.unproject(u.getPixelOrigin()),t).round(),l.zoom=t,this._setZoomTransform(l,u.getCenter(),u.getZoom()),O(l.el.offsetWidth),this._onCreateLevel(l)),this._level=l,l}},_onUpdateLevel:O,_onRemoveLevel:O,_onCreateLevel:O,_pruneTiles:function(){if(this._map){var t,e,o=this._map.getZoom();if(o>this.options.maxZoom||o<this.options.minZoom){this._removeAllTiles();return}for(t in this._tiles)e=this._tiles[t],e.retain=e.current;for(t in this._tiles)if(e=this._tiles[t],e.current&&!e.active){var l=e.coords;this._retainParent(l.x,l.y,l.z,l.z-5)||this._retainChildren(l.x,l.y,l.z,l.z+2)}for(t in this._tiles)this._tiles[t].retain||this._removeTile(t)}},_removeTilesAtZoom:function(t){for(var e in this._tiles)this._tiles[e].coords.z===t&&this._removeTile(e)},_removeAllTiles:function(){for(var t in this._tiles)this._removeTile(t)},_invalidateAll:function(){for(var t in this._levels)ct(this._levels[t].el),this._onRemoveLevel(t),delete this._levels[t];this._removeAllTiles(),this._tileZoom=void 0},_retainParent:function(t,e,o,l){var u=Math.floor(t/2),f=Math.floor(e/2),m=o-1,y=new R(+u,+f);y.z=+m;var x=this._tileCoordsToKey(y),E=this._tiles[x];return E&&E.active?(E.retain=!0,!0):(E&&E.loaded&&(E.retain=!0),m>l?this._retainParent(u,f,m,l):!1)},_retainChildren:function(t,e,o,l){for(var u=2*t;u<2*t+2;u++)for(var f=2*e;f<2*e+2;f++){var m=new R(u,f);m.z=o+1;var y=this._tileCoordsToKey(m),x=this._tiles[y];if(x&&x.active){x.retain=!0;continue}else x&&x.loaded&&(x.retain=!0);o+1<l&&this._retainChildren(u,f,o+1,l)}},_resetView:function(t){var e=t&&(t.pinch||t.flyTo);this._setView(this._map.getCenter(),this._map.getZoom(),e,e)},_animateZoom:function(t){this._setView(t.center,t.zoom,!0,t.noUpdate)},_clampZoom:function(t){var e=this.options;return e.minNativeZoom!==void 0&&t<e.minNativeZoom?e.minNativeZoom:e.maxNativeZoom!==void 0&&e.maxNativeZoom<t?e.maxNativeZoom:t},_setView:function(t,e,o,l){var u=this._clampZoom(Math.round(e));(this.options.maxZoom!==void 0&&u>this.options.maxZoom||this.options.minZoom!==void 0&&u<this.options.minZoom)&&(u=void 0);var f=this.options.updateWhenZooming&&u!==this._tileZoom;(!l||f)&&(this._tileZoom=u,this._abortLoading&&this._abortLoading(),this._updateLevels(),this._resetGrid(),u!==void 0&&this._update(t),o||this._pruneTiles(),this._noPrune=!!o),this._setZoomTransforms(t,e)},_setZoomTransforms:function(t,e){for(var o in this._levels)this._setZoomTransform(this._levels[o],t,e)},_setZoomTransform:function(t,e,o){var l=this._map.getZoomScale(o,t.zoom),u=t.origin.multiplyBy(l).subtract(this._map._getNewPixelOrigin(e,o)).round();Pt?ne(t.el,u,l):gt(t.el,u)},_resetGrid:function(){var t=this._map,e=t.options.crs,o=this._tileSize=this.getTileSize(),l=this._tileZoom,u=this._map.getPixelWorldBounds(this._tileZoom);u&&(this._globalTileRange=this._pxBoundsToTileRange(u)),this._wrapX=e.wrapLng&&!this.options.noWrap&&[Math.floor(t.project([0,e.wrapLng[0]],l).x/o.x),Math.ceil(t.project([0,e.wrapLng[1]],l).x/o.y)],this._wrapY=e.wrapLat&&!this.options.noWrap&&[Math.floor(t.project([e.wrapLat[0],0],l).y/o.x),Math.ceil(t.project([e.wrapLat[1],0],l).y/o.y)]},_onMoveEnd:function(){!this._map||this._map._animatingZoom||this._update()},_getTiledPixelBounds:function(t){var e=this._map,o=e._animatingZoom?Math.max(e._animateToZoom,e.getZoom()):e.getZoom(),l=e.getZoomScale(o,this._tileZoom),u=e.project(t,this._tileZoom).floor(),f=e.getSize().divideBy(l*2);return new C(u.subtract(f),u.add(f))},_update:function(t){var e=this._map;if(e){var o=this._clampZoom(e.getZoom());if(t===void 0&&(t=e.getCenter()),this._tileZoom!==void 0){var l=this._getTiledPixelBounds(t),u=this._pxBoundsToTileRange(l),f=u.getCenter(),m=[],y=this.options.keepBuffer,x=new C(u.getBottomLeft().subtract([y,-y]),u.getTopRight().add([y,-y]));if(!(isFinite(u.min.x)&&isFinite(u.min.y)&&isFinite(u.max.x)&&isFinite(u.max.y)))throw new Error("Attempted to load an infinite number of tiles");for(var E in this._tiles){var N=this._tiles[E].coords;(N.z!==this._tileZoom||!x.contains(new R(N.x,N.y)))&&(this._tiles[E].current=!1)}if(Math.abs(o-this._tileZoom)>1){this._setView(t,o);return}for(var U=u.min.y;U<=u.max.y;U++)for(var Q=u.min.x;Q<=u.max.x;Q++){var Ht=new R(Q,U);if(Ht.z=this._tileZoom,!!this._isValidTile(Ht)){var le=this._tiles[this._tileCoordsToKey(Ht)];le?le.current=!0:m.push(Ht)}}if(m.sort(function(Qt,kn){return Qt.distanceTo(f)-kn.distanceTo(f)}),m.length!==0){this._loading||(this._loading=!0,this.fire("loading"));var Li=document.createDocumentFragment();for(Q=0;Q<m.length;Q++)this._addTile(m[Q],Li);this._level.el.appendChild(Li)}}}},_isValidTile:function(t){var e=this._map.options.crs;if(!e.infinite){var o=this._globalTileRange;if(!e.wrapLng&&(t.x<o.min.x||t.x>o.max.x)||!e.wrapLat&&(t.y<o.min.y||t.y>o.max.y))return!1}if(!this.options.bounds)return!0;var l=this._tileCoordsToBounds(t);return Lt(this.options.bounds).overlaps(l)},_keyToBounds:function(t){return this._tileCoordsToBounds(this._keyToTileCoords(t))},_tileCoordsToNwSe:function(t){var e=this._map,o=this.getTileSize(),l=t.scaleBy(o),u=l.add(o),f=e.unproject(l,t.z),m=e.unproject(u,t.z);return[f,m]},_tileCoordsToBounds:function(t){var e=this._tileCoordsToNwSe(t),o=new Et(e[0],e[1]);return this.options.noWrap||(o=this._map.wrapLatLngBounds(o)),o},_tileCoordsToKey:function(t){return t.x+":"+t.y+":"+t.z},_keyToTileCoords:function(t){var e=t.split(":"),o=new R(+e[0],+e[1]);return o.z=+e[2],o},_removeTile:function(t){var e=this._tiles[t];e&&(ct(e.el),delete this._tiles[t],this.fire("tileunload",{tile:e.el,coords:this._keyToTileCoords(t)}))},_initTile:function(t){V(t,"leaflet-tile");var e=this.getTileSize();t.style.width=e.x+"px",t.style.height=e.y+"px",t.onselectstart=O,t.onmousemove=O,pe&&this.options.opacity<1&&Tt(t,this.options.opacity),me&&!Ie&&(t.style.WebkitBackfaceVisibility="hidden")},_addTile:function(t,e){var o=this._getTilePos(t),l=this._tileCoordsToKey(t),u=this.createTile(this._wrapCoords(t),p(this._tileReady,this,t));this._initTile(u),this.createTile.length<2&&B(p(this._tileReady,this,t,null,u)),gt(u,o),this._tiles[l]={el:u,coords:t,current:!0},e.appendChild(u),this.fire("tileloadstart",{tile:u,coords:t})},_tileReady:function(t,e,o){e&&this.fire("tileerror",{error:e,tile:o,coords:t});var l=this._tileCoordsToKey(t);o=this._tiles[l],o&&(o.loaded=+new Date,this._map._fadeAnimated?(Tt(o.el,0),$(this._fadeFrame),this._fadeFrame=B(this._updateOpacity,this)):(o.active=!0,this._pruneTiles()),e||(V(o.el,"leaflet-tile-loaded"),this.fire("tileload",{tile:o.el,coords:t})),this._noTilesToLoad()&&(this._loading=!1,this.fire("load"),pe||!this._map._fadeAnimated?B(this._pruneTiles,this):setTimeout(p(this._pruneTiles,this),250)))},_getTilePos:function(t){return t.scaleBy(this.getTileSize()).subtract(this._level.origin)},_wrapCoords:function(t){var e=new R(this._wrapX?T(t.x,this._wrapX):t.x,this._wrapY?T(t.y,this._wrapY):t.y);return e.z=t.z,e},_pxBoundsToTileRange:function(t){var e=this.getTileSize();return new C(t.min.unscaleBy(e).floor(),t.max.unscaleBy(e).ceil().subtract([1,1]))},_noTilesToLoad:function(){for(var t in this._tiles)if(!this._tiles[t].loaded)return!1;return!0}});function ka(t){return new qe(t)}var Oe=qe.extend({options:{minZoom:0,maxZoom:18,subdomains:"abc",errorTileUrl:"",zoomOffset:0,tms:!1,zoomReverse:!1,detectRetina:!1,crossOrigin:!1},initialize:function(t,e){this._url=t,e=v(this,e),e.detectRetina&&Kt&&e.maxZoom>0&&(e.tileSize=Math.floor(e.tileSize/2),e.zoomReverse?(e.zoomOffset--,e.minZoom++):(e.zoomOffset++,e.maxZoom--),e.minZoom=Math.max(0,e.minZoom)),typeof e.subdomains=="string"&&(e.subdomains=e.subdomains.split("")),me||this.on("tileunload",this._onTileRemove)},setUrl:function(t,e){return this._url=t,e||this.redraw(),this},createTile:function(t,e){var o=document.createElement("img");return q(o,"load",p(this._tileOnLoad,this,e,o)),q(o,"error",p(this._tileOnError,this,e,o)),(this.options.crossOrigin||this.options.crossOrigin==="")&&(o.crossOrigin=this.options.crossOrigin===!0?"":this.options.crossOrigin),o.alt="",o.setAttribute("role","presentation"),o.src=this.getTileUrl(t),o},getTileUrl:function(t){var e={r:Kt?"@2x":"",s:this._getSubdomain(t),x:t.x,y:t.y,z:this._getZoomForUrl()};if(this._map&&!this._map.options.crs.infinite){var o=this._globalTileRange.max.y-t.y;this.options.tms&&(e.y=o),e["-y"]=o}return z(this._url,r(e,this.options))},_tileOnLoad:function(t,e){pe?setTimeout(p(t,this,null,e),0):t(null,e)},_tileOnError:function(t,e,o){var l=this.options.errorTileUrl;l&&e.getAttribute("src")!==l&&(e.src=l),t(o,e)},_onTileRemove:function(t){t.tile.onload=null},_getZoomForUrl:function(){var t=this._tileZoom,e=this.options.maxZoom,o=this.options.zoomReverse,l=this.options.zoomOffset;return o&&(t=e-t),t+l},_getSubdomain:function(t){var e=Math.abs(t.x+t.y)%this.options.subdomains.length;return this.options.subdomains[e]},_abortLoading:function(){var t,e;for(t in this._tiles)this._tiles[t].coords.z!==this._tileZoom&&(e=this._tiles[t].el,e.onload=O,e.onerror=O,e.complete||(e.src=P,ct(e),delete this._tiles[t]))},_removeTile:function(t){var e=this._tiles[t];if(e)return Qn||e.el.setAttribute("src",P),qe.prototype._removeTile.call(this,t)},_tileReady:function(t,e,o){if(!(!this._map||o&&o.getAttribute("src")===P))return qe.prototype._tileReady.call(this,t,e,o)}});function Do(t,e){return new Oe(t,e)}var No=Oe.extend({defaultWmsParams:{service:"WMS",request:"GetMap",layers:"",styles:"",format:"image/jpeg",transparent:!1,version:"1.1.1"},options:{crs:null,uppercase:!1},initialize:function(t,e){this._url=t;var o=r({},this.defaultWmsParams);for(var l in e)l in this.options||(o[l]=e[l]);e=v(this,e);var u=e.detectRetina&&Kt?2:1,f=this.getTileSize();o.width=f.x*u,o.height=f.y*u,this.wmsParams=o},onAdd:function(t){this._crs=this.options.crs||t.options.crs,this._wmsVersion=parseFloat(this.wmsParams.version);var e=this._wmsVersion>=1.3?"crs":"srs";this.wmsParams[e]=this._crs.code,Oe.prototype.onAdd.call(this,t)},getTileUrl:function(t){var e=this._tileCoordsToNwSe(t),o=this._crs,l=ot(o.project(e[0]),o.project(e[1])),u=l.min,f=l.max,m=(this._wmsVersion>=1.3&&this._crs===ko?[u.y,u.x,f.y,f.x]:[u.x,u.y,f.x,f.y]).join(","),y=Oe.prototype.getTileUrl.call(this,t);return y+Z(this.wmsParams,y,this.options.uppercase)+(this.options.uppercase?"&BBOX=":"&bbox=")+m},setParams:function(t,e){return r(this.wmsParams,t),e||this.redraw(),this}});function Ma(t,e){return new No(t,e)}Oe.WMS=No,Do.wms=Ma;var Rt=kt.extend({options:{padding:.1,tolerance:0},initialize:function(t){v(this,t),g(this),this._layers=this._layers||{}},onAdd:function(){this._container||(this._initContainer(),this._zoomAnimated&&V(this._container,"leaflet-zoom-animated")),this.getPane().appendChild(this._container),this._update(),this.on("update",this._updatePaths,this)},onRemove:function(){this.off("update",this._updatePaths,this),this._destroyContainer()},getEvents:function(){var t={viewreset:this._reset,zoom:this._onZoom,moveend:this._update,zoomend:this._onZoomEnd};return this._zoomAnimated&&(t.zoomanim=this._onAnimZoom),t},_onAnimZoom:function(t){this._updateTransform(t.center,t.zoom)},_onZoom:function(){this._updateTransform(this._map.getCenter(),this._map.getZoom())},_updateTransform:function(t,e){var o=this._map.getZoomScale(e,this._zoom),l=Jt(this._container),u=this._map.getSize().multiplyBy(.5+this.options.padding),f=this._map.project(this._center,e),m=this._map.project(t,e),y=m.subtract(f),x=u.multiplyBy(-o).add(l).add(u).subtract(y);Pt?ne(this._container,x,o):gt(this._container,x)},_reset:function(){this._update(),this._updateTransform(this._center,this._zoom);for(var t in this._layers)this._layers[t]._reset()},_onZoomEnd:function(){for(var t in this._layers)this._layers[t]._project()},_updatePaths:function(){for(var t in this._layers)this._layers[t]._update()},_update:function(){var t=this.options.padding,e=this._map.getSize(),o=this._map.containerPointToLayerPoint(e.multiplyBy(-t)).round();this._bounds=new C(o,o.add(e.multiplyBy(1+t*2)).round()),this._center=this._map.getCenter(),this._zoom=this._map.getZoom()}}),zo=Rt.extend({getEvents:function(){var t=Rt.prototype.getEvents.call(this);return t.viewprereset=this._onViewPreReset,t},_onViewPreReset:function(){this._postponeUpdatePaths=!0},onAdd:function(){Rt.prototype.onAdd.call(this),this._draw()},_initContainer:function(){var t=this._container=document.createElement("canvas");q(t,"mousemove",b(this._onMouseMove,32,this),this),q(t,"click dblclick mousedown mouseup contextmenu",this._onClick,this),q(t,"mouseout",this._handleMouseOut,this),this._ctx=t.getContext("2d")},_destroyContainer:function(){$(this._redrawRequest),delete this._ctx,ct(this._container),_t(this._container),delete this._container},_updatePaths:function(){if(!this._postponeUpdatePaths){var t;this._redrawBounds=null;for(var e in this._layers)t=this._layers[e],t._update();this._redraw()}},_update:function(){if(!(this._map._animatingZoom&&this._bounds)){this._drawnLayers={},Rt.prototype._update.call(this);var t=this._bounds,e=this._container,o=t.getSize(),l=Kt?2:1;gt(e,t.min),e.width=l*o.x,e.height=l*o.y,e.style.width=o.x+"px",e.style.height=o.y+"px",Kt&&this._ctx.scale(2,2),this._ctx.translate(-t.min.x,-t.min.y),this.fire("update")}},_reset:function(){Rt.prototype._reset.call(this),this._postponeUpdatePaths&&(this._postponeUpdatePaths=!1,this._updatePaths())},_initPath:function(t){this._updateDashArray(t),this._layers[g(t)]=t;var e=t._order={layer:t,prev:this._drawLast,next:null};this._drawLast&&(this._drawLast.next=e),this._drawLast=e,this._drawFirst=this._drawFirst||this._drawLast},_addPath:function(t){this._requestRedraw(t)},_removePath:function(t){var e=t._order,o=e.next,l=e.prev;o?o.prev=l:this._drawLast=l,l?l.next=o:this._drawFirst=o,delete this._drawnLayers[t._leaflet_id],delete t._order,delete this._layers[g(t)],this._requestRedraw(t)},_updatePath:function(t){this._extendRedrawBounds(t),t._project(),t._update(),this._requestRedraw(t)},_updateStyle:function(t){this._updateDashArray(t),this._requestRedraw(t)},_updateDashArray:function(t){if(typeof t.options.dashArray=="string"){var e=t.options.dashArray.split(/[, ]+/),o=[],l;for(l=0;l<e.length;l++)o.push(Number(e[l]));t.options._dashArray=o}else t.options._dashArray=t.options.dashArray},_requestRedraw:function(t){this._map&&(this._extendRedrawBounds(t),this._redrawRequest=this._redrawRequest||B(this._redraw,this))},_extendRedrawBounds:function(t){if(t._pxBounds){var e=(t.options.weight||0)+1;this._redrawBounds=this._redrawBounds||new C,this._redrawBounds.extend(t._pxBounds.min.subtract([e,e])),this._redrawBounds.extend(t._pxBounds.max.add([e,e]))}},_redraw:function(){this._redrawRequest=null,this._redrawBounds&&(this._redrawBounds.min._floor(),this._redrawBounds.max._ceil()),this._clear(),this._draw(),this._redrawBounds=null},_clear:function(){var t=this._redrawBounds;if(t){var e=t.getSize();this._ctx.clearRect(t.min.x,t.min.y,e.x,e.y)}else this._ctx.clearRect(0,0,this._container.width,this._container.height)},_draw:function(){var t,e=this._redrawBounds;if(this._ctx.save(),e){var o=e.getSize();this._ctx.beginPath(),this._ctx.rect(e.min.x,e.min.y,o.x,o.y),this._ctx.clip()}this._drawing=!0;for(var l=this._drawFirst;l;l=l.next)t=l.layer,(!e||t._pxBounds&&t._pxBounds.intersects(e))&&t._updatePath();this._drawing=!1,this._ctx.restore()},_updatePoly:function(t,e){if(this._drawing){var o,l,u,f,m=t._parts,y=m.length,x=this._ctx;if(y){for(this._drawnLayers[t._leaflet_id]=t,x.beginPath(),o=0;o<y;o++){for(l=0,u=m[o].length;l<u;l++)f=m[o][l],x[l?"lineTo":"moveTo"](f.x,f.y);e&&x.closePath()}this._fillStroke(x,t)}}},_updateCircle:function(t){if(!(!this._drawing||t._empty())){var e=t._point,o=this._ctx,l=Math.max(Math.round(t._radius),1),u=(Math.max(Math.round(t._radiusY),1)||l)/l;this._drawnLayers[t._leaflet_id]=t,u!==1&&(o.save(),o.scale(1,u)),o.beginPath(),o.arc(e.x,e.y/u,l,0,Math.PI*2,!1),u!==1&&o.restore(),this._fillStroke(o,t)}},_fillStroke:function(t,e){var o=e.options;o.fill&&(t.globalAlpha=o.fillOpacity,t.fillStyle=o.fillColor||o.color,t.fill(o.fillRule||"evenodd")),o.stroke&&o.weight!==0&&(t.setLineDash&&t.setLineDash(e.options&&e.options._dashArray||[]),t.globalAlpha=o.opacity,t.lineWidth=o.weight,t.strokeStyle=o.color,t.lineCap=o.lineCap,t.lineJoin=o.lineJoin,t.stroke())},_onClick:function(t){for(var e=this._map.mouseEventToLayerPoint(t),o,l,u=this._drawFirst;u;u=u.next)o=u.layer,o.options.interactive&&o._containsPoint(e)&&!this._map._draggableMoved(o)&&(l=o);l&&(fn(t),this._fireEvent([l],t))},_onMouseMove:function(t){if(!(!this._map||this._map.dragging.moving()||this._map._animatingZoom)){var e=this._map.mouseEventToLayerPoint(t);this._handleMouseHover(t,e)}},_handleMouseOut:function(t){var e=this._hoveredLayer;e&&(pt(this._container,"leaflet-interactive"),this._fireEvent([e],t,"mouseout"),this._hoveredLayer=null)},_handleMouseHover:function(t,e){for(var o,l,u=this._drawFirst;u;u=u.next)o=u.layer,o.options.interactive&&o._containsPoint(e)&&(l=o);l!==this._hoveredLayer&&(this._handleMouseOut(t),l&&(V(this._container,"leaflet-interactive"),this._fireEvent([l],t,"mouseover"),this._hoveredLayer=l)),this._hoveredLayer&&this._fireEvent([this._hoveredLayer],t)},_fireEvent:function(t,e,o){this._map._fireDOMEvent(e,o||e.type,t)},_bringToFront:function(t){var e=t._order,o=e.next,l=e.prev;if(o)o.prev=l;else return;l?l.next=o:o&&(this._drawFirst=o),e.prev=this._drawLast,this._drawLast.next=e,e.next=null,this._drawLast=e,this._requestRedraw(t)},_bringToBack:function(t){var e=t._order,o=e.next,l=e.prev;if(l)l.next=o;else return;o?o.prev=l:l&&(this._drawLast=l),e.prev=null,e.next=this._drawFirst,this._drawFirst.prev=e,this._drawFirst=e,this._requestRedraw(t)}});function Io(t){return ao?new zo(t):null}var Ye=function(){try{return document.namespaces.add("lvml","urn:schemas-microsoft-com:vml"),function(t){return document.createElement("<lvml:"+t+' class="lvml">')}}catch{return function(e){return document.createElement("<"+e+' xmlns="urn:schemas-microsoft.com:vml" class="lvml">')}}}(),ja={_initContainer:function(){this._container=it("div","leaflet-vml-container")},_update:function(){this._map._animatingZoom||(Rt.prototype._update.call(this),this.fire("update"))},_initPath:function(t){var e=t._container=Ye("shape");V(e,"leaflet-vml-shape "+(this.options.className||"")),e.coordsize="1 1",t._path=Ye("path"),e.appendChild(t._path),this._updateStyle(t),this._layers[g(t)]=t},_addPath:function(t){var e=t._container;this._container.appendChild(e),t.options.interactive&&t.addInteractiveTarget(e)},_removePath:function(t){var e=t._container;ct(e),t.removeInteractiveTarget(e),delete this._layers[g(t)]},_updateStyle:function(t){var e=t._stroke,o=t._fill,l=t.options,u=t._container;u.stroked=!!l.stroke,u.filled=!!l.fill,l.stroke?(e||(e=t._stroke=Ye("stroke")),u.appendChild(e),e.weight=l.weight+"px",e.color=l.color,e.opacity=l.opacity,l.dashArray?e.dashStyle=k(l.dashArray)?l.dashArray.join(" "):l.dashArray.replace(/( *, *)/g," "):e.dashStyle="",e.endcap=l.lineCap.replace("butt","flat"),e.joinstyle=l.lineJoin):e&&(u.removeChild(e),t._stroke=null),l.fill?(o||(o=t._fill=Ye("fill")),u.appendChild(o),o.color=l.fillColor||l.color,o.opacity=l.fillOpacity):o&&(u.removeChild(o),t._fill=null)},_updateCircle:function(t){var e=t._point.round(),o=Math.round(t._radius),l=Math.round(t._radiusY||o);this._setPath(t,t._empty()?"M0 0":"AL "+e.x+","+e.y+" "+o+","+l+" 0,"+65535*360)},_setPath:function(t,e){t._path.v=e},_bringToFront:function(t){ye(t._container)},_bringToBack:function(t){Le(t._container)}},yi=ri?Ye:Jn,Ke=Rt.extend({getEvents:function(){var t=Rt.prototype.getEvents.call(this);return t.zoomstart=this._onZoomStart,t},_initContainer:function(){this._container=yi("svg"),this._container.setAttribute("pointer-events","none"),this._rootGroup=yi("g"),this._container.appendChild(this._rootGroup)},_destroyContainer:function(){ct(this._container),_t(this._container),delete this._container,delete this._rootGroup,delete this._svgSize},_onZoomStart:function(){this._update()},_update:function(){if(!(this._map._animatingZoom&&this._bounds)){Rt.prototype._update.call(this);var t=this._bounds,e=t.getSize(),o=this._container;(!this._svgSize||!this._svgSize.equals(e))&&(this._svgSize=e,o.setAttribute("width",e.x),o.setAttribute("height",e.y)),gt(o,t.min),o.setAttribute("viewBox",[t.min.x,t.min.y,e.x,e.y].join(" ")),this.fire("update")}},_initPath:function(t){var e=t._path=yi("path");t.options.className&&V(e,t.options.className),t.options.interactive&&V(e,"leaflet-interactive"),this._updateStyle(t),this._layers[g(t)]=t},_addPath:function(t){this._rootGroup||this._initContainer(),this._rootGroup.appendChild(t._path),t.addInteractiveTarget(t._path)},_removePath:function(t){ct(t._path),t.removeInteractiveTarget(t._path),delete this._layers[g(t)]},_updatePath:function(t){t._project(),t._update()},_updateStyle:function(t){var e=t._path,o=t.options;e&&(o.stroke?(e.setAttribute("stroke",o.color),e.setAttribute("stroke-opacity",o.opacity),e.setAttribute("stroke-width",o.weight),e.setAttribute("stroke-linecap",o.lineCap),e.setAttribute("stroke-linejoin",o.lineJoin),o.dashArray?e.setAttribute("stroke-dasharray",o.dashArray):e.removeAttribute("stroke-dasharray"),o.dashOffset?e.setAttribute("stroke-dashoffset",o.dashOffset):e.removeAttribute("stroke-dashoffset")):e.setAttribute("stroke","none"),o.fill?(e.setAttribute("fill",o.fillColor||o.color),e.setAttribute("fill-opacity",o.fillOpacity),e.setAttribute("fill-rule",o.fillRule||"evenodd")):e.setAttribute("fill","none"))},_updatePoly:function(t,e){this._setPath(t,Xn(t._parts,e))},_updateCircle:function(t){var e=t._point,o=Math.max(Math.round(t._radius),1),l=Math.max(Math.round(t._radiusY),1)||o,u="a"+o+","+l+" 0 1,0 ",f=t._empty()?"M0 0":"M"+(e.x-o)+","+e.y+u+o*2+",0 "+u+-o*2+",0 ";this._setPath(t,f)},_setPath:function(t,e){t._path.setAttribute("d",e)},_bringToFront:function(t){ye(t._path)},_bringToBack:function(t){Le(t._path)}});ri&&Ke.include(ja);function Ro(t){return oi||ri?new Ke(t):null}tt.include({getRenderer:function(t){var e=t.options.renderer||this._getPaneRenderer(t.options.pane)||this.options.renderer||this._renderer;return e||(e=this._renderer=this._createRenderer()),this.hasLayer(e)||this.addLayer(e),e},_getPaneRenderer:function(t){if(t==="overlayPane"||t===void 0)return!1;var e=this._paneRenderers[t];return e===void 0&&(e=this._createRenderer({pane:t}),this._paneRenderers[t]=e),e},_createRenderer:function(t){return this.options.preferCanvas&&Io(t)||Ro(t)}});var Ao=we.extend({initialize:function(t,e){we.prototype.initialize.call(this,this._boundsToLatLngs(t),e)},setBounds:function(t){return this.setLatLngs(this._boundsToLatLngs(t))},_boundsToLatLngs:function(t){return t=Lt(t),[t.getSouthWest(),t.getNorthWest(),t.getNorthEast(),t.getSouthEast()]}});function Sa(t,e){return new Ao(t,e)}Ke.create=yi,Ke.pointsToPath=Xn,Ut.geometryToLayer=wn,Ut.coordsToLatLng=En,Ut.coordsToLatLngs=_i,Ut.latLngToCoords=Pn,Ut.latLngsToCoords=gi,Ut.getFeature=Ee,Ut.asFeature=vi,tt.mergeOptions({boxZoom:!0});var Bo=It.extend({initialize:function(t){this._map=t,this._container=t._container,this._pane=t._panes.overlayPane,this._resetStateTimeout=0,t.on("unload",this._destroy,this)},addHooks:function(){q(this._container,"mousedown",this._onMouseDown,this)},removeHooks:function(){_t(this._container,"mousedown",this._onMouseDown,this)},moved:function(){return this._moved},_destroy:function(){ct(this._pane),delete this._pane},_resetState:function(){this._resetStateTimeout=0,this._moved=!1},_clearDeferredResetState:function(){this._resetStateTimeout!==0&&(clearTimeout(this._resetStateTimeout),this._resetStateTimeout=0)},_onMouseDown:function(t){if(!t.shiftKey||t.which!==1&&t.button!==1)return!1;this._clearDeferredResetState(),this._resetState(),Ze(),rn(),this._startPoint=this._map.mouseEventToContainerPoint(t),q(document,{contextmenu:zt,mousemove:this._onMouseMove,mouseup:this._onMouseUp,keydown:this._onKeyDown},this)},_onMouseMove:function(t){this._moved||(this._moved=!0,this._box=it("div","leaflet-zoom-box",this._container),V(this._container,"leaflet-crosshair"),this._map.fire("boxzoomstart")),this._point=this._map.mouseEventToContainerPoint(t);var e=new C(this._point,this._startPoint),o=e.getSize();gt(this._box,e.min),this._box.style.width=o.x+"px",this._box.style.height=o.y+"px"},_finish:function(){this._moved&&(ct(this._box),pt(this._container,"leaflet-crosshair")),$e(),an(),_t(document,{contextmenu:zt,mousemove:this._onMouseMove,mouseup:this._onMouseUp,keydown:this._onKeyDown},this)},_onMouseUp:function(t){if(!(t.which!==1&&t.button!==1)&&(this._finish(),!!this._moved)){this._clearDeferredResetState(),this._resetStateTimeout=setTimeout(p(this._resetState,this),0);var e=new Et(this._map.containerPointToLatLng(this._startPoint),this._map.containerPointToLatLng(this._point));this._map.fitBounds(e).fire("boxzoomend",{boxZoomBounds:e})}},_onKeyDown:function(t){t.keyCode===27&&this._finish()}});tt.addInitHook("addHandler","boxZoom",Bo),tt.mergeOptions({doubleClickZoom:!0});var Zo=It.extend({addHooks:function(){this._map.on("dblclick",this._onDoubleClick,this)},removeHooks:function(){this._map.off("dblclick",this._onDoubleClick,this)},_onDoubleClick:function(t){var e=this._map,o=e.getZoom(),l=e.options.zoomDelta,u=t.originalEvent.shiftKey?o-l:o+l;e.options.doubleClickZoom==="center"?e.setZoom(u):e.setZoomAround(t.containerPoint,u)}});tt.addInitHook("addHandler","doubleClickZoom",Zo),tt.mergeOptions({dragging:!0,inertia:!Ie,inertiaDeceleration:3400,inertiaMaxSpeed:1/0,easeLinearity:.2,worldCopyJump:!1,maxBoundsViscosity:0});var $o=It.extend({addHooks:function(){if(!this._draggable){var t=this._map;this._draggable=new re(t._mapPane,t._container),this._draggable.on({dragstart:this._onDragStart,drag:this._onDrag,dragend:this._onDragEnd},this),this._draggable.on("predrag",this._onPreDragLimit,this),t.options.worldCopyJump&&(this._draggable.on("predrag",this._onPreDragWrap,this),t.on("zoomend",this._onZoomEnd,this),t.whenReady(this._onZoomEnd,this))}V(this._map._container,"leaflet-grab leaflet-touch-drag"),this._draggable.enable(),this._positions=[],this._times=[]},removeHooks:function(){pt(this._map._container,"leaflet-grab"),pt(this._map._container,"leaflet-touch-drag"),this._draggable.disable()},moved:function(){return this._draggable&&this._draggable._moved},moving:function(){return this._draggable&&this._draggable._moving},_onDragStart:function(){var t=this._map;if(t._stop(),this._map.options.maxBounds&&this._map.options.maxBoundsViscosity){var e=Lt(this._map.options.maxBounds);this._offsetLimit=ot(this._map.latLngToContainerPoint(e.getNorthWest()).multiplyBy(-1),this._map.latLngToContainerPoint(e.getSouthEast()).multiplyBy(-1).add(this._map.getSize())),this._viscosity=Math.min(1,Math.max(0,this._map.options.maxBoundsViscosity))}else this._offsetLimit=null;t.fire("movestart").fire("dragstart"),t.options.inertia&&(this._positions=[],this._times=[])},_onDrag:function(t){if(this._map.options.inertia){var e=this._lastTime=+new Date,o=this._lastPos=this._draggable._absPos||this._draggable._newPos;this._positions.push(o),this._times.push(e),this._prunePositions(e)}this._map.fire("move",t).fire("drag",t)},_prunePositions:function(t){for(;this._positions.length>1&&t-this._times[0]>50;)this._positions.shift(),this._times.shift()},_onZoomEnd:function(){var t=this._map.getSize().divideBy(2),e=this._map.latLngToLayerPoint([0,0]);this._initialWorldOffset=e.subtract(t).x,this._worldWidth=this._map.getPixelWorldBounds().getSize().x},_viscousLimit:function(t,e){return t-(t-e)*this._viscosity},_onPreDragLimit:function(){if(!(!this._viscosity||!this._offsetLimit)){var t=this._draggable._newPos.subtract(this._draggable._startPos),e=this._offsetLimit;t.x<e.min.x&&(t.x=this._viscousLimit(t.x,e.min.x)),t.y<e.min.y&&(t.y=this._viscousLimit(t.y,e.min.y)),t.x>e.max.x&&(t.x=this._viscousLimit(t.x,e.max.x)),t.y>e.max.y&&(t.y=this._viscousLimit(t.y,e.max.y)),this._draggable._newPos=this._draggable._startPos.add(t)}},_onPreDragWrap:function(){var t=this._worldWidth,e=Math.round(t/2),o=this._initialWorldOffset,l=this._draggable._newPos.x,u=(l-e+o)%t+e-o,f=(l+e+o)%t-e-o,m=Math.abs(u+o)<Math.abs(f+o)?u:f;this._draggable._absPos=this._draggable._newPos.clone(),this._draggable._newPos.x=m},_onDragEnd:function(t){var e=this._map,o=e.options,l=!o.inertia||this._times.length<2;if(e.fire("dragend",t),l)e.fire("moveend");else{this._prunePositions(+new Date);var u=this._lastPos.subtract(this._positions[0]),f=(this._lastTime-this._times[0])/1e3,m=o.easeLinearity,y=u.multiplyBy(m/f),x=y.distanceTo([0,0]),E=Math.min(o.inertiaMaxSpeed,x),N=y.multiplyBy(E/x),U=E/(o.inertiaDeceleration*m),Q=N.multiplyBy(-U/2).round();!Q.x&&!Q.y?e.fire("moveend"):(Q=e._limitOffset(Q,e.options.maxBounds),B(function(){e.panBy(Q,{duration:U,easeLinearity:m,noMoveStart:!0,animate:!0})}))}}});tt.addInitHook("addHandler","dragging",$o),tt.mergeOptions({keyboard:!0,keyboardPanDelta:80});var Uo=It.extend({keyCodes:{left:[37],right:[39],down:[40],up:[38],zoomIn:[187,107,61,171],zoomOut:[189,109,54,173]},initialize:function(t){this._map=t,this._setPanDelta(t.options.keyboardPanDelta),this._setZoomDelta(t.options.zoomDelta)},addHooks:function(){var t=this._map._container;t.tabIndex<=0&&(t.tabIndex="0"),q(t,{focus:this._onFocus,blur:this._onBlur,mousedown:this._onMouseDown},this),this._map.on({focus:this._addHooks,blur:this._removeHooks},this)},removeHooks:function(){this._removeHooks(),_t(this._map._container,{focus:this._onFocus,blur:this._onBlur,mousedown:this._onMouseDown},this),this._map.off({focus:this._addHooks,blur:this._removeHooks},this)},_onMouseDown:function(){if(!this._focused){var t=document.body,e=document.documentElement,o=t.scrollTop||e.scrollTop,l=t.scrollLeft||e.scrollLeft;this._map._container.focus(),window.scrollTo(l,o)}},_onFocus:function(){this._focused=!0,this._map.fire("focus")},_onBlur:function(){this._focused=!1,this._map.fire("blur")},_setPanDelta:function(t){var e=this._panKeys={},o=this.keyCodes,l,u;for(l=0,u=o.left.length;l<u;l++)e[o.left[l]]=[-1*t,0];for(l=0,u=o.right.length;l<u;l++)e[o.right[l]]=[t,0];for(l=0,u=o.down.length;l<u;l++)e[o.down[l]]=[0,t];for(l=0,u=o.up.length;l<u;l++)e[o.up[l]]=[0,-1*t]},_setZoomDelta:function(t){var e=this._zoomKeys={},o=this.keyCodes,l,u;for(l=0,u=o.zoomIn.length;l<u;l++)e[o.zoomIn[l]]=t;for(l=0,u=o.zoomOut.length;l<u;l++)e[o.zoomOut[l]]=-t},_addHooks:function(){q(document,"keydown",this._onKeyDown,this)},_removeHooks:function(){_t(document,"keydown",this._onKeyDown,this)},_onKeyDown:function(t){if(!(t.altKey||t.ctrlKey||t.metaKey)){var e=t.keyCode,o=this._map,l;if(e in this._panKeys)(!o._panAnim||!o._panAnim._inProgress)&&(l=this._panKeys[e],t.shiftKey&&(l=J(l).multiplyBy(3)),o.panBy(l),o.options.maxBounds&&o.panInsideBounds(o.options.maxBounds));else if(e in this._zoomKeys)o.setZoom(o.getZoom()+(t.shiftKey?3:1)*this._zoomKeys[e]);else if(e===27&&o._popup&&o._popup.options.closeOnEscapeKey)o.closePopup();else return;zt(t)}}});tt.addInitHook("addHandler","keyboard",Uo),tt.mergeOptions({scrollWheelZoom:!0,wheelDebounceTime:40,wheelPxPerZoomLevel:60});var Fo=It.extend({addHooks:function(){q(this._map._container,"mousewheel",this._onWheelScroll,this),this._delta=0},removeHooks:function(){_t(this._map._container,"mousewheel",this._onWheelScroll,this)},_onWheelScroll:function(t){var e=_o(t),o=this._map.options.wheelDebounceTime;this._delta+=e,this._lastMousePos=this._map.mouseEventToContainerPoint(t),this._startTime||(this._startTime=+new Date);var l=Math.max(o-(+new Date-this._startTime),0);clearTimeout(this._timer),this._timer=setTimeout(p(this._performZoom,this),l),zt(t)},_performZoom:function(){var t=this._map,e=t.getZoom(),o=this._map.options.zoomSnap||0;t._stop();var l=this._delta/(this._map.options.wheelPxPerZoomLevel*4),u=4*Math.log(2/(1+Math.exp(-Math.abs(l))))/Math.LN2,f=o?Math.ceil(u/o)*o:u,m=t._limitZoom(e+(this._delta>0?f:-f))-e;this._delta=0,this._startTime=null,m&&(t.options.scrollWheelZoom==="center"?t.setZoom(e+m):t.setZoomAround(this._lastMousePos,e+m))}});tt.addInitHook("addHandler","scrollWheelZoom",Fo),tt.mergeOptions({tap:!0,tapTolerance:15});var Ho=It.extend({addHooks:function(){q(this._map._container,"touchstart",this._onDown,this)},removeHooks:function(){_t(this._map._container,"touchstart",this._onDown,this)},_onDown:function(t){if(t.touches){if(Ot(t),this._fireClick=!0,t.touches.length>1){this._fireClick=!1,clearTimeout(this._holdTimeout);return}var e=t.touches[0],o=e.target;this._startPos=this._newPos=new R(e.clientX,e.clientY),o.tagName&&o.tagName.toLowerCase()==="a"&&V(o,"leaflet-active"),this._holdTimeout=setTimeout(p(function(){this._isTapValid()&&(this._fireClick=!1,this._onUp(),this._simulateEvent("contextmenu",e))},this),1e3),this._simulateEvent("mousedown",e),q(document,{touchmove:this._onMove,touchend:this._onUp},this)}},_onUp:function(t){if(clearTimeout(this._holdTimeout),_t(document,{touchmove:this._onMove,touchend:this._onUp},this),this._fireClick&&t&&t.changedTouches){var e=t.changedTouches[0],o=e.target;o&&o.tagName&&o.tagName.toLowerCase()==="a"&&pt(o,"leaflet-active"),this._simulateEvent("mouseup",e),this._isTapValid()&&this._simulateEvent("click",e)}},_isTapValid:function(){return this._newPos.distanceTo(this._startPos)<=this._map.options.tapTolerance},_onMove:function(t){var e=t.touches[0];this._newPos=new R(e.clientX,e.clientY),this._simulateEvent("mousemove",e)},_simulateEvent:function(t,e){var o=document.createEvent("MouseEvents");o._simulated=!0,e.target._simulatedClick=!0,o.initMouseEvent(t,!0,!0,window,1,e.screenX,e.screenY,e.clientX,e.clientY,!1,!1,!1,!1,0,null),e.target.dispatchEvent(o)}});Dt&&!Mt&&tt.addInitHook("addHandler","tap",Ho),tt.mergeOptions({touchZoom:Dt&&!Ie,bounceAtZoomLimits:!0});var Go=It.extend({addHooks:function(){V(this._map._container,"leaflet-touch-zoom"),q(this._map._container,"touchstart",this._onTouchStart,this)},removeHooks:function(){pt(this._map._container,"leaflet-touch-zoom"),_t(this._map._container,"touchstart",this._onTouchStart,this)},_onTouchStart:function(t){var e=this._map;if(!(!t.touches||t.touches.length!==2||e._animatingZoom||this._zooming)){var o=e.mouseEventToContainerPoint(t.touches[0]),l=e.mouseEventToContainerPoint(t.touches[1]);this._centerPoint=e.getSize()._divideBy(2),this._startLatLng=e.containerPointToLatLng(this._centerPoint),e.options.touchZoom!=="center"&&(this._pinchStartLatLng=e.containerPointToLatLng(o.add(l)._divideBy(2))),this._startDist=o.distanceTo(l),this._startZoom=e.getZoom(),this._moved=!1,this._zooming=!0,e._stop(),q(document,"touchmove",this._onTouchMove,this),q(document,"touchend",this._onTouchEnd,this),Ot(t)}},_onTouchMove:function(t){if(!(!t.touches||t.touches.length!==2||!this._zooming)){var e=this._map,o=e.mouseEventToContainerPoint(t.touches[0]),l=e.mouseEventToContainerPoint(t.touches[1]),u=o.distanceTo(l)/this._startDist;if(this._zoom=e.getScaleZoom(u,this._startZoom),!e.options.bounceAtZoomLimits&&(this._zoom<e.getMinZoom()&&u<1||this._zoom>e.getMaxZoom()&&u>1)&&(this._zoom=e._limitZoom(this._zoom)),e.options.touchZoom==="center"){if(this._center=this._startLatLng,u===1)return}else{var f=o._add(l)._divideBy(2)._subtract(this._centerPoint);if(u===1&&f.x===0&&f.y===0)return;this._center=e.unproject(e.project(this._pinchStartLatLng,this._zoom).subtract(f),this._zoom)}this._moved||(e._moveStart(!0,!1),this._moved=!0),$(this._animRequest);var m=p(e._move,e,this._center,this._zoom,{pinch:!0,round:!1});this._animRequest=B(m,this,!0),Ot(t)}},_onTouchEnd:function(){if(!this._moved||!this._zooming){this._zooming=!1;return}this._zooming=!1,$(this._animRequest),_t(document,"touchmove",this._onTouchMove),_t(document,"touchend",this._onTouchEnd),this._map.options.zoomAnimation?this._map._animateZoom(this._center,this._map._limitZoom(this._zoom),!0,this._map.options.zoomSnap):this._map._resetView(this._center,this._map._limitZoom(this._zoom))}});tt.addInitHook("addHandler","touchZoom",Go),tt.BoxZoom=Bo,tt.DoubleClickZoom=Zo,tt.Drag=$o,tt.Keyboard=Uo,tt.ScrollWheelZoom=Fo,tt.Tap=Ho,tt.TouchZoom=Go,Object.freeze=i,h.version=s,h.Control=St,h.control=He,h.Browser=Br,h.Evented=xt,h.Mixin=oa,h.Util=lt,h.Class=S,h.Handler=It,h.extend=r,h.bind=p,h.stamp=g,h.setOptions=v,h.DomEvent=Xr,h.DomUtil=Yr,h.PosAnimation=go,h.Draggable=re,h.LineUtil=ha,h.PolyUtil=ca,h.Point=R,h.point=J,h.Bounds=C,h.bounds=ot,h.Transformation=Bi,h.transformation=Ne,h.Projection=ua,h.LatLng=st,h.latLng=ft,h.LatLngBounds=Et,h.latLngBounds=Lt,h.CRS=Bt,h.GeoJSON=Ut,h.geoJSON=jo,h.geoJson=ba,h.Layer=kt,h.LayerGroup=xe,h.layerGroup=pa,h.FeatureGroup=se,h.featureGroup=ma,h.ImageOverlay=On,h.imageOverlay=wa,h.VideoOverlay=So,h.videoOverlay=Ea,h.DivOverlay=Ft,h.Popup=Pe,h.popup=Pa,h.Tooltip=Te,h.tooltip=Ta,h.Icon=be,h.icon=_a,h.DivIcon=Co,h.divIcon=Oa,h.Marker=Ve,h.marker=ga,h.TileLayer=Oe,h.tileLayer=Do,h.GridLayer=qe,h.gridLayer=ka,h.SVG=Ke,h.svg=Ro,h.Renderer=Rt,h.Canvas=zo,h.canvas=Io,h.Path=Xt,h.CircleMarker=mi,h.circleMarker=va,h.Circle=bn,h.circle=ya,h.Polyline=$t,h.polyline=La,h.Polygon=we,h.polygon=xa,h.Rectangle=Ao,h.rectangle=Sa,h.Map=tt,h.map=Qr;var Ca=window.L;h.noConflict=function(){return window.L=Ca,this},window.L=h})})(zn,zn.exports);var rt=zn.exports;const bt=dr(rt);var ol=Object.assign||function(a){for(var n=1;n<arguments.length;n++){var h=arguments[n];for(var s in h)Object.prototype.hasOwnProperty.call(h,s)&&(a[s]=h[s])}return a},xr=w.createContext({}),br=xr.Consumer,rl=xr.Provider,al=br,Ce=rl,dt=function(n){var h=function(d,p){return wt.createElement(br,null,function(_){return wt.createElement(n,ol({},d,{leaflet:_,ref:p}))})},s=n.displayName||n.name;h.displayName="Leaflet("+s+")";var i=w.forwardRef(h);return Ua(i,n),i};function sl(a,n){for(var h=Object.getOwnPropertyNames(n),s=0;s<h.length;s++){var i=h[s],r=Object.getOwnPropertyDescriptor(n,i);r&&r.configurable&&a[i]===void 0&&Object.defineProperty(a,i,r)}return a}function ll(a,n){if(!(a instanceof n))throw new TypeError("Cannot call a class as a function")}function hl(a,n){if(!a)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return n&&(typeof n=="object"||typeof n=="function")?n:a}function cl(a,n){if(typeof n!="function"&&n!==null)throw new TypeError("Super expression must either be null or a function, not "+typeof n);a.prototype=Object.create(n&&n.prototype,{constructor:{value:a,enumerable:!1,writable:!0,configurable:!0}}),n&&(Object.setPrototypeOf?Object.setPrototypeOf(a,n):sl(a,n))}var De=function(a){cl(n,a);function n(h){ll(this,n);var s=hl(this,a.call(this,h));return s.leafletElement=s.createLeafletElement(s.props),s}return n.prototype.createLeafletElement=function(s){throw new Error("createLeafletElement() must be implemented")},n.prototype.updateLeafletElement=function(s,i){i.position!==s.position&&this.leafletElement.setPosition(i.position)},n.prototype.componentDidMount=function(){this.leafletElement.addTo(this.props.leaflet.map)},n.prototype.componentDidUpdate=function(s){this.updateLeafletElement(s,this.props)},n.prototype.componentWillUnmount=function(){this.leafletElement.remove()},n.prototype.render=function(){return null},n}(w.Component);function ul(a,n){for(var h=Object.getOwnPropertyNames(n),s=0;s<h.length;s++){var i=h[s],r=Object.getOwnPropertyDescriptor(n,i);r&&r.configurable&&a[i]===void 0&&Object.defineProperty(a,i,r)}return a}function dl(a,n){if(!(a instanceof n))throw new TypeError("Cannot call a class as a function")}function fl(a,n){if(!a)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return n&&(typeof n=="object"||typeof n=="function")?n:a}function pl(a,n){if(typeof n!="function"&&n!==null)throw new TypeError("Super expression must either be null or a function, not "+typeof n);a.prototype=Object.create(n&&n.prototype,{constructor:{value:a,enumerable:!1,writable:!0,configurable:!0}}),n&&(Object.setPrototypeOf?Object.setPrototypeOf(a,n):ul(a,n))}var ml=function(a){pl(n,a);function n(){return dl(this,n),fl(this,a.apply(this,arguments))}return n.prototype.createLeafletElement=function(s){return new rt.Control.Attribution(s)},n}(De);const _l=dt(ml);function gl(a,n,h){for(var s=-1,i=n.length,r={};++s<i;){var d=n[s],p=Va(a,d);h(p,d)&&qa(r,mr(d,a),p)}return r}function vl(a,n){return gl(a,n,function(h,s){return Ya(a,s)})}var Qo=Yo?Yo.isConcatSpreadable:void 0;function yl(a){return Gn(a)||Ka(a)||!!(Qo&&a&&a[Qo])}function Ll(a,n,h,s,i){var r=-1,d=a.length;for(h||(h=yl),i||(i=[]);++r<d;){var p=a[r];h(p)?Ja(i,p):i[i.length]=p}return i}function xl(a){var n=a==null?0:a.length;return n?Ll(a):[]}function wr(a){return Xa(Qa(a,void 0,xl),a+"")}var bl=wr(function(a,n){return a==null?{}:vl(a,n)});function wl(a){return typeof a=="function"?a:ts}function Pi(a,n){var h=Gn(a)?es:_r;return h(a,wl(n))}var tr=Object.assign||function(a){for(var n=1;n<arguments.length;n++){var h=arguments[n];for(var s in h)Object.prototype.hasOwnProperty.call(h,s)&&(a[s]=h[s])}return a};function El(a,n){for(var h=Object.getOwnPropertyNames(n),s=0;s<h.length;s++){var i=h[s],r=Object.getOwnPropertyDescriptor(n,i);r&&r.configurable&&a[i]===void 0&&Object.defineProperty(a,i,r)}return a}function Pl(a,n){if(!(a instanceof n))throw new TypeError("Cannot call a class as a function")}function Tl(a,n){if(!a)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return n&&(typeof n=="object"||typeof n=="function")?n:a}function Ol(a,n){if(typeof n!="function"&&n!==null)throw new TypeError("Super expression must either be null or a function, not "+typeof n);a.prototype=Object.create(n&&n.prototype,{constructor:{value:a,enumerable:!1,writable:!0,configurable:!0}}),n&&(Object.setPrototypeOf?Object.setPrototypeOf(a,n):El(a,n))}var In=/^on(.+)$/i,Di=function(a){Ol(n,a);function n(h){Pl(this,n);var s=Tl(this,a.call(this,h));return s._leafletEvents=s.extractLeafletEvents(h),s}return n.prototype.componentDidMount=function(){this.bindLeafletEvents(this._leafletEvents)},n.prototype.componentDidUpdate=function(s){this._leafletEvents=this.bindLeafletEvents(this.extractLeafletEvents(this.props),this._leafletEvents)},n.prototype.componentWillUnmount=function(){var s=this.leafletElement;s&&Pi(this._leafletEvents,function(i,r){s.off(r,i)})},n.prototype.extractLeafletEvents=function(s){return Object.keys(s).reduce(function(i,r){if(In.test(r)&&s[r]!=null){var d=r.replace(In,function(p,_){return _.toLowerCase()});i[d]=s[r]}return i},{})},n.prototype.bindLeafletEvents=function(){var s=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},i=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},r=this.leafletElement;if(r==null||r.on==null)return{};var d=tr({},i);return Pi(i,function(p,_){(s[_]==null||p!==s[_])&&(delete d[_],r.off(_,p))}),Pi(s,function(p,_){(i[_]==null||p!==i[_])&&(d[_]=p,r.on(_,p))}),d},n.prototype.fireLeafletEvent=function(s,i){var r=this.leafletElement;r&&r.fire(s,i)},n.prototype.getOptions=function(s){return s.pane!=null?s:s.leaflet!=null&&s.leaflet.pane!=null?tr({},s,{pane:s.leaflet.pane}):s},n}(w.Component),kl=function(){function a(n,h){for(var s=0;s<h.length;s++){var i=h[s];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(n,i.key,i)}}return function(n,h,s){return h&&a(n.prototype,h),s&&a(n,s),n}}();function Ml(a,n){for(var h=Object.getOwnPropertyNames(n),s=0;s<h.length;s++){var i=h[s],r=Object.getOwnPropertyDescriptor(n,i);r&&r.configurable&&a[i]===void 0&&Object.defineProperty(a,i,r)}return a}function jl(a,n){if(!(a instanceof n))throw new TypeError("Cannot call a class as a function")}function Sl(a,n){if(!a)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return n&&(typeof n=="object"||typeof n=="function")?n:a}function Cl(a,n){if(typeof n!="function"&&n!==null)throw new TypeError("Super expression must either be null or a function, not "+typeof n);a.prototype=Object.create(n&&n.prototype,{constructor:{value:a,enumerable:!1,writable:!0,configurable:!0}}),n&&(Object.setPrototypeOf?Object.setPrototypeOf(a,n):Ml(a,n))}var de=function(a){Cl(n,a);function n(h){jl(this,n);var s=Sl(this,a.call(this,h));return s.leafletElement=s.createLeafletElement(h),s}return n.prototype.createLeafletElement=function(s){throw new Error("createLeafletElement() must be implemented")},n.prototype.updateLeafletElement=function(s,i){},n.prototype.componentDidMount=function(){a.prototype.componentDidMount.call(this),this.layerContainer.addLayer(this.leafletElement)},n.prototype.componentDidUpdate=function(s){a.prototype.componentDidUpdate.call(this,s),this.updateLeafletElement(s,this.props)},n.prototype.componentWillUnmount=function(){a.prototype.componentWillUnmount.call(this),this.layerContainer.removeLayer(this.leafletElement)},n.prototype.render=function(){var s=this.props.children;return s==null?null:this.contextValue==null?wt.createElement(w.Fragment,null,s):wt.createElement(Ce,{value:this.contextValue},s)},kl(n,[{key:"layerContainer",get:function(){return this.props.leaflet.layerContainer||this.props.leaflet.map}}]),n}(Di),Dl=Object.assign||function(a){for(var n=1;n<arguments.length;n++){var h=arguments[n];for(var s in h)Object.prototype.hasOwnProperty.call(h,s)&&(a[s]=h[s])}return a};function Nl(a,n){for(var h=Object.getOwnPropertyNames(n),s=0;s<h.length;s++){var i=h[s],r=Object.getOwnPropertyDescriptor(n,i);r&&r.configurable&&a[i]===void 0&&Object.defineProperty(a,i,r)}return a}function zl(a,n){if(!(a instanceof n))throw new TypeError("Cannot call a class as a function")}function Il(a,n){if(!a)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return n&&(typeof n=="object"||typeof n=="function")?n:a}function Rl(a,n){if(typeof n!="function"&&n!==null)throw new TypeError("Super expression must either be null or a function, not "+typeof n);a.prototype=Object.create(n&&n.prototype,{constructor:{value:a,enumerable:!1,writable:!0,configurable:!0}}),n&&(Object.setPrototypeOf?Object.setPrototypeOf(a,n):Nl(a,n))}var Al=["stroke","color","weight","opacity","lineCap","lineJoin","dashArray","dashOffset","fill","fillColor","fillOpacity","fillRule","bubblingMouseEvents","renderer","className","interactive","pane","attribution"],ie=function(a){Rl(n,a);function n(h){zl(this,n);var s=Il(this,a.call(this,h));return s.contextValue==null&&(s.contextValue=Dl({},h.leaflet,{popupContainer:s.leafletElement})),s}return n.prototype.componentDidUpdate=function(s){a.prototype.componentDidUpdate.call(this,s),this.setStyleIfChanged(s,this.props)},n.prototype.getPathOptions=function(s){return bl(s,Al)},n.prototype.setStyle=function(){var s=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};this.leafletElement.setStyle(s)},n.prototype.setStyleIfChanged=function(s,i){var r=this.getPathOptions(i);Wn(r,this.getPathOptions(s))||this.setStyle(r)},n}(de);function Bl(a,n){for(var h=Object.getOwnPropertyNames(n),s=0;s<h.length;s++){var i=h[s],r=Object.getOwnPropertyDescriptor(n,i);r&&r.configurable&&a[i]===void 0&&Object.defineProperty(a,i,r)}return a}function Zl(a,n){var h={};for(var s in a)n.indexOf(s)>=0||Object.prototype.hasOwnProperty.call(a,s)&&(h[s]=a[s]);return h}function $l(a,n){if(!(a instanceof n))throw new TypeError("Cannot call a class as a function")}function Ul(a,n){if(!a)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return n&&(typeof n=="object"||typeof n=="function")?n:a}function Fl(a,n){if(typeof n!="function"&&n!==null)throw new TypeError("Super expression must either be null or a function, not "+typeof n);a.prototype=Object.create(n&&n.prototype,{constructor:{value:a,enumerable:!1,writable:!0,configurable:!0}}),n&&(Object.setPrototypeOf?Object.setPrototypeOf(a,n):Bl(a,n))}var Hl=function(a){Fl(n,a);function n(){return $l(this,n),Ul(this,a.apply(this,arguments))}return n.prototype.createLeafletElement=function(s){var i=s.center,r=s.radius,d=Zl(s,["center","radius"]);return new rt.Circle(i,r,this.getOptions(d))},n.prototype.updateLeafletElement=function(s,i){i.center!==s.center&&this.leafletElement.setLatLng(i.center),i.radius!==s.radius&&this.leafletElement.setRadius(i.radius)},n}(ie);const Gl=dt(Hl);var Wl=Object.assign||function(a){for(var n=1;n<arguments.length;n++){var h=arguments[n];for(var s in h)Object.prototype.hasOwnProperty.call(h,s)&&(a[s]=h[s])}return a};function Vl(a,n){for(var h=Object.getOwnPropertyNames(n),s=0;s<h.length;s++){var i=h[s],r=Object.getOwnPropertyDescriptor(n,i);r&&r.configurable&&a[i]===void 0&&Object.defineProperty(a,i,r)}return a}function ql(a,n){if(!(a instanceof n))throw new TypeError("Cannot call a class as a function")}function Yl(a,n){if(!a)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return n&&(typeof n=="object"||typeof n=="function")?n:a}function Kl(a,n){if(typeof n!="function"&&n!==null)throw new TypeError("Super expression must either be null or a function, not "+typeof n);a.prototype=Object.create(n&&n.prototype,{constructor:{value:a,enumerable:!1,writable:!0,configurable:!0}}),n&&(Object.setPrototypeOf?Object.setPrototypeOf(a,n):Vl(a,n))}var Jl=function(a){Kl(n,a);function n(){return ql(this,n),Yl(this,a.apply(this,arguments))}return n.prototype.createLeafletElement=function(s){var i=new rt.CircleMarker(s.center,this.getOptions(s));return this.contextValue=Wl({},s.leaflet,{popupContainer:i}),i},n.prototype.updateLeafletElement=function(s,i){i.center!==s.center&&this.leafletElement.setLatLng(i.center),i.radius!==s.radius&&this.leafletElement.setRadius(i.radius)},n}(ie);const Xl=dt(Jl);var er=function(){var n=arguments.length>0&&arguments[0]!==void 0?arguments[0]:"";return n.split(" ").filter(Boolean)};const Er=function(a,n,h){a!=null&&h!==n&&(n!=null&&n.length>0&&er(n).forEach(function(s){rt.DomUtil.removeClass(a,s)}),h!=null&&h.length>0&&er(h).forEach(function(s){rt.DomUtil.addClass(a,s)}))};function Ql(a,n){for(var h=Object.getOwnPropertyNames(n),s=0;s<h.length;s++){var i=h[s],r=Object.getOwnPropertyDescriptor(n,i);r&&r.configurable&&a[i]===void 0&&Object.defineProperty(a,i,r)}return a}function th(a,n){if(!(a instanceof n))throw new TypeError("Cannot call a class as a function")}function eh(a,n){if(!a)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return n&&(typeof n=="object"||typeof n=="function")?n:a}function ih(a,n){if(typeof n!="function"&&n!==null)throw new TypeError("Super expression must either be null or a function, not "+typeof n);a.prototype=Object.create(n&&n.prototype,{constructor:{value:a,enumerable:!1,writable:!0,configurable:!0}}),n&&(Object.setPrototypeOf?Object.setPrototypeOf(a,n):Ql(a,n))}var nh=function(a){ih(n,a);function n(h){th(this,n);var s=eh(this,a.call(this,h));return s.onClose=function(){s.props.onClose&&s.props.onClose()},s.onOpen=function(){s.forceUpdate(),s.props.onOpen&&s.props.onOpen()},s.leafletElement=s.createLeafletElement(h),s}return n.prototype.createLeafletElement=function(s){throw new Error("createLeafletElement() must be implemented")},n.prototype.updateLeafletElement=function(s,i){},n.prototype.componentDidUpdate=function(s){Er(this.leafletElement._container,s.className,this.props.className),this.updateLeafletElement(s,this.props),this.leafletElement.isOpen()&&(this.leafletElement.update(),this.onRender())},n.prototype.onRender=function(){},n.prototype.render=function(){return this.leafletElement._contentNode?fr.createPortal(this.props.children,this.leafletElement._contentNode):null},n}(Di);const Vn=nh;var oh=Object.assign||function(a){for(var n=1;n<arguments.length;n++){var h=arguments[n];for(var s in h)Object.prototype.hasOwnProperty.call(h,s)&&(a[s]=h[s])}return a};function rh(a,n){for(var h=Object.getOwnPropertyNames(n),s=0;s<h.length;s++){var i=h[s],r=Object.getOwnPropertyDescriptor(n,i);r&&r.configurable&&a[i]===void 0&&Object.defineProperty(a,i,r)}return a}function ah(a,n){if(!(a instanceof n))throw new TypeError("Cannot call a class as a function")}function sh(a,n){if(!a)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return n&&(typeof n=="object"||typeof n=="function")?n:a}function lh(a,n){if(typeof n!="function"&&n!==null)throw new TypeError("Super expression must either be null or a function, not "+typeof n);a.prototype=Object.create(n&&n.prototype,{constructor:{value:a,enumerable:!1,writable:!0,configurable:!0}}),n&&(Object.setPrototypeOf?Object.setPrototypeOf(a,n):rh(a,n))}var hh=function(a){lh(n,a);function n(){return ah(this,n),sh(this,a.apply(this,arguments))}return n.prototype.createLeafletElement=function(s){var i=new rt.FeatureGroup(this.getOptions(s));return this.contextValue=oh({},s.leaflet,{layerContainer:i,popupContainer:i}),i},n.prototype.componentDidMount=function(){a.prototype.componentDidMount.call(this),this.setStyle(this.props)},n}(ie);const Pr=dt(hh);function ch(a,n){for(var h=Object.getOwnPropertyNames(n),s=0;s<h.length;s++){var i=h[s],r=Object.getOwnPropertyDescriptor(n,i);r&&r.configurable&&a[i]===void 0&&Object.defineProperty(a,i,r)}return a}function uh(a,n){if(!(a instanceof n))throw new TypeError("Cannot call a class as a function")}function dh(a,n){if(!a)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return n&&(typeof n=="object"||typeof n=="function")?n:a}function fh(a,n){if(typeof n!="function"&&n!==null)throw new TypeError("Super expression must either be null or a function, not "+typeof n);a.prototype=Object.create(n&&n.prototype,{constructor:{value:a,enumerable:!1,writable:!0,configurable:!0}}),n&&(Object.setPrototypeOf?Object.setPrototypeOf(a,n):ch(a,n))}var ph=function(a){fh(n,a);function n(){return uh(this,n),dh(this,a.apply(this,arguments))}return n.prototype.createLeafletElement=function(s){return new rt.GeoJSON(s.data,this.getOptions(s))},n.prototype.updateLeafletElement=function(s,i){is(i.style)?this.setStyle(i.style):this.setStyleIfChanged(s,i)},n}(ie);const mh=dt(ph);var _h=Object.assign||function(a){for(var n=1;n<arguments.length;n++){var h=arguments[n];for(var s in h)Object.prototype.hasOwnProperty.call(h,s)&&(a[s]=h[s])}return a};function gh(a,n){for(var h=Object.getOwnPropertyNames(n),s=0;s<h.length;s++){var i=h[s],r=Object.getOwnPropertyDescriptor(n,i);r&&r.configurable&&a[i]===void 0&&Object.defineProperty(a,i,r)}return a}function vh(a,n){if(!(a instanceof n))throw new TypeError("Cannot call a class as a function")}function yh(a,n){if(!a)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return n&&(typeof n=="object"||typeof n=="function")?n:a}function Lh(a,n){if(typeof n!="function"&&n!==null)throw new TypeError("Super expression must either be null or a function, not "+typeof n);a.prototype=Object.create(n&&n.prototype,{constructor:{value:a,enumerable:!1,writable:!0,configurable:!0}}),n&&(Object.setPrototypeOf?Object.setPrototypeOf(a,n):gh(a,n))}var Ni=function(a){Lh(n,a);function n(){return vh(this,n),yh(this,a.apply(this,arguments))}return n.prototype.createLeafletElement=function(s){return new rt.GridLayer(this.getOptions(s))},n.prototype.updateLeafletElement=function(s,i){var r=i.opacity,d=i.zIndex;r!==s.opacity&&this.leafletElement.setOpacity(r),d!==s.zIndex&&this.leafletElement.setZIndex(d)},n.prototype.getOptions=function(s){var i=a.prototype.getOptions.call(this,s);return s.leaflet.map==null?i:_h({maxZoom:s.leaflet.map.options.maxZoom,minZoom:s.leaflet.map.options.minZoom},i)},n.prototype.render=function(){return null},n}(de),xh=Object.assign||function(a){for(var n=1;n<arguments.length;n++){var h=arguments[n];for(var s in h)Object.prototype.hasOwnProperty.call(h,s)&&(a[s]=h[s])}return a};function bh(a,n){for(var h=Object.getOwnPropertyNames(n),s=0;s<h.length;s++){var i=h[s],r=Object.getOwnPropertyDescriptor(n,i);r&&r.configurable&&a[i]===void 0&&Object.defineProperty(a,i,r)}return a}function wh(a,n){if(!(a instanceof n))throw new TypeError("Cannot call a class as a function")}function Eh(a,n){if(!a)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return n&&(typeof n=="object"||typeof n=="function")?n:a}function Ph(a,n){if(typeof n!="function"&&n!==null)throw new TypeError("Super expression must either be null or a function, not "+typeof n);a.prototype=Object.create(n&&n.prototype,{constructor:{value:a,enumerable:!1,writable:!0,configurable:!0}}),n&&(Object.setPrototypeOf?Object.setPrototypeOf(a,n):bh(a,n))}var Th=function(a){Ph(n,a);function n(){return wh(this,n),Eh(this,a.apply(this,arguments))}return n.prototype.createLeafletElement=function(s){var i=new rt.ImageOverlay(s.url,s.bounds,this.getOptions(s));return this.contextValue=xh({},s.leaflet,{popupContainer:i}),i},n.prototype.updateLeafletElement=function(s,i){i.url!==s.url&&this.leafletElement.setUrl(i.url),i.bounds!==s.bounds&&this.leafletElement.setBounds(rt.latLngBounds(i.bounds)),i.opacity!==s.opacity&&this.leafletElement.setOpacity(i.opacity),i.zIndex!==s.zIndex&&this.leafletElement.setZIndex(i.zIndex)},n}(de);const Oh=dt(Th);var kh=Object.assign||function(a){for(var n=1;n<arguments.length;n++){var h=arguments[n];for(var s in h)Object.prototype.hasOwnProperty.call(h,s)&&(a[s]=h[s])}return a};function Mh(a,n){for(var h=Object.getOwnPropertyNames(n),s=0;s<h.length;s++){var i=h[s],r=Object.getOwnPropertyDescriptor(n,i);r&&r.configurable&&a[i]===void 0&&Object.defineProperty(a,i,r)}return a}function jh(a,n){if(!(a instanceof n))throw new TypeError("Cannot call a class as a function")}function Sh(a,n){if(!a)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return n&&(typeof n=="object"||typeof n=="function")?n:a}function Ch(a,n){if(typeof n!="function"&&n!==null)throw new TypeError("Super expression must either be null or a function, not "+typeof n);a.prototype=Object.create(n&&n.prototype,{constructor:{value:a,enumerable:!1,writable:!0,configurable:!0}}),n&&(Object.setPrototypeOf?Object.setPrototypeOf(a,n):Mh(a,n))}var Dh=function(a){Ch(n,a);function n(){return jh(this,n),Sh(this,a.apply(this,arguments))}return n.prototype.createLeafletElement=function(s){var i=new rt.LayerGroup(this.getOptions(s));return this.contextValue=kh({},s.leaflet,{layerContainer:i}),i},n}(de);const Nh=dt(Dh);var Tr=Object.assign||function(a){for(var n=1;n<arguments.length;n++){var h=arguments[n];for(var s in h)Object.prototype.hasOwnProperty.call(h,s)&&(a[s]=h[s])}return a};function zh(a,n){for(var h=Object.getOwnPropertyNames(n),s=0;s<h.length;s++){var i=h[s],r=Object.getOwnPropertyDescriptor(n,i);r&&r.configurable&&a[i]===void 0&&Object.defineProperty(a,i,r)}return a}function Ih(a,n){var h={};for(var s in a)n.indexOf(s)>=0||Object.prototype.hasOwnProperty.call(a,s)&&(h[s]=a[s]);return h}function zi(a,n){if(!(a instanceof n))throw new TypeError("Cannot call a class as a function")}function Ii(a,n){if(!a)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return n&&(typeof n=="object"||typeof n=="function")?n:a}function Ri(a,n){if(typeof n!="function"&&n!==null)throw new TypeError("Super expression must either be null or a function, not "+typeof n);a.prototype=Object.create(n&&n.prototype,{constructor:{value:a,enumerable:!1,writable:!0,configurable:!0}}),n&&(Object.setPrototypeOf?Object.setPrototypeOf(a,n):zh(a,n))}var qn=function(a){Ri(n,a);function n(){return zi(this,n),Ii(this,a.apply(this,arguments))}return n.prototype.componentDidUpdate=function(s){var i=s.checked;this.props.leaflet.map!=null&&(this.props.checked===!0&&(i==null||i===!1)?this.props.leaflet.map.addLayer(this.layer):i===!0&&(this.props.checked==null||this.props.checked===!1)&&this.props.leaflet.map.removeLayer(this.layer))},n.prototype.componentWillUnmount=function(){this.props.removeLayerControl(this.layer)},n.prototype.addLayer=function(){throw new Error("Must be implemented in extending class")},n.prototype.removeLayer=function(s){this.props.removeLayer(s)},n.prototype.render=function(){var s=this.props.children;return s?wt.createElement(Ce,{value:this.contextValue},s):null},n}(w.Component),Rh=function(a){Ri(n,a);function n(h){zi(this,n);var s=Ii(this,a.call(this,h));return s.addLayer=function(i){s.layer=i;var r=s.props,d=r.addBaseLayer,p=r.checked,_=r.name;d(i,_,p)},s.contextValue=Tr({},h.leaflet,{layerContainer:{addLayer:s.addLayer.bind(s),removeLayer:s.removeLayer.bind(s)}}),s}return n}(qn),Ah=function(a){Ri(n,a);function n(h){zi(this,n);var s=Ii(this,a.call(this,h));return s.addLayer=function(i){s.layer=i;var r=s.props,d=r.addOverlay,p=r.checked,_=r.name;d(i,_,p)},s.contextValue=Tr({},h.leaflet,{layerContainer:{addLayer:s.addLayer.bind(s),removeLayer:s.removeLayer.bind(s)}}),s}return n}(qn),Yn=function(a){Ri(n,a);function n(h){zi(this,n);var s=Ii(this,a.call(this,h));return s.controlProps={addBaseLayer:s.addBaseLayer.bind(s),addOverlay:s.addOverlay.bind(s),leaflet:h.leaflet,removeLayer:s.removeLayer.bind(s),removeLayerControl:s.removeLayerControl.bind(s)},s}return n.prototype.createLeafletElement=function(s){s.children;var i=Ih(s,["children"]);return new rt.Control.Layers(void 0,void 0,i)},n.prototype.updateLeafletElement=function(s,i){a.prototype.updateLeafletElement.call(this,s,i),i.collapsed!==s.collapsed&&(i.collapsed===!0?this.leafletElement.collapse():this.leafletElement.expand())},n.prototype.componentWillUnmount=function(){var s=this;setTimeout(function(){a.prototype.componentWillUnmount.call(s)},0)},n.prototype.addBaseLayer=function(s,i){var r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1;r&&this.props.leaflet.map!=null&&this.props.leaflet.map.addLayer(s),this.leafletElement.addBaseLayer(s,i)},n.prototype.addOverlay=function(s,i){var r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1;r&&this.props.leaflet.map!=null&&this.props.leaflet.map.addLayer(s),this.leafletElement.addOverlay(s,i)},n.prototype.removeLayer=function(s){this.props.leaflet.map!=null&&this.props.leaflet.map.removeLayer(s)},n.prototype.removeLayerControl=function(s){this.leafletElement.removeLayer(s)},n.prototype.render=function(){var s=this,i=w.Children.map(this.props.children,function(r){return r?w.cloneElement(r,s.controlProps):null});return wt.createElement(w.Fragment,null,i)},n}(De);Yn.BaseLayer=Rh;Yn.Overlay=Ah;const Bh=dt(Yn);function Zh(a){return ns(a)?void 0:a}var $h=1,Uh=2,Fh=4,Rn=wr(function(a,n){var h={};if(a==null)return h;var s=!1;n=os(n,function(r){return r=mr(r,a),s||(s=r.length>1),r}),rs(a,as(a),h),s&&(h=ls(h,$h|Uh|Fh,Zh));for(var i=n.length;i--;)ss(h,n[i]);return h});function Hh(a,n){for(var h=Object.getOwnPropertyNames(n),s=0;s<h.length;s++){var i=h[s],r=Object.getOwnPropertyDescriptor(n,i);r&&r.configurable&&a[i]===void 0&&Object.defineProperty(a,i,r)}return a}function Gh(a,n){var h={};for(var s in a)n.indexOf(s)>=0||Object.prototype.hasOwnProperty.call(a,s)&&(h[s]=a[s]);return h}function Wh(a,n){if(!(a instanceof n))throw new TypeError("Cannot call a class as a function")}function ir(a,n){if(!a)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return n&&(typeof n=="object"||typeof n=="function")?n:a}function Vh(a,n){if(typeof n!="function"&&n!==null)throw new TypeError("Super expression must either be null or a function, not "+typeof n);a.prototype=Object.create(n&&n.prototype,{constructor:{value:a,enumerable:!1,writable:!0,configurable:!0}}),n&&(Object.setPrototypeOf?Object.setPrototypeOf(a,n):Hh(a,n))}var qh=["children","className","id","style","useFlyTo","whenReady"],nr=function(n){return Array.isArray(n)?[n[0],n[1]]:[n.lat,n.lon?n.lon:n.lng]},Or=function(a){Vh(n,a);function n(){var h,s,i;Wh(this,n);for(var r=arguments.length,d=Array(r),p=0;p<r;p++)d[p]=arguments[p];return i=(h=(s=ir(this,a.call.apply(a,[this].concat(d))),s),s.viewport={center:void 0,zoom:void 0},s._updating=!1,s.onViewportChange=function(){var _=s.leafletElement.getCenter();s.viewport={center:_?[_.lat,_.lng]:void 0,zoom:s.leafletElement.getZoom()},s.props.onViewportChange&&!s._updating&&s.props.onViewportChange(s.viewport)},s.onViewportChanged=function(){s.props.onViewportChanged&&!s._updating&&s.props.onViewportChanged(s.viewport)},s.bindContainer=function(_){s.container=_},h),ir(s,i)}return n.prototype.createLeafletElement=function(s){var i=s.viewport,r=Gh(s,["viewport"]);return i&&(i.center&&(r.center=i.center),typeof i.zoom=="number"&&(r.zoom=i.zoom)),new rt.Map(this.container,r)},n.prototype.updateLeafletElement=function(s,i){this._updating=!0;var r=i.animate,d=i.bounds,p=i.boundsOptions,_=i.boxZoom,g=i.center,b=i.className,T=i.doubleClickZoom,O=i.dragging,H=i.keyboard,M=i.maxBounds,G=i.scrollWheelZoom,v=i.tap,Z=i.touchZoom,D=i.useFlyTo,z=i.viewport,k=i.zoom;if(Er(this.container,s.className,b),z&&z!==s.viewport){var j=z.center?z.center:g,P=z.zoom==null?k:z.zoom;D===!0?this.leafletElement.flyTo(j,P,{animate:r}):this.leafletElement.setView(j,P,{animate:r})}else g&&this.shouldUpdateCenter(g,s.center)?D===!0?this.leafletElement.flyTo(g,k,{animate:r}):this.leafletElement.setView(g,k,{animate:r}):typeof k=="number"&&k!==s.zoom&&(s.zoom==null?this.leafletElement.setView(g,k):this.leafletElement.setZoom(k));M&&this.shouldUpdateBounds(M,s.maxBounds)&&this.leafletElement.setMaxBounds(M),d&&(this.shouldUpdateBounds(d,s.bounds)||p!==s.boundsOptions)&&(D===!0?this.leafletElement.flyToBounds(d,p):this.leafletElement.fitBounds(d,p)),_!==s.boxZoom&&(_===!0?this.leafletElement.boxZoom.enable():this.leafletElement.boxZoom.disable()),T!==s.doubleClickZoom&&(T===!0?this.leafletElement.doubleClickZoom.enable():this.leafletElement.doubleClickZoom.disable()),O!==s.dragging&&(O===!0?this.leafletElement.dragging.enable():this.leafletElement.dragging.disable()),H!==s.keyboard&&(H===!0?this.leafletElement.keyboard.enable():this.leafletElement.keyboard.disable()),G!==s.scrollWheelZoom&&(G===!0||typeof G=="string"?(this.leafletElement.options.scrollWheelZoom=G,this.leafletElement.scrollWheelZoom.enable()):this.leafletElement.scrollWheelZoom.disable()),v!==s.tap&&(v===!0?this.leafletElement.tap.enable():this.leafletElement.tap.disable()),Z!==s.touchZoom&&(Z===!0||typeof Z=="string"?(this.leafletElement.options.touchZoom=Z,this.leafletElement.touchZoom.enable()):this.leafletElement.touchZoom.disable()),this._updating=!1},n.prototype.componentDidMount=function(){var s=Rn(this.props,qh);this.leafletElement=this.createLeafletElement(s),this.leafletElement.on("move",this.onViewportChange),this.leafletElement.on("moveend",this.onViewportChanged),s.bounds!=null&&this.leafletElement.fitBounds(s.bounds,s.boundsOptions),this.props.whenReady&&this.leafletElement.whenReady(this.props.whenReady),this.contextValue={layerContainer:this.leafletElement,map:this.leafletElement},a.prototype.componentDidMount.call(this),this.forceUpdate()},n.prototype.componentDidUpdate=function(s){this.updateLeafletElement(s,this.props)},n.prototype.componentWillUnmount=function(){a.prototype.componentWillUnmount.call(this),this.leafletElement.off("move",this.onViewportChange),this.leafletElement.off("moveend",this.onViewportChanged),this.props.preferCanvas===!0?(this.leafletElement._initEvents(!0),this.leafletElement._stop()):this.leafletElement.remove()},n.prototype.shouldUpdateCenter=function(s,i){return i?(s=nr(s),i=nr(i),s[0]!==i[0]||s[1]!==i[1]):!0},n.prototype.shouldUpdateBounds=function(s,i){return i?!rt.latLngBounds(s).equals(rt.latLngBounds(i)):!0},n.prototype.render=function(){return wt.createElement("div",{className:this.props.className,id:this.props.id,ref:this.bindContainer,style:this.props.style},this.contextValue?wt.createElement(Ce,{value:this.contextValue},this.props.children):null)},n}(Di),Yh=Object.assign||function(a){for(var n=1;n<arguments.length;n++){var h=arguments[n];for(var s in h)Object.prototype.hasOwnProperty.call(h,s)&&(a[s]=h[s])}return a};function Kh(a,n){for(var h=Object.getOwnPropertyNames(n),s=0;s<h.length;s++){var i=h[s],r=Object.getOwnPropertyDescriptor(n,i);r&&r.configurable&&a[i]===void 0&&Object.defineProperty(a,i,r)}return a}function Jh(a,n){if(!(a instanceof n))throw new TypeError("Cannot call a class as a function")}function Xh(a,n){if(!a)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return n&&(typeof n=="object"||typeof n=="function")?n:a}function Qh(a,n){if(typeof n!="function"&&n!==null)throw new TypeError("Super expression must either be null or a function, not "+typeof n);a.prototype=Object.create(n&&n.prototype,{constructor:{value:a,enumerable:!1,writable:!0,configurable:!0}}),n&&(Object.setPrototypeOf?Object.setPrototypeOf(a,n):Kh(a,n))}var tc=function(a){Qh(n,a);function n(){return Jh(this,n),Xh(this,a.apply(this,arguments))}return n.prototype.createLeafletElement=function(s){var i=new rt.Marker(s.position,this.getOptions(s));return this.contextValue=Yh({},s.leaflet,{popupContainer:i}),i},n.prototype.updateLeafletElement=function(s,i){i.position!==s.position&&this.leafletElement.setLatLng(i.position),i.icon!==s.icon&&this.leafletElement.setIcon(i.icon),i.zIndexOffset!==s.zIndexOffset&&this.leafletElement.setZIndexOffset(i.zIndexOffset),i.opacity!==s.opacity&&this.leafletElement.setOpacity(i.opacity),i.draggable!==s.draggable&&(i.draggable===!0?this.leafletElement.dragging.enable():this.leafletElement.dragging.disable())},n.prototype.render=function(){var s=this.props.children;return s==null||this.contextValue==null?null:wt.createElement(Ce,{value:this.contextValue},s)},n}(de);const ec=dt(tc);var ic=0;function nc(a){var n=++ic;return hs(a)+n}var oc=Object.assign||function(a){for(var n=1;n<arguments.length;n++){var h=arguments[n];for(var s in h)Object.prototype.hasOwnProperty.call(h,s)&&(a[s]=h[s])}return a};function rc(a,n){for(var h=Object.getOwnPropertyNames(n),s=0;s<h.length;s++){var i=h[s],r=Object.getOwnPropertyDescriptor(n,i);r&&r.configurable&&a[i]===void 0&&Object.defineProperty(a,i,r)}return a}function ac(a,n){if(!(a instanceof n))throw new TypeError("Cannot call a class as a function")}function or(a,n){if(!a)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return n&&(typeof n=="object"||typeof n=="function")?n:a}function sc(a,n){if(typeof n!="function"&&n!==null)throw new TypeError("Super expression must either be null or a function, not "+typeof n);a.prototype=Object.create(n&&n.prototype,{constructor:{value:a,enumerable:!1,writable:!0,configurable:!0}}),n&&(Object.setPrototypeOf?Object.setPrototypeOf(a,n):rc(a,n))}var lc=["tile","shadow","overlay","map","marker","tooltip","popup"],hc=/-*pane/gi,cc=function(n){return lc.indexOf(n.replace(hc,""))!==-1},uc={position:"absolute",top:0,right:0,bottom:0,left:0},dc=function(a){sc(n,a);function n(){var h,s,i;ac(this,n);for(var r=arguments.length,d=Array(r),p=0;p<r;p++)d[p]=arguments[p];return i=(h=(s=or(this,a.call.apply(a,[this].concat(d))),s),s.state={name:void 0,context:void 0},s.setStyle=function(){var _=arguments.length>0&&arguments[0]!==void 0?arguments[0]:s.props,g=_.style,b=_.className,T=s.getPane(s.state.name);T&&(b&&T.classList.add(b),g&&Pi(g,function(O,H){T.style[H]=O}))},h),or(s,i)}return n.prototype.componentDidMount=function(){this.createPane(this.props)},n.prototype.componentDidUpdate=function(s){if(this.state.name)if(this.props.name!==s.name)this.removePane(),this.createPane(this.props);else{if(s.className&&this.props.className!==s.className){var i=this.getPane();i!=null&&s.className!=null&&i.classList.remove(s.className)}this.setStyle(this.props)}},n.prototype.componentWillUnmount=function(){this.removePane()},n.prototype.createPane=function(s){var i=s.leaflet.map,r=s.name||"pane-"+nc();if(i!=null&&i.createPane!=null){var d=cc(r),p=d||this.getPane(r);p==null&&i.createPane(r,this.getParentPane()),this.setState({name:r,context:oc({},s.leaflet,{pane:r})},this.setStyle)}},n.prototype.removePane=function(){var s=this.state.name;if(s!=null){var i=this.getPane(s);i!=null&&i.remove&&i.remove();var r=this.props.leaflet.map;r!=null&&r._panes!=null&&(r._panes=Rn(r._panes,s),r._paneRenderers=Rn(r._paneRenderers,s))}},n.prototype.getParentPane=function(){return this.getPane(this.props.pane||this.props.leaflet.pane)},n.prototype.getPane=function(s){if(s!=null&&this.props.leaflet.map!=null)return this.props.leaflet.map.getPane(s)},n.prototype.render=function(){var s=this.state.context;return s?wt.createElement(Ce,{value:s},wt.createElement("div",{style:uc},this.props.children)):null},n}(w.Component);const fc=dt(dc);function pc(a,n){for(var h=Object.getOwnPropertyNames(n),s=0;s<h.length;s++){var i=h[s],r=Object.getOwnPropertyDescriptor(n,i);r&&r.configurable&&a[i]===void 0&&Object.defineProperty(a,i,r)}return a}function mc(a,n){if(!(a instanceof n))throw new TypeError("Cannot call a class as a function")}function _c(a,n){if(!a)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return n&&(typeof n=="object"||typeof n=="function")?n:a}function gc(a,n){if(typeof n!="function"&&n!==null)throw new TypeError("Super expression must either be null or a function, not "+typeof n);a.prototype=Object.create(n&&n.prototype,{constructor:{value:a,enumerable:!1,writable:!0,configurable:!0}}),n&&(Object.setPrototypeOf?Object.setPrototypeOf(a,n):pc(a,n))}var vc=function(a){gc(n,a);function n(){return mc(this,n),_c(this,a.apply(this,arguments))}return n.prototype.createLeafletElement=function(s){return new rt.Polygon(s.positions,this.getOptions(s))},n.prototype.updateLeafletElement=function(s,i){i.positions!==s.positions&&this.leafletElement.setLatLngs(i.positions),this.setStyleIfChanged(s,i)},n}(ie);const yc=dt(vc);function Lc(a,n){for(var h=Object.getOwnPropertyNames(n),s=0;s<h.length;s++){var i=h[s],r=Object.getOwnPropertyDescriptor(n,i);r&&r.configurable&&a[i]===void 0&&Object.defineProperty(a,i,r)}return a}function xc(a,n){if(!(a instanceof n))throw new TypeError("Cannot call a class as a function")}function bc(a,n){if(!a)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return n&&(typeof n=="object"||typeof n=="function")?n:a}function wc(a,n){if(typeof n!="function"&&n!==null)throw new TypeError("Super expression must either be null or a function, not "+typeof n);a.prototype=Object.create(n&&n.prototype,{constructor:{value:a,enumerable:!1,writable:!0,configurable:!0}}),n&&(Object.setPrototypeOf?Object.setPrototypeOf(a,n):Lc(a,n))}var Ec=function(a){wc(n,a);function n(){return xc(this,n),bc(this,a.apply(this,arguments))}return n.prototype.createLeafletElement=function(s){return new rt.Polyline(s.positions,this.getOptions(s))},n.prototype.updateLeafletElement=function(s,i){i.positions!==s.positions&&this.leafletElement.setLatLngs(i.positions),this.setStyleIfChanged(s,i)},n}(ie);const Pc=dt(Ec);var Tc=Object.assign||function(a){for(var n=1;n<arguments.length;n++){var h=arguments[n];for(var s in h)Object.prototype.hasOwnProperty.call(h,s)&&(a[s]=h[s])}return a};function Oc(a,n){for(var h=Object.getOwnPropertyNames(n),s=0;s<h.length;s++){var i=h[s],r=Object.getOwnPropertyDescriptor(n,i);r&&r.configurable&&a[i]===void 0&&Object.defineProperty(a,i,r)}return a}function kc(a,n){if(!(a instanceof n))throw new TypeError("Cannot call a class as a function")}function rr(a,n){if(!a)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return n&&(typeof n=="object"||typeof n=="function")?n:a}function Mc(a,n){if(typeof n!="function"&&n!==null)throw new TypeError("Super expression must either be null or a function, not "+typeof n);a.prototype=Object.create(n&&n.prototype,{constructor:{value:a,enumerable:!1,writable:!0,configurable:!0}}),n&&(Object.setPrototypeOf?Object.setPrototypeOf(a,n):Oc(a,n))}var kr=function(a){Mc(n,a);function n(){var h,s,i;kc(this,n);for(var r=arguments.length,d=Array(r),p=0;p<r;p++)d[p]=arguments[p];return i=(h=(s=rr(this,a.call.apply(a,[this].concat(d))),s),s.onPopupOpen=function(_){var g=_.popup;g===s.leafletElement&&s.onOpen()},s.onPopupClose=function(_){var g=_.popup;g===s.leafletElement&&s.onClose()},s.onRender=function(){s.props.autoPan!==!1&&s.leafletElement.isOpen()&&(s.leafletElement._map&&s.leafletElement._map._panAnim&&(s.leafletElement._map._panAnim=void 0),s.leafletElement._adjustPan())},h),rr(s,i)}return n.prototype.getOptions=function(s){return Tc({},a.prototype.getOptions.call(this,s),{autoPan:!1})},n.prototype.createLeafletElement=function(s){var i=this.getOptions(s);return i.autoPan=s.autoPan!==!1,new rt.Popup(i,s.leaflet.popupContainer)},n.prototype.updateLeafletElement=function(s,i){i.position!==s.position&&this.leafletElement.setLatLng(i.position)},n.prototype.componentDidMount=function(){var s=this.props.position,i=this.props.leaflet,r=i.map,d=i.popupContainer,p=this.leafletElement;r!=null&&r.on({popupopen:this.onPopupOpen,popupclose:this.onPopupClose}),d?d.bindPopup(p):(s&&p.setLatLng(s),p.openOn(r))},n.prototype.componentWillUnmount=function(){var s=this.props.leaflet.map;s!=null&&(s.off({popupopen:this.onPopupOpen,popupclose:this.onPopupClose}),s.removeLayer(this.leafletElement)),a.prototype.componentWillUnmount.call(this)},n}(Vn);kr.defaultProps={pane:"popupPane"};const jc=dt(kr);function Sc(a,n){for(var h=Object.getOwnPropertyNames(n),s=0;s<h.length;s++){var i=h[s],r=Object.getOwnPropertyDescriptor(n,i);r&&r.configurable&&a[i]===void 0&&Object.defineProperty(a,i,r)}return a}function Cc(a,n){if(!(a instanceof n))throw new TypeError("Cannot call a class as a function")}function Dc(a,n){if(!a)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return n&&(typeof n=="object"||typeof n=="function")?n:a}function Nc(a,n){if(typeof n!="function"&&n!==null)throw new TypeError("Super expression must either be null or a function, not "+typeof n);a.prototype=Object.create(n&&n.prototype,{constructor:{value:a,enumerable:!1,writable:!0,configurable:!0}}),n&&(Object.setPrototypeOf?Object.setPrototypeOf(a,n):Sc(a,n))}var zc=function(a){Nc(n,a);function n(){return Cc(this,n),Dc(this,a.apply(this,arguments))}return n.prototype.createLeafletElement=function(s){return new rt.Rectangle(s.bounds,this.getOptions(s))},n.prototype.updateLeafletElement=function(s,i){i.bounds!==s.bounds&&this.leafletElement.setBounds(i.bounds),this.setStyleIfChanged(s,i)},n}(ie);const Ic=dt(zc);function Rc(a,n){for(var h=Object.getOwnPropertyNames(n),s=0;s<h.length;s++){var i=h[s],r=Object.getOwnPropertyDescriptor(n,i);r&&r.configurable&&a[i]===void 0&&Object.defineProperty(a,i,r)}return a}function Ac(a,n){if(!(a instanceof n))throw new TypeError("Cannot call a class as a function")}function Bc(a,n){if(!a)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return n&&(typeof n=="object"||typeof n=="function")?n:a}function Zc(a,n){if(typeof n!="function"&&n!==null)throw new TypeError("Super expression must either be null or a function, not "+typeof n);a.prototype=Object.create(n&&n.prototype,{constructor:{value:a,enumerable:!1,writable:!0,configurable:!0}}),n&&(Object.setPrototypeOf?Object.setPrototypeOf(a,n):Rc(a,n))}var $c=function(a){Zc(n,a);function n(){return Ac(this,n),Bc(this,a.apply(this,arguments))}return n.prototype.createLeafletElement=function(s){return new rt.Control.Scale(s)},n}(De);const Uc=dt($c);function Fc(a,n){for(var h=Object.getOwnPropertyNames(n),s=0;s<h.length;s++){var i=h[s],r=Object.getOwnPropertyDescriptor(n,i);r&&r.configurable&&a[i]===void 0&&Object.defineProperty(a,i,r)}return a}function Hc(a,n){if(!(a instanceof n))throw new TypeError("Cannot call a class as a function")}function Gc(a,n){if(!a)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return n&&(typeof n=="object"||typeof n=="function")?n:a}function Wc(a,n){if(typeof n!="function"&&n!==null)throw new TypeError("Super expression must either be null or a function, not "+typeof n);a.prototype=Object.create(n&&n.prototype,{constructor:{value:a,enumerable:!1,writable:!0,configurable:!0}}),n&&(Object.setPrototypeOf?Object.setPrototypeOf(a,n):Fc(a,n))}var Vc=function(a){Wc(n,a);function n(){return Hc(this,n),Gc(this,a.apply(this,arguments))}return n.prototype.createLeafletElement=function(s){return new rt.TileLayer(s.url,this.getOptions(s))},n.prototype.updateLeafletElement=function(s,i){a.prototype.updateLeafletElement.call(this,s,i),i.url!==s.url&&this.leafletElement.setUrl(i.url)},n}(Ni);const Mr=dt(Vc);function qc(a,n){for(var h=Object.getOwnPropertyNames(n),s=0;s<h.length;s++){var i=h[s],r=Object.getOwnPropertyDescriptor(n,i);r&&r.configurable&&a[i]===void 0&&Object.defineProperty(a,i,r)}return a}function Yc(a,n){if(!(a instanceof n))throw new TypeError("Cannot call a class as a function")}function ar(a,n){if(!a)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return n&&(typeof n=="object"||typeof n=="function")?n:a}function Kc(a,n){if(typeof n!="function"&&n!==null)throw new TypeError("Super expression must either be null or a function, not "+typeof n);a.prototype=Object.create(n&&n.prototype,{constructor:{value:a,enumerable:!1,writable:!0,configurable:!0}}),n&&(Object.setPrototypeOf?Object.setPrototypeOf(a,n):qc(a,n))}var jr=function(a){Kc(n,a);function n(){var h,s,i;Yc(this,n);for(var r=arguments.length,d=Array(r),p=0;p<r;p++)d[p]=arguments[p];return i=(h=(s=ar(this,a.call.apply(a,[this].concat(d))),s),s.onTooltipOpen=function(_){var g=_.tooltip;g===s.leafletElement&&s.onOpen()},s.onTooltipClose=function(_){var g=_.tooltip;g===s.leafletElement&&s.onClose()},h),ar(s,i)}return n.prototype.createLeafletElement=function(s){return new rt.Tooltip(this.getOptions(s),s.leaflet.popupContainer)},n.prototype.componentDidMount=function(){var s=this.props.leaflet.popupContainer;s!=null&&(s.on({tooltipopen:this.onTooltipOpen,tooltipclose:this.onTooltipClose}),s.bindTooltip(this.leafletElement))},n.prototype.componentWillUnmount=function(){var s=this.props.leaflet.popupContainer;s!=null&&(s.off({tooltipopen:this.onTooltipOpen,tooltipclose:this.onTooltipClose}),s._map!=null&&s.unbindTooltip(this.leafletElement))},n}(Vn);jr.defaultProps={pane:"tooltipPane"};const Jc=dt(jr);function Xc(a,n){for(var h=Object.getOwnPropertyNames(n),s=0;s<h.length;s++){var i=h[s],r=Object.getOwnPropertyDescriptor(n,i);r&&r.configurable&&a[i]===void 0&&Object.defineProperty(a,i,r)}return a}function Qc(a,n){if(!(a instanceof n))throw new TypeError("Cannot call a class as a function")}function tu(a,n){if(!a)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return n&&(typeof n=="object"||typeof n=="function")?n:a}function eu(a,n){if(typeof n!="function"&&n!==null)throw new TypeError("Super expression must either be null or a function, not "+typeof n);a.prototype=Object.create(n&&n.prototype,{constructor:{value:a,enumerable:!1,writable:!0,configurable:!0}}),n&&(Object.setPrototypeOf?Object.setPrototypeOf(a,n):Xc(a,n))}var iu=function(a){eu(n,a);function n(){return Qc(this,n),tu(this,a.apply(this,arguments))}return n.prototype.createLeafletElement=function(s){return new rt.VideoOverlay(s.url,s.bounds,this.getOptions(s))},n.prototype.componentDidMount=function(){a.prototype.componentDidMount.call(this),this.props.play===!0&&this.leafletElement.getElement().play()},n.prototype.updateLeafletElement=function(s,i){i.url!==s.url&&this.leafletElement.setUrl(i.url),i.bounds!==s.bounds&&this.leafletElement.setBounds(rt.latLngBounds(i.bounds)),i.opacity!==s.opacity&&this.leafletElement.setOpacity(i.opacity),i.zIndex!==s.zIndex&&this.leafletElement.setZIndex(i.zIndex),i.play===!0&&!s.play?this.leafletElement.getElement().play():!i.play&&s.play===!0&&this.leafletElement.getElement().pause()},n}(de);const nu=dt(iu);function ou(a,n,h,s,i){return i(a,function(r,d,p){h=s?(s=!1,r):n(h,r,d,p)}),h}function ru(a,n,h){var s=Gn(a)?us:ou,i=arguments.length<3;return s(a,cs(n),h,i,_r)}function au(a,n){for(var h=Object.getOwnPropertyNames(n),s=0;s<h.length;s++){var i=h[s],r=Object.getOwnPropertyDescriptor(n,i);r&&r.configurable&&a[i]===void 0&&Object.defineProperty(a,i,r)}return a}function Cn(a,n){var h={};for(var s in a)n.indexOf(s)>=0||Object.prototype.hasOwnProperty.call(a,s)&&(h[s]=a[s]);return h}function su(a,n){if(!(a instanceof n))throw new TypeError("Cannot call a class as a function")}function lu(a,n){if(!a)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return n&&(typeof n=="object"||typeof n=="function")?n:a}function hu(a,n){if(typeof n!="function"&&n!==null)throw new TypeError("Super expression must either be null or a function, not "+typeof n);a.prototype=Object.create(n&&n.prototype,{constructor:{value:a,enumerable:!1,writable:!0,configurable:!0}}),n&&(Object.setPrototypeOf?Object.setPrototypeOf(a,n):au(a,n))}var cu=function(a){hu(n,a);function n(){return su(this,n),lu(this,a.apply(this,arguments))}return n.prototype.createLeafletElement=function(s){var i=s.url,r=Cn(s,["url"]);return new rt.TileLayer.WMS(i,this.getOptions(r))},n.prototype.updateLeafletElement=function(s,i){a.prototype.updateLeafletElement.call(this,s,i);var r=s.url;s.opacity,s.zIndex;var d=Cn(s,["url","opacity","zIndex"]),p=i.url;i.opacity,i.zIndex;var _=Cn(i,["url","opacity","zIndex"]);p!==r&&this.leafletElement.setUrl(p),Wn(_,d)||this.leafletElement.setParams(_)},n.prototype.getOptions=function(s){return ru(a.prototype.getOptions.call(this,s),function(i,r,d){return In.test(d)||(i[d]=r),i},{})},n}(Ni);const uu=dt(cu);function du(a,n){for(var h=Object.getOwnPropertyNames(n),s=0;s<h.length;s++){var i=h[s],r=Object.getOwnPropertyDescriptor(n,i);r&&r.configurable&&a[i]===void 0&&Object.defineProperty(a,i,r)}return a}function fu(a,n){if(!(a instanceof n))throw new TypeError("Cannot call a class as a function")}function pu(a,n){if(!a)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return n&&(typeof n=="object"||typeof n=="function")?n:a}function mu(a,n){if(typeof n!="function"&&n!==null)throw new TypeError("Super expression must either be null or a function, not "+typeof n);a.prototype=Object.create(n&&n.prototype,{constructor:{value:a,enumerable:!1,writable:!0,configurable:!0}}),n&&(Object.setPrototypeOf?Object.setPrototypeOf(a,n):du(a,n))}var _u=function(a){mu(n,a);function n(){return fu(this,n),pu(this,a.apply(this,arguments))}return n.prototype.createLeafletElement=function(s){return new rt.Control.Zoom(s)},n}(De);const gu=dt(_u),vu=Object.freeze(Object.defineProperty({__proto__:null,AttributionControl:_l,Circle:Gl,CircleMarker:Xl,ControlledLayer:qn,DivOverlay:Vn,FeatureGroup:Pr,GeoJSON:mh,GridLayer:Ni,ImageOverlay:Oh,LayerGroup:Nh,LayersControl:Bh,LeafletConsumer:al,LeafletProvider:Ce,Map:Or,MapComponent:Di,MapControl:De,MapLayer:de,Marker:ec,Pane:fc,Path:ie,Polygon:yc,Polyline:Pc,Popup:jc,Rectangle:Ic,ScaleControl:Uc,TileLayer:Mr,Tooltip:Jc,VideoOverlay:nu,WMSTileLayer:uu,ZoomControl:gu,withLeaflet:dt},Symbol.toStringTag,{value:"Module"}));var Sr={};const yu=Fa(vu);Object.defineProperty(Sr,"__esModule",{value:!0});var Lu=function(){function a(n,h){for(var s=0;s<h.length;s++){var i=h[s];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(n,i.key,i)}}return function(n,h,s){return h&&a(n.prototype,h),s&&a(n,s),n}}(),xu=function a(n,h,s){n===null&&(n=Function.prototype);var i=Object.getOwnPropertyDescriptor(n,h);if(i===void 0){var r=Object.getPrototypeOf(n);return r===null?void 0:a(r,h,s)}else{if("value"in i)return i.value;var d=i.get;return d===void 0?void 0:d.call(s)}},bu=fr,wu=Eu(bu),sr=yu,Dn=rt;function Eu(a){return a&&a.__esModule?a:{default:a}}function Pu(a,n){if(!(a instanceof n))throw new TypeError("Cannot call a class as a function")}function Tu(a,n){if(!a)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return n&&(typeof n=="object"||typeof n=="function")?n:a}function Ou(a,n){if(typeof n!="function"&&n!==null)throw new TypeError("Super expression must either be null or a function, not "+typeof n);a.prototype=Object.create(n&&n.prototype,{constructor:{value:a,enumerable:!1,writable:!0,configurable:!0}}),n&&(Object.setPrototypeOf?Object.setPrototypeOf(a,n):a.__proto__=n)}var ku=Dn.Control.extend({options:{className:"",onOff:"",handleOff:function(){}},onAdd:function(){var n=Dn.DomUtil.create("div",this.options.className);return Dn.DomEvent.disableClickPropagation(n),n},onRemove:function(n){return this.options.onOff&&n.off(this.options.onOff,this.options.handleOff,this),this}}),Je=Sr.default=(0,sr.withLeaflet)(function(a){Ou(n,a);function n(){return Pu(this,n),Tu(this,(n.__proto__||Object.getPrototypeOf(n)).apply(this,arguments))}return Lu(n,[{key:"createLeafletElement",value:function(s){return new ku(Object.assign({},s))}},{key:"componentDidMount",value:function(){xu(n.prototype.__proto__||Object.getPrototypeOf(n.prototype),"componentDidMount",this).call(this),this.forceUpdate()}},{key:"render",value:function(){return!this.leafletElement||!this.leafletElement.getContainer()?null:wu.default.createPortal(this.props.children,this.leafletElement.getContainer())}}]),n}(sr.MapControl));(function(a,n,h){function s(i,r){for(;(i=i.parentElement)&&!i.classList.contains(r););return i}L.drawVersion="1.0.4",L.Draw={},L.drawLocal={draw:{toolbar:{actions:{title:"Cancel drawing",text:"Cancel"},finish:{title:"Finish drawing",text:"Finish"},undo:{title:"Delete last point drawn",text:"Delete last point"},buttons:{polyline:"Draw a polyline",polygon:"Draw a polygon",rectangle:"Draw a rectangle",circle:"Draw a circle",marker:"Draw a marker",circlemarker:"Draw a circlemarker"}},handlers:{circle:{tooltip:{start:"Click and drag to draw circle."},radius:"Radius"},circlemarker:{tooltip:{start:"Click map to place circle marker."}},marker:{tooltip:{start:"Click map to place marker."}},polygon:{tooltip:{start:"Click to start drawing shape.",cont:"Click to continue drawing shape.",end:"Click first point to close this shape."}},polyline:{error:"<strong>Error:</strong> shape edges cannot cross!",tooltip:{start:"Click to start drawing line.",cont:"Click to continue drawing line.",end:"Click last point to finish line."}},rectangle:{tooltip:{start:"Click and drag to draw rectangle."}},simpleshape:{tooltip:{end:"Release mouse to finish drawing."}}}},edit:{toolbar:{actions:{save:{title:"Save changes",text:"Save"},cancel:{title:"Cancel editing, discards all changes",text:"Cancel"},clearAll:{title:"Clear all layers",text:"Clear All"}},buttons:{edit:"Edit layers",editDisabled:"No layers to edit",remove:"Delete layers",removeDisabled:"No layers to delete"}},handlers:{edit:{tooltip:{text:"Drag handles or markers to edit features.",subtext:"Click cancel to undo changes."}},remove:{tooltip:{text:"Click on a feature to remove."}}}}},L.Draw.Event={},L.Draw.Event.CREATED="draw:created",L.Draw.Event.EDITED="draw:edited",L.Draw.Event.DELETED="draw:deleted",L.Draw.Event.DRAWSTART="draw:drawstart",L.Draw.Event.DRAWSTOP="draw:drawstop",L.Draw.Event.DRAWVERTEX="draw:drawvertex",L.Draw.Event.EDITSTART="draw:editstart",L.Draw.Event.EDITMOVE="draw:editmove",L.Draw.Event.EDITRESIZE="draw:editresize",L.Draw.Event.EDITVERTEX="draw:editvertex",L.Draw.Event.EDITSTOP="draw:editstop",L.Draw.Event.DELETESTART="draw:deletestart",L.Draw.Event.DELETESTOP="draw:deletestop",L.Draw.Event.TOOLBAROPENED="draw:toolbaropened",L.Draw.Event.TOOLBARCLOSED="draw:toolbarclosed",L.Draw.Event.MARKERCONTEXT="draw:markercontext",L.Draw=L.Draw||{},L.Draw.Feature=L.Handler.extend({initialize:function(i,r){this._map=i,this._container=i._container,this._overlayPane=i._panes.overlayPane,this._popupPane=i._panes.popupPane,r&&r.shapeOptions&&(r.shapeOptions=L.Util.extend({},this.options.shapeOptions,r.shapeOptions)),L.setOptions(this,r);var d=L.version.split(".");parseInt(d[0],10)===1&&parseInt(d[1],10)>=2?L.Draw.Feature.include(L.Evented.prototype):L.Draw.Feature.include(L.Mixin.Events)},enable:function(){this._enabled||(L.Handler.prototype.enable.call(this),this.fire("enabled",{handler:this.type}),this._map.fire(L.Draw.Event.DRAWSTART,{layerType:this.type}))},disable:function(){this._enabled&&(L.Handler.prototype.disable.call(this),this._map.fire(L.Draw.Event.DRAWSTOP,{layerType:this.type}),this.fire("disabled",{handler:this.type}))},addHooks:function(){var i=this._map;i&&(L.DomUtil.disableTextSelection(),i.getContainer().focus(),this._tooltip=new L.Draw.Tooltip(this._map),L.DomEvent.on(this._container,"keyup",this._cancelDrawing,this))},removeHooks:function(){this._map&&(L.DomUtil.enableTextSelection(),this._tooltip.dispose(),this._tooltip=null,L.DomEvent.off(this._container,"keyup",this._cancelDrawing,this))},setOptions:function(i){L.setOptions(this,i)},_fireCreatedEvent:function(i){this._map.fire(L.Draw.Event.CREATED,{layer:i,layerType:this.type})},_cancelDrawing:function(i){i.keyCode===27&&(this._map.fire("draw:canceled",{layerType:this.type}),this.disable())}}),L.Draw.Polyline=L.Draw.Feature.extend({statics:{TYPE:"polyline"},Poly:L.Polyline,options:{allowIntersection:!0,repeatMode:!1,drawError:{color:"#b00b00",timeout:2500},icon:new L.DivIcon({iconSize:new L.Point(8,8),className:"leaflet-div-icon leaflet-editing-icon"}),touchIcon:new L.DivIcon({iconSize:new L.Point(20,20),className:"leaflet-div-icon leaflet-editing-icon leaflet-touch-icon"}),guidelineDistance:20,maxGuideLineLength:4e3,shapeOptions:{stroke:!0,color:"#3388ff",weight:4,opacity:.5,fill:!1,clickable:!0},metric:!0,feet:!0,nautic:!1,showLength:!0,zIndexOffset:2e3,factor:1,maxPoints:0},initialize:function(i,r){L.Browser.touch&&(this.options.icon=this.options.touchIcon),this.options.drawError.message=L.drawLocal.draw.handlers.polyline.error,r&&r.drawError&&(r.drawError=L.Util.extend({},this.options.drawError,r.drawError)),this.type=L.Draw.Polyline.TYPE,L.Draw.Feature.prototype.initialize.call(this,i,r)},addHooks:function(){L.Draw.Feature.prototype.addHooks.call(this),this._map&&(this._markers=[],this._markerGroup=new L.LayerGroup,this._map.addLayer(this._markerGroup),this._poly=new L.Polyline([],this.options.shapeOptions),this._tooltip.updateContent(this._getTooltipText()),this._mouseMarker||(this._mouseMarker=L.marker(this._map.getCenter(),{icon:L.divIcon({className:"leaflet-mouse-marker",iconAnchor:[20,20],iconSize:[40,40]}),opacity:0,zIndexOffset:this.options.zIndexOffset})),this._mouseMarker.on("mouseout",this._onMouseOut,this).on("mousemove",this._onMouseMove,this).on("mousedown",this._onMouseDown,this).on("mouseup",this._onMouseUp,this).addTo(this._map),this._map.on("mouseup",this._onMouseUp,this).on("mousemove",this._onMouseMove,this).on("zoomlevelschange",this._onZoomEnd,this).on("touchstart",this._onTouch,this).on("zoomend",this._onZoomEnd,this))},removeHooks:function(){L.Draw.Feature.prototype.removeHooks.call(this),this._clearHideErrorTimeout(),this._cleanUpShape(),this._map.removeLayer(this._markerGroup),delete this._markerGroup,delete this._markers,this._map.removeLayer(this._poly),delete this._poly,this._mouseMarker.off("mousedown",this._onMouseDown,this).off("mouseout",this._onMouseOut,this).off("mouseup",this._onMouseUp,this).off("mousemove",this._onMouseMove,this),this._map.removeLayer(this._mouseMarker),delete this._mouseMarker,this._clearGuides(),this._map.off("mouseup",this._onMouseUp,this).off("mousemove",this._onMouseMove,this).off("zoomlevelschange",this._onZoomEnd,this).off("zoomend",this._onZoomEnd,this).off("touchstart",this._onTouch,this).off("click",this._onTouch,this)},deleteLastVertex:function(){if(!(this._markers.length<=1)){var i=this._markers.pop(),r=this._poly,d=r.getLatLngs(),p=d.splice(-1,1)[0];this._poly.setLatLngs(d),this._markerGroup.removeLayer(i),r.getLatLngs().length<2&&this._map.removeLayer(r),this._vertexChanged(p,!1)}},addVertex:function(i){if(this._markers.length>=2&&!this.options.allowIntersection&&this._poly.newLatLngIntersects(i))return void this._showErrorTooltip();this._errorShown&&this._hideErrorTooltip(),this._markers.push(this._createMarker(i)),this._poly.addLatLng(i),this._poly.getLatLngs().length===2&&this._map.addLayer(this._poly),this._vertexChanged(i,!0)},completeShape:function(){this._markers.length<=1||!this._shapeIsValid()||(this._fireCreatedEvent(),this.disable(),this.options.repeatMode&&this.enable())},_finishShape:function(){var i=this._poly._defaultShape?this._poly._defaultShape():this._poly.getLatLngs(),r=this._poly.newLatLngIntersects(i[i.length-1]);if(!this.options.allowIntersection&&r||!this._shapeIsValid())return void this._showErrorTooltip();this._fireCreatedEvent(),this.disable(),this.options.repeatMode&&this.enable()},_shapeIsValid:function(){return!0},_onZoomEnd:function(){this._markers!==null&&this._updateGuide()},_onMouseMove:function(i){var r=this._map.mouseEventToLayerPoint(i.originalEvent),d=this._map.layerPointToLatLng(r);this._currentLatLng=d,this._updateTooltip(d),this._updateGuide(r),this._mouseMarker.setLatLng(d),L.DomEvent.preventDefault(i.originalEvent)},_vertexChanged:function(i,r){this._map.fire(L.Draw.Event.DRAWVERTEX,{layers:this._markerGroup}),this._updateFinishHandler(),this._updateRunningMeasure(i,r),this._clearGuides(),this._updateTooltip()},_onMouseDown:function(i){if(!this._clickHandled&&!this._touchHandled&&!this._disableMarkers){this._onMouseMove(i),this._clickHandled=!0,this._disableNewMarkers();var r=i.originalEvent,d=r.clientX,p=r.clientY;this._startPoint.call(this,d,p)}},_startPoint:function(i,r){this._mouseDownOrigin=L.point(i,r)},_onMouseUp:function(i){var r=i.originalEvent,d=r.clientX,p=r.clientY;this._endPoint.call(this,d,p,i),this._clickHandled=null},_endPoint:function(i,r,d){if(this._mouseDownOrigin){var p=L.point(i,r).distanceTo(this._mouseDownOrigin),_=this._calculateFinishDistance(d.latlng);this.options.maxPoints>1&&this.options.maxPoints==this._markers.length+1?(this.addVertex(d.latlng),this._finishShape()):_<10&&L.Browser.touch?this._finishShape():Math.abs(p)<9*(a.devicePixelRatio||1)&&this.addVertex(d.latlng),this._enableNewMarkers()}this._mouseDownOrigin=null},_onTouch:function(i){var r,d,p=i.originalEvent;!p.touches||!p.touches[0]||this._clickHandled||this._touchHandled||this._disableMarkers||(r=p.touches[0].clientX,d=p.touches[0].clientY,this._disableNewMarkers(),this._touchHandled=!0,this._startPoint.call(this,r,d),this._endPoint.call(this,r,d,i),this._touchHandled=null),this._clickHandled=null},_onMouseOut:function(){this._tooltip&&this._tooltip._onMouseOut.call(this._tooltip)},_calculateFinishDistance:function(i){var r;if(this._markers.length>0){var d;if(this.type===L.Draw.Polyline.TYPE)d=this._markers[this._markers.length-1];else{if(this.type!==L.Draw.Polygon.TYPE)return 1/0;d=this._markers[0]}var p=this._map.latLngToContainerPoint(d.getLatLng()),_=new L.Marker(i,{icon:this.options.icon,zIndexOffset:2*this.options.zIndexOffset}),g=this._map.latLngToContainerPoint(_.getLatLng());r=p.distanceTo(g)}else r=1/0;return r},_updateFinishHandler:function(){var i=this._markers.length;i>1&&this._markers[i-1].on("click",this._finishShape,this),i>2&&this._markers[i-2].off("click",this._finishShape,this)},_createMarker:function(i){var r=new L.Marker(i,{icon:this.options.icon,zIndexOffset:2*this.options.zIndexOffset});return this._markerGroup.addLayer(r),r},_updateGuide:function(i){var r=this._markers?this._markers.length:0;r>0&&(i=i||this._map.latLngToLayerPoint(this._currentLatLng),this._clearGuides(),this._drawGuide(this._map.latLngToLayerPoint(this._markers[r-1].getLatLng()),i))},_updateTooltip:function(i){var r=this._getTooltipText();i&&this._tooltip.updatePosition(i),this._errorShown||this._tooltip.updateContent(r)},_drawGuide:function(i,r){var d,p,_,g=Math.floor(Math.sqrt(Math.pow(r.x-i.x,2)+Math.pow(r.y-i.y,2))),b=this.options.guidelineDistance,T=this.options.maxGuideLineLength,O=g>T?g-T:b;for(this._guidesContainer||(this._guidesContainer=L.DomUtil.create("div","leaflet-draw-guides",this._overlayPane));O<g;O+=this.options.guidelineDistance)d=O/g,p={x:Math.floor(i.x*(1-d)+d*r.x),y:Math.floor(i.y*(1-d)+d*r.y)},_=L.DomUtil.create("div","leaflet-draw-guide-dash",this._guidesContainer),_.style.backgroundColor=this._errorShown?this.options.drawError.color:this.options.shapeOptions.color,L.DomUtil.setPosition(_,p)},_updateGuideColor:function(i){if(this._guidesContainer)for(var r=0,d=this._guidesContainer.childNodes.length;r<d;r++)this._guidesContainer.childNodes[r].style.backgroundColor=i},_clearGuides:function(){if(this._guidesContainer)for(;this._guidesContainer.firstChild;)this._guidesContainer.removeChild(this._guidesContainer.firstChild)},_getTooltipText:function(){var i,r,d=this.options.showLength;return this._markers.length===0?i={text:L.drawLocal.draw.handlers.polyline.tooltip.start}:(r=d?this._getMeasurementString():"",i=this._markers.length===1?{text:L.drawLocal.draw.handlers.polyline.tooltip.cont,subtext:r}:{text:L.drawLocal.draw.handlers.polyline.tooltip.end,subtext:r}),i},_updateRunningMeasure:function(i,r){var d,p,_=this._markers.length;this._markers.length===1?this._measurementRunningTotal=0:(d=_-(r?2:1),p=L.GeometryUtil.isVersion07x()?i.distanceTo(this._markers[d].getLatLng())*(this.options.factor||1):this._map.distance(i,this._markers[d].getLatLng())*(this.options.factor||1),this._measurementRunningTotal+=p*(r?1:-1))},_getMeasurementString:function(){var i,r=this._currentLatLng,d=this._markers[this._markers.length-1].getLatLng();return i=L.GeometryUtil.isVersion07x()?d&&r&&r.distanceTo?this._measurementRunningTotal+r.distanceTo(d)*(this.options.factor||1):this._measurementRunningTotal||0:d&&r?this._measurementRunningTotal+this._map.distance(r,d)*(this.options.factor||1):this._measurementRunningTotal||0,L.GeometryUtil.readableDistance(i,this.options.metric,this.options.feet,this.options.nautic,this.options.precision)},_showErrorTooltip:function(){this._errorShown=!0,this._tooltip.showAsError().updateContent({text:this.options.drawError.message}),this._updateGuideColor(this.options.drawError.color),this._poly.setStyle({color:this.options.drawError.color}),this._clearHideErrorTimeout(),this._hideErrorTimeout=setTimeout(L.Util.bind(this._hideErrorTooltip,this),this.options.drawError.timeout)},_hideErrorTooltip:function(){this._errorShown=!1,this._clearHideErrorTimeout(),this._tooltip.removeError().updateContent(this._getTooltipText()),this._updateGuideColor(this.options.shapeOptions.color),this._poly.setStyle({color:this.options.shapeOptions.color})},_clearHideErrorTimeout:function(){this._hideErrorTimeout&&(clearTimeout(this._hideErrorTimeout),this._hideErrorTimeout=null)},_disableNewMarkers:function(){this._disableMarkers=!0},_enableNewMarkers:function(){setTimeout((function(){this._disableMarkers=!1}).bind(this),50)},_cleanUpShape:function(){this._markers.length>1&&this._markers[this._markers.length-1].off("click",this._finishShape,this)},_fireCreatedEvent:function(){var i=new this.Poly(this._poly.getLatLngs(),this.options.shapeOptions);L.Draw.Feature.prototype._fireCreatedEvent.call(this,i)}}),L.Draw.Polygon=L.Draw.Polyline.extend({statics:{TYPE:"polygon"},Poly:L.Polygon,options:{showArea:!1,showLength:!1,shapeOptions:{stroke:!0,color:"#3388ff",weight:4,opacity:.5,fill:!0,fillColor:null,fillOpacity:.2,clickable:!0},metric:!0,feet:!0,nautic:!1,precision:{}},initialize:function(i,r){L.Draw.Polyline.prototype.initialize.call(this,i,r),this.type=L.Draw.Polygon.TYPE},_updateFinishHandler:function(){var i=this._markers.length;i===1&&this._markers[0].on("click",this._finishShape,this),i>2&&(this._markers[i-1].on("dblclick",this._finishShape,this),i>3&&this._markers[i-2].off("dblclick",this._finishShape,this))},_getTooltipText:function(){var i,r;return this._markers.length===0?i=L.drawLocal.draw.handlers.polygon.tooltip.start:this._markers.length<3?(i=L.drawLocal.draw.handlers.polygon.tooltip.cont,r=this._getMeasurementString()):(i=L.drawLocal.draw.handlers.polygon.tooltip.end,r=this._getMeasurementString()),{text:i,subtext:r}},_getMeasurementString:function(){var i=this._area,r="";return i||this.options.showLength?(this.options.showLength&&(r=L.Draw.Polyline.prototype._getMeasurementString.call(this)),i&&(r+="<br>"+L.GeometryUtil.readableArea(i,this.options.metric,this.options.precision)),r):null},_shapeIsValid:function(){return this._markers.length>=3},_vertexChanged:function(i,r){var d;!this.options.allowIntersection&&this.options.showArea&&(d=this._poly.getLatLngs(),this._area=L.GeometryUtil.geodesicArea(d)),L.Draw.Polyline.prototype._vertexChanged.call(this,i,r)},_cleanUpShape:function(){var i=this._markers.length;i>0&&(this._markers[0].off("click",this._finishShape,this),i>2&&this._markers[i-1].off("dblclick",this._finishShape,this))}}),L.SimpleShape={},L.Draw.SimpleShape=L.Draw.Feature.extend({options:{repeatMode:!1},initialize:function(i,r){this._endLabelText=L.drawLocal.draw.handlers.simpleshape.tooltip.end,L.Draw.Feature.prototype.initialize.call(this,i,r)},addHooks:function(){L.Draw.Feature.prototype.addHooks.call(this),this._map&&(this._mapDraggable=this._map.dragging.enabled(),this._mapDraggable&&this._map.dragging.disable(),this._container.style.cursor="crosshair",this._tooltip.updateContent({text:this._initialLabelText}),this._map.on("mousedown",this._onMouseDown,this).on("mousemove",this._onMouseMove,this).on("touchstart",this._onMouseDown,this).on("touchmove",this._onMouseMove,this),n.addEventListener("touchstart",L.DomEvent.preventDefault,{passive:!1}))},removeHooks:function(){L.Draw.Feature.prototype.removeHooks.call(this),this._map&&(this._mapDraggable&&this._map.dragging.enable(),this._container.style.cursor="",this._map.off("mousedown",this._onMouseDown,this).off("mousemove",this._onMouseMove,this).off("touchstart",this._onMouseDown,this).off("touchmove",this._onMouseMove,this),L.DomEvent.off(n,"mouseup",this._onMouseUp,this),L.DomEvent.off(n,"touchend",this._onMouseUp,this),n.removeEventListener("touchstart",L.DomEvent.preventDefault),this._shape&&(this._map.removeLayer(this._shape),delete this._shape)),this._isDrawing=!1},_getTooltipText:function(){return{text:this._endLabelText}},_onMouseDown:function(i){this._isDrawing=!0,this._startLatLng=i.latlng,L.DomEvent.on(n,"mouseup",this._onMouseUp,this).on(n,"touchend",this._onMouseUp,this).preventDefault(i.originalEvent)},_onMouseMove:function(i){var r=i.latlng;this._tooltip.updatePosition(r),this._isDrawing&&(this._tooltip.updateContent(this._getTooltipText()),this._drawShape(r))},_onMouseUp:function(){this._shape&&this._fireCreatedEvent(),this.disable(),this.options.repeatMode&&this.enable()}}),L.Draw.Rectangle=L.Draw.SimpleShape.extend({statics:{TYPE:"rectangle"},options:{shapeOptions:{stroke:!0,color:"#3388ff",weight:4,opacity:.5,fill:!0,fillColor:null,fillOpacity:.2,clickable:!0},showArea:!0,metric:!0},initialize:function(i,r){this.type=L.Draw.Rectangle.TYPE,this._initialLabelText=L.drawLocal.draw.handlers.rectangle.tooltip.start,L.Draw.SimpleShape.prototype.initialize.call(this,i,r)},disable:function(){this._enabled&&(this._isCurrentlyTwoClickDrawing=!1,L.Draw.SimpleShape.prototype.disable.call(this))},_onMouseUp:function(i){if(!this._shape&&!this._isCurrentlyTwoClickDrawing)return void(this._isCurrentlyTwoClickDrawing=!0);this._isCurrentlyTwoClickDrawing&&!s(i.target,"leaflet-pane")||L.Draw.SimpleShape.prototype._onMouseUp.call(this)},_drawShape:function(i){this._shape?this._shape.setBounds(new L.LatLngBounds(this._startLatLng,i)):(this._shape=new L.Rectangle(new L.LatLngBounds(this._startLatLng,i),this.options.shapeOptions),this._map.addLayer(this._shape))},_fireCreatedEvent:function(){var i=new L.Rectangle(this._shape.getBounds(),this.options.shapeOptions);L.Draw.SimpleShape.prototype._fireCreatedEvent.call(this,i)},_getTooltipText:function(){var i,r,d,p=L.Draw.SimpleShape.prototype._getTooltipText.call(this),_=this._shape,g=this.options.showArea;return _&&(i=this._shape._defaultShape?this._shape._defaultShape():this._shape.getLatLngs(),r=L.GeometryUtil.geodesicArea(i),d=g?L.GeometryUtil.readableArea(r,this.options.metric):""),{text:p.text,subtext:d}}}),L.Draw.Marker=L.Draw.Feature.extend({statics:{TYPE:"marker"},options:{icon:new L.Icon.Default,repeatMode:!1,zIndexOffset:2e3},initialize:function(i,r){this.type=L.Draw.Marker.TYPE,this._initialLabelText=L.drawLocal.draw.handlers.marker.tooltip.start,L.Draw.Feature.prototype.initialize.call(this,i,r)},addHooks:function(){L.Draw.Feature.prototype.addHooks.call(this),this._map&&(this._tooltip.updateContent({text:this._initialLabelText}),this._mouseMarker||(this._mouseMarker=L.marker(this._map.getCenter(),{icon:L.divIcon({className:"leaflet-mouse-marker",iconAnchor:[20,20],iconSize:[40,40]}),opacity:0,zIndexOffset:this.options.zIndexOffset})),this._mouseMarker.on("click",this._onClick,this).addTo(this._map),this._map.on("mousemove",this._onMouseMove,this),this._map.on("click",this._onTouch,this))},removeHooks:function(){L.Draw.Feature.prototype.removeHooks.call(this),this._map&&(this._map.off("click",this._onClick,this).off("click",this._onTouch,this),this._marker&&(this._marker.off("click",this._onClick,this),this._map.removeLayer(this._marker),delete this._marker),this._mouseMarker.off("click",this._onClick,this),this._map.removeLayer(this._mouseMarker),delete this._mouseMarker,this._map.off("mousemove",this._onMouseMove,this))},_onMouseMove:function(i){var r=i.latlng;this._tooltip.updatePosition(r),this._mouseMarker.setLatLng(r),this._marker?(r=this._mouseMarker.getLatLng(),this._marker.setLatLng(r)):(this._marker=this._createMarker(r),this._marker.on("click",this._onClick,this),this._map.on("click",this._onClick,this).addLayer(this._marker))},_createMarker:function(i){return new L.Marker(i,{icon:this.options.icon,zIndexOffset:this.options.zIndexOffset})},_onClick:function(){this._fireCreatedEvent(),this.disable(),this.options.repeatMode&&this.enable()},_onTouch:function(i){this._onMouseMove(i),this._onClick()},_fireCreatedEvent:function(){var i=new L.Marker.Touch(this._marker.getLatLng(),{icon:this.options.icon});L.Draw.Feature.prototype._fireCreatedEvent.call(this,i)}}),L.Draw.CircleMarker=L.Draw.Marker.extend({statics:{TYPE:"circlemarker"},options:{stroke:!0,color:"#3388ff",weight:4,opacity:.5,fill:!0,fillColor:null,fillOpacity:.2,clickable:!0,zIndexOffset:2e3},initialize:function(i,r){this.type=L.Draw.CircleMarker.TYPE,this._initialLabelText=L.drawLocal.draw.handlers.circlemarker.tooltip.start,L.Draw.Feature.prototype.initialize.call(this,i,r)},_fireCreatedEvent:function(){var i=new L.CircleMarker(this._marker.getLatLng(),this.options);L.Draw.Feature.prototype._fireCreatedEvent.call(this,i)},_createMarker:function(i){return new L.CircleMarker(i,this.options)}}),L.Draw.Circle=L.Draw.SimpleShape.extend({statics:{TYPE:"circle"},options:{shapeOptions:{stroke:!0,color:"#3388ff",weight:4,opacity:.5,fill:!0,fillColor:null,fillOpacity:.2,clickable:!0},showRadius:!0,metric:!0,feet:!0,nautic:!1},initialize:function(i,r){this.type=L.Draw.Circle.TYPE,this._initialLabelText=L.drawLocal.draw.handlers.circle.tooltip.start,L.Draw.SimpleShape.prototype.initialize.call(this,i,r)},_drawShape:function(i){if(L.GeometryUtil.isVersion07x())var r=this._startLatLng.distanceTo(i);else var r=this._map.distance(this._startLatLng,i);this._shape?this._shape.setRadius(r):(this._shape=new L.Circle(this._startLatLng,r,this.options.shapeOptions),this._map.addLayer(this._shape))},_fireCreatedEvent:function(){var i=new L.Circle(this._startLatLng,this._shape.getRadius(),this.options.shapeOptions);L.Draw.SimpleShape.prototype._fireCreatedEvent.call(this,i)},_onMouseMove:function(i){var r,d=i.latlng,p=this.options.showRadius,_=this.options.metric;if(this._tooltip.updatePosition(d),this._isDrawing){this._drawShape(d),r=this._shape.getRadius().toFixed(1);var g="";p&&(g=L.drawLocal.draw.handlers.circle.radius+": "+L.GeometryUtil.readableDistance(r,_,this.options.feet,this.options.nautic)),this._tooltip.updateContent({text:this._endLabelText,subtext:g})}}}),L.Edit=L.Edit||{},L.Edit.Marker=L.Handler.extend({initialize:function(i,r){this._marker=i,L.setOptions(this,r)},addHooks:function(){var i=this._marker;i.dragging.enable(),i.on("dragend",this._onDragEnd,i),this._toggleMarkerHighlight()},removeHooks:function(){var i=this._marker;i.dragging.disable(),i.off("dragend",this._onDragEnd,i),this._toggleMarkerHighlight()},_onDragEnd:function(i){var r=i.target;r.edited=!0,this._map.fire(L.Draw.Event.EDITMOVE,{layer:r})},_toggleMarkerHighlight:function(){var i=this._marker._icon;i&&(i.style.display="none",L.DomUtil.hasClass(i,"leaflet-edit-marker-selected")?(L.DomUtil.removeClass(i,"leaflet-edit-marker-selected"),this._offsetMarker(i,-4)):(L.DomUtil.addClass(i,"leaflet-edit-marker-selected"),this._offsetMarker(i,4)),i.style.display="")},_offsetMarker:function(i,r){var d=parseInt(i.style.marginTop,10)-r,p=parseInt(i.style.marginLeft,10)-r;i.style.marginTop=d+"px",i.style.marginLeft=p+"px"}}),L.Marker.addInitHook(function(){L.Edit.Marker&&(this.editing=new L.Edit.Marker(this),this.options.editable&&this.editing.enable())}),L.Edit=L.Edit||{},L.Edit.Poly=L.Handler.extend({initialize:function(i){this.latlngs=[i._latlngs],i._holes&&(this.latlngs=this.latlngs.concat(i._holes)),this._poly=i,this._poly.on("revert-edited",this._updateLatLngs,this)},_defaultShape:function(){return L.Polyline._flat?L.Polyline._flat(this._poly._latlngs)?this._poly._latlngs:this._poly._latlngs[0]:this._poly._latlngs},_eachVertexHandler:function(i){for(var r=0;r<this._verticesHandlers.length;r++)i(this._verticesHandlers[r])},addHooks:function(){this._initHandlers(),this._eachVertexHandler(function(i){i.addHooks()})},removeHooks:function(){this._eachVertexHandler(function(i){i.removeHooks()})},updateMarkers:function(){this._eachVertexHandler(function(i){i.updateMarkers()})},_initHandlers:function(){this._verticesHandlers=[];for(var i=0;i<this.latlngs.length;i++)this._verticesHandlers.push(new L.Edit.PolyVerticesEdit(this._poly,this.latlngs[i],this._poly.options.poly))},_updateLatLngs:function(i){this.latlngs=[i.layer._latlngs],i.layer._holes&&(this.latlngs=this.latlngs.concat(i.layer._holes))}}),L.Edit.PolyVerticesEdit=L.Handler.extend({options:{icon:new L.DivIcon({iconSize:new L.Point(8,8),className:"leaflet-div-icon leaflet-editing-icon"}),touchIcon:new L.DivIcon({iconSize:new L.Point(20,20),className:"leaflet-div-icon leaflet-editing-icon leaflet-touch-icon"}),drawError:{color:"#b00b00",timeout:1e3}},initialize:function(i,r,d){L.Browser.touch&&(this.options.icon=this.options.touchIcon),this._poly=i,d&&d.drawError&&(d.drawError=L.Util.extend({},this.options.drawError,d.drawError)),this._latlngs=r,L.setOptions(this,d)},_defaultShape:function(){return L.Polyline._flat?L.Polyline._flat(this._latlngs)?this._latlngs:this._latlngs[0]:this._latlngs},addHooks:function(){var i=this._poly,r=i._path;i instanceof L.Polygon||(i.options.fill=!1,i.options.editing&&(i.options.editing.fill=!1)),r&&i.options.editing&&i.options.editing.className&&(i.options.original.className&&i.options.original.className.split(" ").forEach(function(d){L.DomUtil.removeClass(r,d)}),i.options.editing.className.split(" ").forEach(function(d){L.DomUtil.addClass(r,d)})),i.setStyle(i.options.editing),this._poly._map&&(this._map=this._poly._map,this._markerGroup||this._initMarkers(),this._poly._map.addLayer(this._markerGroup))},removeHooks:function(){var i=this._poly,r=i._path;r&&i.options.editing&&i.options.editing.className&&(i.options.editing.className.split(" ").forEach(function(d){L.DomUtil.removeClass(r,d)}),i.options.original.className&&i.options.original.className.split(" ").forEach(function(d){L.DomUtil.addClass(r,d)})),i.setStyle(i.options.original),i._map&&(i._map.removeLayer(this._markerGroup),delete this._markerGroup,delete this._markers)},updateMarkers:function(){this._markerGroup.clearLayers(),this._initMarkers()},_initMarkers:function(){this._markerGroup||(this._markerGroup=new L.LayerGroup),this._markers=[];var i,r,d,p,_=this._defaultShape();for(i=0,d=_.length;i<d;i++)p=this._createMarker(_[i],i),p.on("click",this._onMarkerClick,this),p.on("contextmenu",this._onContextMenu,this),this._markers.push(p);var g,b;for(i=0,r=d-1;i<d;r=i++)(i!==0||L.Polygon&&this._poly instanceof L.Polygon)&&(g=this._markers[r],b=this._markers[i],this._createMiddleMarker(g,b),this._updatePrevNext(g,b))},_createMarker:function(i,r){var d=new L.Marker.Touch(i,{draggable:!0,icon:this.options.icon});return d._origLatLng=i,d._index=r,d.on("dragstart",this._onMarkerDragStart,this).on("drag",this._onMarkerDrag,this).on("dragend",this._fireEdit,this).on("touchmove",this._onTouchMove,this).on("touchend",this._fireEdit,this).on("MSPointerMove",this._onTouchMove,this).on("MSPointerUp",this._fireEdit,this),this._markerGroup.addLayer(d),d},_onMarkerDragStart:function(){this._poly.fire("editstart")},_spliceLatLngs:function(){var i=this._defaultShape(),r=[].splice.apply(i,arguments);return this._poly._convertLatLngs(i,!0),this._poly.redraw(),r},_removeMarker:function(i){var r=i._index;this._markerGroup.removeLayer(i),this._markers.splice(r,1),this._spliceLatLngs(r,1),this._updateIndexes(r,-1),i.off("dragstart",this._onMarkerDragStart,this).off("drag",this._onMarkerDrag,this).off("dragend",this._fireEdit,this).off("touchmove",this._onMarkerDrag,this).off("touchend",this._fireEdit,this).off("click",this._onMarkerClick,this).off("MSPointerMove",this._onTouchMove,this).off("MSPointerUp",this._fireEdit,this)},_fireEdit:function(){this._poly.edited=!0,this._poly.fire("edit"),this._poly._map.fire(L.Draw.Event.EDITVERTEX,{layers:this._markerGroup,poly:this._poly})},_onMarkerDrag:function(i){var r=i.target,d=this._poly,p=L.LatLngUtil.cloneLatLng(r._origLatLng);if(L.extend(r._origLatLng,r._latlng),d.options.poly){var _=d._map._editTooltip;if(!d.options.poly.allowIntersection&&d.intersects()){L.extend(r._origLatLng,p),r.setLatLng(p);var g=d.options.color;d.setStyle({color:this.options.drawError.color}),_&&_.updateContent({text:L.drawLocal.draw.handlers.polyline.error}),setTimeout(function(){d.setStyle({color:g}),_&&_.updateContent({text:L.drawLocal.edit.handlers.edit.tooltip.text,subtext:L.drawLocal.edit.handlers.edit.tooltip.subtext})},1e3)}}r._middleLeft&&r._middleLeft.setLatLng(this._getMiddleLatLng(r._prev,r)),r._middleRight&&r._middleRight.setLatLng(this._getMiddleLatLng(r,r._next)),this._poly._bounds._southWest=L.latLng(1/0,1/0),this._poly._bounds._northEast=L.latLng(-1/0,-1/0);var b=this._poly.getLatLngs();this._poly._convertLatLngs(b,!0),this._poly.redraw(),this._poly.fire("editdrag")},_onMarkerClick:function(i){var r=L.Polygon&&this._poly instanceof L.Polygon?4:3,d=i.target;this._defaultShape().length<r||(this._removeMarker(d),this._updatePrevNext(d._prev,d._next),d._middleLeft&&this._markerGroup.removeLayer(d._middleLeft),d._middleRight&&this._markerGroup.removeLayer(d._middleRight),d._prev&&d._next?this._createMiddleMarker(d._prev,d._next):d._prev?d._next||(d._prev._middleRight=null):d._next._middleLeft=null,this._fireEdit())},_onContextMenu:function(i){var r=i.target;this._poly,this._poly._map.fire(L.Draw.Event.MARKERCONTEXT,{marker:r,layers:this._markerGroup,poly:this._poly}),L.DomEvent.stopPropagation},_onTouchMove:function(i){var r=this._map.mouseEventToLayerPoint(i.originalEvent.touches[0]),d=this._map.layerPointToLatLng(r),p=i.target;L.extend(p._origLatLng,d),p._middleLeft&&p._middleLeft.setLatLng(this._getMiddleLatLng(p._prev,p)),p._middleRight&&p._middleRight.setLatLng(this._getMiddleLatLng(p,p._next)),this._poly.redraw(),this.updateMarkers()},_updateIndexes:function(i,r){this._markerGroup.eachLayer(function(d){d._index>i&&(d._index+=r)})},_createMiddleMarker:function(i,r){var d,p,_,g=this._getMiddleLatLng(i,r),b=this._createMarker(g);b.setOpacity(.6),i._middleRight=r._middleLeft=b,p=function(){b.off("touchmove",p,this);var T=r._index;b._index=T,b.off("click",d,this).on("click",this._onMarkerClick,this),g.lat=b.getLatLng().lat,g.lng=b.getLatLng().lng,this._spliceLatLngs(T,0,g),this._markers.splice(T,0,b),b.setOpacity(1),this._updateIndexes(T,1),r._index++,this._updatePrevNext(i,b),this._updatePrevNext(b,r),this._poly.fire("editstart")},_=function(){b.off("dragstart",p,this),b.off("dragend",_,this),b.off("touchmove",p,this),this._createMiddleMarker(i,b),this._createMiddleMarker(b,r)},d=function(){p.call(this),_.call(this),this._fireEdit()},b.on("click",d,this).on("dragstart",p,this).on("dragend",_,this).on("touchmove",p,this),this._markerGroup.addLayer(b)},_updatePrevNext:function(i,r){i&&(i._next=r),r&&(r._prev=i)},_getMiddleLatLng:function(i,r){var d=this._poly._map,p=d.project(i.getLatLng()),_=d.project(r.getLatLng());return d.unproject(p._add(_)._divideBy(2))}}),L.Polyline.addInitHook(function(){this.editing||(L.Edit.Poly&&(this.editing=new L.Edit.Poly(this),this.options.editable&&this.editing.enable()),this.on("add",function(){this.editing&&this.editing.enabled()&&this.editing.addHooks()}),this.on("remove",function(){this.editing&&this.editing.enabled()&&this.editing.removeHooks()}))}),L.Edit=L.Edit||{},L.Edit.SimpleShape=L.Handler.extend({options:{moveIcon:new L.DivIcon({iconSize:new L.Point(8,8),className:"leaflet-div-icon leaflet-editing-icon leaflet-edit-move"}),resizeIcon:new L.DivIcon({iconSize:new L.Point(8,8),className:"leaflet-div-icon leaflet-editing-icon leaflet-edit-resize"}),touchMoveIcon:new L.DivIcon({iconSize:new L.Point(20,20),className:"leaflet-div-icon leaflet-editing-icon leaflet-edit-move leaflet-touch-icon"}),touchResizeIcon:new L.DivIcon({iconSize:new L.Point(20,20),className:"leaflet-div-icon leaflet-editing-icon leaflet-edit-resize leaflet-touch-icon"})},initialize:function(i,r){L.Browser.touch&&(this.options.moveIcon=this.options.touchMoveIcon,this.options.resizeIcon=this.options.touchResizeIcon),this._shape=i,L.Util.setOptions(this,r)},addHooks:function(){var i=this._shape;this._shape._map&&(this._map=this._shape._map,i.setStyle(i.options.editing),i._map&&(this._map=i._map,this._markerGroup||this._initMarkers(),this._map.addLayer(this._markerGroup)))},removeHooks:function(){var i=this._shape;if(i.setStyle(i.options.original),i._map){this._unbindMarker(this._moveMarker);for(var r=0,d=this._resizeMarkers.length;r<d;r++)this._unbindMarker(this._resizeMarkers[r]);this._resizeMarkers=null,this._map.removeLayer(this._markerGroup),delete this._markerGroup}this._map=null},updateMarkers:function(){this._markerGroup.clearLayers(),this._initMarkers()},_initMarkers:function(){this._markerGroup||(this._markerGroup=new L.LayerGroup),this._createMoveMarker(),this._createResizeMarker()},_createMoveMarker:function(){},_createResizeMarker:function(){},_createMarker:function(i,r){var d=new L.Marker.Touch(i,{draggable:!0,icon:r,zIndexOffset:10});return this._bindMarker(d),this._markerGroup.addLayer(d),d},_bindMarker:function(i){i.on("dragstart",this._onMarkerDragStart,this).on("drag",this._onMarkerDrag,this).on("dragend",this._onMarkerDragEnd,this).on("touchstart",this._onTouchStart,this).on("touchmove",this._onTouchMove,this).on("MSPointerMove",this._onTouchMove,this).on("touchend",this._onTouchEnd,this).on("MSPointerUp",this._onTouchEnd,this)},_unbindMarker:function(i){i.off("dragstart",this._onMarkerDragStart,this).off("drag",this._onMarkerDrag,this).off("dragend",this._onMarkerDragEnd,this).off("touchstart",this._onTouchStart,this).off("touchmove",this._onTouchMove,this).off("MSPointerMove",this._onTouchMove,this).off("touchend",this._onTouchEnd,this).off("MSPointerUp",this._onTouchEnd,this)},_onMarkerDragStart:function(i){i.target.setOpacity(0),this._shape.fire("editstart")},_fireEdit:function(){this._shape.edited=!0,this._shape.fire("edit")},_onMarkerDrag:function(i){var r=i.target,d=r.getLatLng();r===this._moveMarker?this._move(d):this._resize(d),this._shape.redraw(),this._shape.fire("editdrag")},_onMarkerDragEnd:function(i){i.target.setOpacity(1),this._fireEdit()},_onTouchStart:function(i){if(L.Edit.SimpleShape.prototype._onMarkerDragStart.call(this,i),typeof this._getCorners=="function"){var r=this._getCorners(),d=i.target,p=d._cornerIndex;d.setOpacity(0),this._oppositeCorner=r[(p+2)%4],this._toggleCornerMarkers(0,p)}this._shape.fire("editstart")},_onTouchMove:function(i){var r=this._map.mouseEventToLayerPoint(i.originalEvent.touches[0]),d=this._map.layerPointToLatLng(r);return i.target===this._moveMarker?this._move(d):this._resize(d),this._shape.redraw(),!1},_onTouchEnd:function(i){i.target.setOpacity(1),this.updateMarkers(),this._fireEdit()},_move:function(){},_resize:function(){}}),L.Edit=L.Edit||{},L.Edit.Rectangle=L.Edit.SimpleShape.extend({_createMoveMarker:function(){var i=this._shape.getBounds(),r=i.getCenter();this._moveMarker=this._createMarker(r,this.options.moveIcon)},_createResizeMarker:function(){var i=this._getCorners();this._resizeMarkers=[];for(var r=0,d=i.length;r<d;r++)this._resizeMarkers.push(this._createMarker(i[r],this.options.resizeIcon)),this._resizeMarkers[r]._cornerIndex=r},_onMarkerDragStart:function(i){L.Edit.SimpleShape.prototype._onMarkerDragStart.call(this,i);var r=this._getCorners(),d=i.target,p=d._cornerIndex;this._oppositeCorner=r[(p+2)%4],this._toggleCornerMarkers(0,p)},_onMarkerDragEnd:function(i){var r,d,p=i.target;p===this._moveMarker&&(r=this._shape.getBounds(),d=r.getCenter(),p.setLatLng(d)),this._toggleCornerMarkers(1),this._repositionCornerMarkers(),L.Edit.SimpleShape.prototype._onMarkerDragEnd.call(this,i)},_move:function(i){for(var r,d=this._shape._defaultShape?this._shape._defaultShape():this._shape.getLatLngs(),p=this._shape.getBounds(),_=p.getCenter(),g=[],b=0,T=d.length;b<T;b++)r=[d[b].lat-_.lat,d[b].lng-_.lng],g.push([i.lat+r[0],i.lng+r[1]]);this._shape.setLatLngs(g),this._repositionCornerMarkers(),this._map.fire(L.Draw.Event.EDITMOVE,{layer:this._shape})},_resize:function(i){var r;this._shape.setBounds(L.latLngBounds(i,this._oppositeCorner)),r=this._shape.getBounds(),this._moveMarker.setLatLng(r.getCenter()),this._map.fire(L.Draw.Event.EDITRESIZE,{layer:this._shape})},_getCorners:function(){var i=this._shape.getBounds();return[i.getNorthWest(),i.getNorthEast(),i.getSouthEast(),i.getSouthWest()]},_toggleCornerMarkers:function(i){for(var r=0,d=this._resizeMarkers.length;r<d;r++)this._resizeMarkers[r].setOpacity(i)},_repositionCornerMarkers:function(){for(var i=this._getCorners(),r=0,d=this._resizeMarkers.length;r<d;r++)this._resizeMarkers[r].setLatLng(i[r])}}),L.Rectangle.addInitHook(function(){L.Edit.Rectangle&&(this.editing=new L.Edit.Rectangle(this),this.options.editable&&this.editing.enable())}),L.Edit=L.Edit||{},L.Edit.CircleMarker=L.Edit.SimpleShape.extend({_createMoveMarker:function(){var i=this._shape.getLatLng();this._moveMarker=this._createMarker(i,this.options.moveIcon)},_createResizeMarker:function(){this._resizeMarkers=[]},_move:function(i){if(this._resizeMarkers.length){var r=this._getResizeMarkerPoint(i);this._resizeMarkers[0].setLatLng(r)}this._shape.setLatLng(i),this._map.fire(L.Draw.Event.EDITMOVE,{layer:this._shape})}}),L.CircleMarker.addInitHook(function(){L.Edit.CircleMarker&&(this.editing=new L.Edit.CircleMarker(this),this.options.editable&&this.editing.enable()),this.on("add",function(){this.editing&&this.editing.enabled()&&this.editing.addHooks()}),this.on("remove",function(){this.editing&&this.editing.enabled()&&this.editing.removeHooks()})}),L.Edit=L.Edit||{},L.Edit.Circle=L.Edit.CircleMarker.extend({_createResizeMarker:function(){var i=this._shape.getLatLng(),r=this._getResizeMarkerPoint(i);this._resizeMarkers=[],this._resizeMarkers.push(this._createMarker(r,this.options.resizeIcon))},_getResizeMarkerPoint:function(i){var r=this._shape._radius*Math.cos(Math.PI/4),d=this._map.project(i);return this._map.unproject([d.x+r,d.y-r])},_resize:function(i){var r=this._moveMarker.getLatLng();L.GeometryUtil.isVersion07x()?radius=r.distanceTo(i):radius=this._map.distance(r,i),this._shape.setRadius(radius),this._map.editTooltip&&this._map._editTooltip.updateContent({text:L.drawLocal.edit.handlers.edit.tooltip.subtext+"<br />"+L.drawLocal.edit.handlers.edit.tooltip.text,subtext:L.drawLocal.draw.handlers.circle.radius+": "+L.GeometryUtil.readableDistance(radius,!0,this.options.feet,this.options.nautic)}),this._shape.setRadius(radius),this._map.fire(L.Draw.Event.EDITRESIZE,{layer:this._shape})}}),L.Circle.addInitHook(function(){L.Edit.Circle&&(this.editing=new L.Edit.Circle(this),this.options.editable&&this.editing.enable())}),L.Map.mergeOptions({touchExtend:!0}),L.Map.TouchExtend=L.Handler.extend({initialize:function(i){this._map=i,this._container=i._container,this._pane=i._panes.overlayPane},addHooks:function(){L.DomEvent.on(this._container,"touchstart",this._onTouchStart,this),L.DomEvent.on(this._container,"touchend",this._onTouchEnd,this),L.DomEvent.on(this._container,"touchmove",this._onTouchMove,this),this._detectIE()?(L.DomEvent.on(this._container,"MSPointerDown",this._onTouchStart,this),L.DomEvent.on(this._container,"MSPointerUp",this._onTouchEnd,this),L.DomEvent.on(this._container,"MSPointerMove",this._onTouchMove,this),L.DomEvent.on(this._container,"MSPointerCancel",this._onTouchCancel,this)):(L.DomEvent.on(this._container,"touchcancel",this._onTouchCancel,this),L.DomEvent.on(this._container,"touchleave",this._onTouchLeave,this))},removeHooks:function(){L.DomEvent.off(this._container,"touchstart",this._onTouchStart,this),L.DomEvent.off(this._container,"touchend",this._onTouchEnd,this),L.DomEvent.off(this._container,"touchmove",this._onTouchMove,this),this._detectIE()?(L.DomEvent.off(this._container,"MSPointerDown",this._onTouchStart,this),L.DomEvent.off(this._container,"MSPointerUp",this._onTouchEnd,this),L.DomEvent.off(this._container,"MSPointerMove",this._onTouchMove,this),L.DomEvent.off(this._container,"MSPointerCancel",this._onTouchCancel,this)):(L.DomEvent.off(this._container,"touchcancel",this._onTouchCancel,this),L.DomEvent.off(this._container,"touchleave",this._onTouchLeave,this))},_touchEvent:function(i,r){var d={};if(i.touches!==void 0){if(!i.touches.length)return;d=i.touches[0]}else if(i.pointerType!=="touch"||(d=i,!this._filterClick(i)))return;var p=this._map.mouseEventToContainerPoint(d),_=this._map.mouseEventToLayerPoint(d),g=this._map.layerPointToLatLng(_);this._map.fire(r,{latlng:g,layerPoint:_,containerPoint:p,pageX:d.pageX,pageY:d.pageY,originalEvent:i})},_filterClick:function(i){var r=i.timeStamp||i.originalEvent.timeStamp,d=L.DomEvent._lastClick&&r-L.DomEvent._lastClick;return d&&d>100&&d<500||i.target._simulatedClick&&!i._simulated?(L.DomEvent.stop(i),!1):(L.DomEvent._lastClick=r,!0)},_onTouchStart:function(i){this._map._loaded&&this._touchEvent(i,"touchstart")},_onTouchEnd:function(i){this._map._loaded&&this._touchEvent(i,"touchend")},_onTouchCancel:function(i){if(this._map._loaded){var r="touchcancel";this._detectIE()&&(r="pointercancel"),this._touchEvent(i,r)}},_onTouchLeave:function(i){this._map._loaded&&this._touchEvent(i,"touchleave")},_onTouchMove:function(i){this._map._loaded&&this._touchEvent(i,"touchmove")},_detectIE:function(){var i=a.navigator.userAgent,r=i.indexOf("MSIE ");if(r>0)return parseInt(i.substring(r+5,i.indexOf(".",r)),10);if(i.indexOf("Trident/")>0){var d=i.indexOf("rv:");return parseInt(i.substring(d+3,i.indexOf(".",d)),10)}var p=i.indexOf("Edge/");return p>0&&parseInt(i.substring(p+5,i.indexOf(".",p)),10)}}),L.Map.addInitHook("addHandler","touchExtend",L.Map.TouchExtend),L.Marker.Touch=L.Marker.extend({_initInteraction:function(){return this.addInteractiveTarget?L.Marker.prototype._initInteraction.apply(this):this._initInteractionLegacy()},_initInteractionLegacy:function(){if(this.options.clickable){var i=this._icon,r=["dblclick","mousedown","mouseover","mouseout","contextmenu","touchstart","touchend","touchmove"];this._detectIE?r.concat(["MSPointerDown","MSPointerUp","MSPointerMove","MSPointerCancel"]):r.concat(["touchcancel"]),L.DomUtil.addClass(i,"leaflet-clickable"),L.DomEvent.on(i,"click",this._onMouseClick,this),L.DomEvent.on(i,"keypress",this._onKeyPress,this);for(var d=0;d<r.length;d++)L.DomEvent.on(i,r[d],this._fireMouseEvent,this);L.Handler.MarkerDrag&&(this.dragging=new L.Handler.MarkerDrag(this),this.options.draggable&&this.dragging.enable())}},_detectIE:function(){var i=a.navigator.userAgent,r=i.indexOf("MSIE ");if(r>0)return parseInt(i.substring(r+5,i.indexOf(".",r)),10);if(i.indexOf("Trident/")>0){var d=i.indexOf("rv:");return parseInt(i.substring(d+3,i.indexOf(".",d)),10)}var p=i.indexOf("Edge/");return p>0&&parseInt(i.substring(p+5,i.indexOf(".",p)),10)}}),L.LatLngUtil={cloneLatLngs:function(i){for(var r=[],d=0,p=i.length;d<p;d++)Array.isArray(i[d])?r.push(L.LatLngUtil.cloneLatLngs(i[d])):r.push(this.cloneLatLng(i[d]));return r},cloneLatLng:function(i){return L.latLng(i.lat,i.lng)}},function(){var i={km:2,ha:2,m:0,mi:2,ac:2,yd:0,ft:0,nm:2};L.GeometryUtil=L.extend(L.GeometryUtil||{},{geodesicArea:function(r){var d,p,_=r.length,g=0,b=Math.PI/180;if(_>2){for(var T=0;T<_;T++)d=r[T],p=r[(T+1)%_],g+=(p.lng-d.lng)*b*(2+Math.sin(d.lat*b)+Math.sin(p.lat*b));g=6378137*g*6378137/2}return Math.abs(g)},formattedNumber:function(r,d){var p=parseFloat(r).toFixed(d),_=L.drawLocal.format&&L.drawLocal.format.numeric,g=_&&_.delimiters,b=g&&g.thousands,T=g&&g.decimal;if(b||T){var O=p.split(".");p=b?O[0].replace(/(\d)(?=(\d{3})+(?!\d))/g,"$1"+b):O[0],T=T||".",O.length>1&&(p=p+T+O[1])}return p},readableArea:function(r,d,b){var _,g,b=L.Util.extend({},i,b);return d?(g=["ha","m"],type=typeof d,type==="string"?g=[d]:type!=="boolean"&&(g=d),_=r>=1e6&&g.indexOf("km")!==-1?L.GeometryUtil.formattedNumber(1e-6*r,b.km)+" km²":r>=1e4&&g.indexOf("ha")!==-1?L.GeometryUtil.formattedNumber(1e-4*r,b.ha)+" ha":L.GeometryUtil.formattedNumber(r,b.m)+" m²"):(r/=.836127,_=r>=3097600?L.GeometryUtil.formattedNumber(r/3097600,b.mi)+" mi²":r>=4840?L.GeometryUtil.formattedNumber(r/4840,b.ac)+" acres":L.GeometryUtil.formattedNumber(r,b.yd)+" yd²"),_},readableDistance:function(r,d,p,_,T){var b,T=L.Util.extend({},i,T);switch(d?typeof d=="string"?d:"metric":p?"feet":_?"nauticalMile":"yards"){case"metric":b=r>1e3?L.GeometryUtil.formattedNumber(r/1e3,T.km)+" km":L.GeometryUtil.formattedNumber(r,T.m)+" m";break;case"feet":r*=3.28083,b=L.GeometryUtil.formattedNumber(r,T.ft)+" ft";break;case"nauticalMile":r*=.53996,b=L.GeometryUtil.formattedNumber(r/1e3,T.nm)+" nm";break;case"yards":default:r*=1.09361,b=r>1760?L.GeometryUtil.formattedNumber(r/1760,T.mi)+" miles":L.GeometryUtil.formattedNumber(r,T.yd)+" yd"}return b},isVersion07x:function(){var r=L.version.split(".");return parseInt(r[0],10)===0&&parseInt(r[1],10)===7}})}(),L.Util.extend(L.LineUtil,{segmentsIntersect:function(i,r,d,p){return this._checkCounterclockwise(i,d,p)!==this._checkCounterclockwise(r,d,p)&&this._checkCounterclockwise(i,r,d)!==this._checkCounterclockwise(i,r,p)},_checkCounterclockwise:function(i,r,d){return(d.y-i.y)*(r.x-i.x)>(r.y-i.y)*(d.x-i.x)}}),L.Polyline.include({intersects:function(){var i,r,d,p=this._getProjectedPoints(),_=p?p.length:0;if(this._tooFewPointsForIntersection())return!1;for(i=_-1;i>=3;i--)if(r=p[i-1],d=p[i],this._lineSegmentsIntersectsRange(r,d,i-2))return!0;return!1},newLatLngIntersects:function(i,r){return!!this._map&&this.newPointIntersects(this._map.latLngToLayerPoint(i),r)},newPointIntersects:function(i,r){var d=this._getProjectedPoints(),p=d?d.length:0,_=d?d[p-1]:null,g=p-2;return!this._tooFewPointsForIntersection(1)&&this._lineSegmentsIntersectsRange(_,i,g,r?1:0)},_tooFewPointsForIntersection:function(i){var r=this._getProjectedPoints(),d=r?r.length:0;return d+=i||0,!r||d<=3},_lineSegmentsIntersectsRange:function(i,r,d,p){var _,g,b=this._getProjectedPoints();p=p||0;for(var T=d;T>p;T--)if(_=b[T-1],g=b[T],L.LineUtil.segmentsIntersect(i,r,_,g))return!0;return!1},_getProjectedPoints:function(){if(!this._defaultShape)return this._originalPoints;for(var i=[],r=this._defaultShape(),d=0;d<r.length;d++)i.push(this._map.latLngToLayerPoint(r[d]));return i}}),L.Polygon.include({intersects:function(){var i,r,d,p,_=this._getProjectedPoints();return!this._tooFewPointsForIntersection()&&(!!L.Polyline.prototype.intersects.call(this)||(i=_.length,r=_[0],d=_[i-1],p=i-2,this._lineSegmentsIntersectsRange(d,r,p,1)))}}),L.Control.Draw=L.Control.extend({options:{position:"topleft",draw:{},edit:!1},initialize:function(i){if(L.version<"0.7")throw new Error("Leaflet.draw 0.2.3+ requires Leaflet 0.7.0+. Download latest from https://github.com/Leaflet/Leaflet/");L.Control.prototype.initialize.call(this,i);var r;this._toolbars={},L.DrawToolbar&&this.options.draw&&(r=new L.DrawToolbar(this.options.draw),this._toolbars[L.DrawToolbar.TYPE]=r,this._toolbars[L.DrawToolbar.TYPE].on("enable",this._toolbarEnabled,this)),L.EditToolbar&&this.options.edit&&(r=new L.EditToolbar(this.options.edit),this._toolbars[L.EditToolbar.TYPE]=r,this._toolbars[L.EditToolbar.TYPE].on("enable",this._toolbarEnabled,this)),L.toolbar=this},onAdd:function(i){var r,d=L.DomUtil.create("div","leaflet-draw"),p=!1;for(var _ in this._toolbars)this._toolbars.hasOwnProperty(_)&&(r=this._toolbars[_].addToolbar(i))&&(p||(L.DomUtil.hasClass(r,"leaflet-draw-toolbar-top")||L.DomUtil.addClass(r.childNodes[0],"leaflet-draw-toolbar-top"),p=!0),d.appendChild(r));return d},onRemove:function(){for(var i in this._toolbars)this._toolbars.hasOwnProperty(i)&&this._toolbars[i].removeToolbar()},setDrawingOptions:function(i){for(var r in this._toolbars)this._toolbars[r]instanceof L.DrawToolbar&&this._toolbars[r].setOptions(i)},_toolbarEnabled:function(i){var r=i.target;for(var d in this._toolbars)this._toolbars[d]!==r&&this._toolbars[d].disable()}}),L.Map.mergeOptions({drawControlTooltips:!0,drawControl:!1}),L.Map.addInitHook(function(){this.options.drawControl&&(this.drawControl=new L.Control.Draw,this.addControl(this.drawControl))}),L.Toolbar=L.Class.extend({initialize:function(i){L.setOptions(this,i),this._modes={},this._actionButtons=[],this._activeMode=null;var r=L.version.split(".");parseInt(r[0],10)===1&&parseInt(r[1],10)>=2?L.Toolbar.include(L.Evented.prototype):L.Toolbar.include(L.Mixin.Events)},enabled:function(){return this._activeMode!==null},disable:function(){this.enabled()&&this._activeMode.handler.disable()},addToolbar:function(i){var r,d=L.DomUtil.create("div","leaflet-draw-section"),p=0,_=this._toolbarClass||"",g=this.getModeHandlers(i);for(this._toolbarContainer=L.DomUtil.create("div","leaflet-draw-toolbar leaflet-bar"),this._map=i,r=0;r<g.length;r++)g[r].enabled&&this._initModeHandler(g[r].handler,this._toolbarContainer,p++,_,g[r].title);if(p)return this._lastButtonIndex=--p,this._actionsContainer=L.DomUtil.create("ul","leaflet-draw-actions"),d.appendChild(this._toolbarContainer),d.appendChild(this._actionsContainer),d},removeToolbar:function(){for(var i in this._modes)this._modes.hasOwnProperty(i)&&(this._disposeButton(this._modes[i].button,this._modes[i].handler.enable,this._modes[i].handler),this._modes[i].handler.disable(),this._modes[i].handler.off("enabled",this._handlerActivated,this).off("disabled",this._handlerDeactivated,this));this._modes={};for(var r=0,d=this._actionButtons.length;r<d;r++)this._disposeButton(this._actionButtons[r].button,this._actionButtons[r].callback,this);this._actionButtons=[],this._actionsContainer=null},_initModeHandler:function(i,r,d,p,_){var g=i.type;this._modes[g]={},this._modes[g].handler=i,this._modes[g].button=this._createButton({type:g,title:_,className:p+"-"+g,container:r,callback:this._modes[g].handler.enable,context:this._modes[g].handler}),this._modes[g].buttonIndex=d,this._modes[g].handler.on("enabled",this._handlerActivated,this).on("disabled",this._handlerDeactivated,this)},_detectIOS:function(){return/iPad|iPhone|iPod/.test(navigator.userAgent)&&!a.MSStream},_createButton:function(i){var r=L.DomUtil.create("a",i.className||"",i.container),d=L.DomUtil.create("span","sr-only",i.container);r.href="#",r.appendChild(d),i.title&&(r.title=i.title,d.innerHTML=i.title),i.text&&(r.innerHTML=i.text,d.innerHTML=i.text);var p=this._detectIOS()?"touchstart":"click";return L.DomEvent.on(r,"click",L.DomEvent.stopPropagation).on(r,"mousedown",L.DomEvent.stopPropagation).on(r,"dblclick",L.DomEvent.stopPropagation).on(r,"touchstart",L.DomEvent.stopPropagation).on(r,"click",L.DomEvent.preventDefault).on(r,p,i.callback,i.context),r},_disposeButton:function(i,r){var d=this._detectIOS()?"touchstart":"click";L.DomEvent.off(i,"click",L.DomEvent.stopPropagation).off(i,"mousedown",L.DomEvent.stopPropagation).off(i,"dblclick",L.DomEvent.stopPropagation).off(i,"touchstart",L.DomEvent.stopPropagation).off(i,"click",L.DomEvent.preventDefault).off(i,d,r)},_handlerActivated:function(i){this.disable(),this._activeMode=this._modes[i.handler],L.DomUtil.addClass(this._activeMode.button,"leaflet-draw-toolbar-button-enabled"),this._showActionsToolbar(),this.fire("enable")},_handlerDeactivated:function(){this._hideActionsToolbar(),L.DomUtil.removeClass(this._activeMode.button,"leaflet-draw-toolbar-button-enabled"),this._activeMode=null,this.fire("disable")},_createActions:function(i){var r,d,p,_,g=this._actionsContainer,b=this.getActions(i),T=b.length;for(d=0,p=this._actionButtons.length;d<p;d++)this._disposeButton(this._actionButtons[d].button,this._actionButtons[d].callback);for(this._actionButtons=[];g.firstChild;)g.removeChild(g.firstChild);for(var O=0;O<T;O++)"enabled"in b[O]&&!b[O].enabled||(r=L.DomUtil.create("li","",g),_=this._createButton({title:b[O].title,text:b[O].text,container:r,callback:b[O].callback,context:b[O].context}),this._actionButtons.push({button:_,callback:b[O].callback}))},_showActionsToolbar:function(){var i=this._activeMode.buttonIndex,r=this._lastButtonIndex,d=this._activeMode.button.offsetTop-1;this._createActions(this._activeMode.handler),this._actionsContainer.style.top=d+"px",i===0&&(L.DomUtil.addClass(this._toolbarContainer,"leaflet-draw-toolbar-notop"),L.DomUtil.addClass(this._actionsContainer,"leaflet-draw-actions-top")),i===r&&(L.DomUtil.addClass(this._toolbarContainer,"leaflet-draw-toolbar-nobottom"),L.DomUtil.addClass(this._actionsContainer,"leaflet-draw-actions-bottom")),this._actionsContainer.style.display="block",this._map.fire(L.Draw.Event.TOOLBAROPENED)},_hideActionsToolbar:function(){this._actionsContainer.style.display="none",L.DomUtil.removeClass(this._toolbarContainer,"leaflet-draw-toolbar-notop"),L.DomUtil.removeClass(this._toolbarContainer,"leaflet-draw-toolbar-nobottom"),L.DomUtil.removeClass(this._actionsContainer,"leaflet-draw-actions-top"),L.DomUtil.removeClass(this._actionsContainer,"leaflet-draw-actions-bottom"),this._map.fire(L.Draw.Event.TOOLBARCLOSED)}}),L.Draw=L.Draw||{},L.Draw.Tooltip=L.Class.extend({initialize:function(i){this._map=i,this._popupPane=i._panes.popupPane,this._visible=!1,this._container=i.options.drawControlTooltips?L.DomUtil.create("div","leaflet-draw-tooltip",this._popupPane):null,this._singleLineLabel=!1,this._map.on("mouseout",this._onMouseOut,this)},dispose:function(){this._map.off("mouseout",this._onMouseOut,this),this._container&&(this._popupPane.removeChild(this._container),this._container=null)},updateContent:function(i){return this._container?(i.subtext=i.subtext||"",i.subtext.length!==0||this._singleLineLabel?i.subtext.length>0&&this._singleLineLabel&&(L.DomUtil.removeClass(this._container,"leaflet-draw-tooltip-single"),this._singleLineLabel=!1):(L.DomUtil.addClass(this._container,"leaflet-draw-tooltip-single"),this._singleLineLabel=!0),this._container.innerHTML=(i.subtext.length>0?'<span class="leaflet-draw-tooltip-subtext">'+i.subtext+"</span><br />":"")+"<span>"+i.text+"</span>",i.text||i.subtext?(this._visible=!0,this._container.style.visibility="inherit"):(this._visible=!1,this._container.style.visibility="hidden"),this):this},updatePosition:function(i){var r=this._map.latLngToLayerPoint(i),d=this._container;return this._container&&(this._visible&&(d.style.visibility="inherit"),L.DomUtil.setPosition(d,r)),this},showAsError:function(){return this._container&&L.DomUtil.addClass(this._container,"leaflet-error-draw-tooltip"),this},removeError:function(){return this._container&&L.DomUtil.removeClass(this._container,"leaflet-error-draw-tooltip"),this},_onMouseOut:function(){this._container&&(this._container.style.visibility="hidden")}}),L.DrawToolbar=L.Toolbar.extend({statics:{TYPE:"draw"},options:{polyline:{},polygon:{},rectangle:{},circle:{},marker:{},circlemarker:{}},initialize:function(i){for(var r in this.options)this.options.hasOwnProperty(r)&&i[r]&&(i[r]=L.extend({},this.options[r],i[r]));this._toolbarClass="leaflet-draw-draw",L.Toolbar.prototype.initialize.call(this,i)},getModeHandlers:function(i){return[{enabled:this.options.polyline,handler:new L.Draw.Polyline(i,this.options.polyline),title:L.drawLocal.draw.toolbar.buttons.polyline},{enabled:this.options.polygon,handler:new L.Draw.Polygon(i,this.options.polygon),title:L.drawLocal.draw.toolbar.buttons.polygon},{enabled:this.options.rectangle,handler:new L.Draw.Rectangle(i,this.options.rectangle),title:L.drawLocal.draw.toolbar.buttons.rectangle},{enabled:this.options.circle,handler:new L.Draw.Circle(i,this.options.circle),title:L.drawLocal.draw.toolbar.buttons.circle},{enabled:this.options.marker,handler:new L.Draw.Marker(i,this.options.marker),title:L.drawLocal.draw.toolbar.buttons.marker},{enabled:this.options.circlemarker,handler:new L.Draw.CircleMarker(i,this.options.circlemarker),title:L.drawLocal.draw.toolbar.buttons.circlemarker}]},getActions:function(i){return[{enabled:i.completeShape,title:L.drawLocal.draw.toolbar.finish.title,text:L.drawLocal.draw.toolbar.finish.text,callback:i.completeShape,context:i},{enabled:i.deleteLastVertex,title:L.drawLocal.draw.toolbar.undo.title,text:L.drawLocal.draw.toolbar.undo.text,callback:i.deleteLastVertex,context:i},{title:L.drawLocal.draw.toolbar.actions.title,text:L.drawLocal.draw.toolbar.actions.text,callback:this.disable,context:this}]},setOptions:function(i){L.setOptions(this,i);for(var r in this._modes)this._modes.hasOwnProperty(r)&&i.hasOwnProperty(r)&&this._modes[r].handler.setOptions(i[r])}}),L.EditToolbar=L.Toolbar.extend({statics:{TYPE:"edit"},options:{edit:{selectedPathOptions:{dashArray:"10, 10",fill:!0,fillColor:"#fe57a1",fillOpacity:.1,maintainColor:!1}},remove:{},poly:null,featureGroup:null},initialize:function(i){i.edit&&(i.edit.selectedPathOptions===void 0&&(i.edit.selectedPathOptions=this.options.edit.selectedPathOptions),i.edit.selectedPathOptions=L.extend({},this.options.edit.selectedPathOptions,i.edit.selectedPathOptions)),i.remove&&(i.remove=L.extend({},this.options.remove,i.remove)),i.poly&&(i.poly=L.extend({},this.options.poly,i.poly)),this._toolbarClass="leaflet-draw-edit",L.Toolbar.prototype.initialize.call(this,i),this._selectedFeatureCount=0},getModeHandlers:function(i){var r=this.options.featureGroup;return[{enabled:this.options.edit,handler:new L.EditToolbar.Edit(i,{featureGroup:r,selectedPathOptions:this.options.edit.selectedPathOptions,poly:this.options.poly}),title:L.drawLocal.edit.toolbar.buttons.edit},{enabled:this.options.remove,handler:new L.EditToolbar.Delete(i,{featureGroup:r}),title:L.drawLocal.edit.toolbar.buttons.remove}]},getActions:function(i){var r=[{title:L.drawLocal.edit.toolbar.actions.save.title,text:L.drawLocal.edit.toolbar.actions.save.text,callback:this._save,context:this},{title:L.drawLocal.edit.toolbar.actions.cancel.title,text:L.drawLocal.edit.toolbar.actions.cancel.text,callback:this.disable,context:this}];return i.removeAllLayers&&r.push({title:L.drawLocal.edit.toolbar.actions.clearAll.title,text:L.drawLocal.edit.toolbar.actions.clearAll.text,callback:this._clearAllLayers,context:this}),r},addToolbar:function(i){var r=L.Toolbar.prototype.addToolbar.call(this,i);return this._checkDisabled(),this.options.featureGroup.on("layeradd layerremove",this._checkDisabled,this),r},removeToolbar:function(){this.options.featureGroup.off("layeradd layerremove",this._checkDisabled,this),L.Toolbar.prototype.removeToolbar.call(this)},disable:function(){this.enabled()&&(this._activeMode.handler.revertLayers(),L.Toolbar.prototype.disable.call(this))},_save:function(){this._activeMode.handler.save(),this._activeMode&&this._activeMode.handler.disable()},_clearAllLayers:function(){this._activeMode.handler.removeAllLayers(),this._activeMode&&this._activeMode.handler.disable()},_checkDisabled:function(){var i,r=this.options.featureGroup,d=r.getLayers().length!==0;this.options.edit&&(i=this._modes[L.EditToolbar.Edit.TYPE].button,d?L.DomUtil.removeClass(i,"leaflet-disabled"):L.DomUtil.addClass(i,"leaflet-disabled"),i.setAttribute("title",d?L.drawLocal.edit.toolbar.buttons.edit:L.drawLocal.edit.toolbar.buttons.editDisabled)),this.options.remove&&(i=this._modes[L.EditToolbar.Delete.TYPE].button,d?L.DomUtil.removeClass(i,"leaflet-disabled"):L.DomUtil.addClass(i,"leaflet-disabled"),i.setAttribute("title",d?L.drawLocal.edit.toolbar.buttons.remove:L.drawLocal.edit.toolbar.buttons.removeDisabled))}}),L.EditToolbar.Edit=L.Handler.extend({statics:{TYPE:"edit"},initialize:function(i,r){if(L.Handler.prototype.initialize.call(this,i),L.setOptions(this,r),this._featureGroup=r.featureGroup,!(this._featureGroup instanceof L.FeatureGroup))throw new Error("options.featureGroup must be a L.FeatureGroup");this._uneditedLayerProps={},this.type=L.EditToolbar.Edit.TYPE;var d=L.version.split(".");parseInt(d[0],10)===1&&parseInt(d[1],10)>=2?L.EditToolbar.Edit.include(L.Evented.prototype):L.EditToolbar.Edit.include(L.Mixin.Events)},enable:function(){!this._enabled&&this._hasAvailableLayers()&&(this.fire("enabled",{handler:this.type}),this._map.fire(L.Draw.Event.EDITSTART,{handler:this.type}),L.Handler.prototype.enable.call(this),this._featureGroup.on("layeradd",this._enableLayerEdit,this).on("layerremove",this._disableLayerEdit,this))},disable:function(){this._enabled&&(this._featureGroup.off("layeradd",this._enableLayerEdit,this).off("layerremove",this._disableLayerEdit,this),L.Handler.prototype.disable.call(this),this._map.fire(L.Draw.Event.EDITSTOP,{handler:this.type}),this.fire("disabled",{handler:this.type}))},addHooks:function(){var i=this._map;i&&(i.getContainer().focus(),this._featureGroup.eachLayer(this._enableLayerEdit,this),this._tooltip=new L.Draw.Tooltip(this._map),this._tooltip.updateContent({text:L.drawLocal.edit.handlers.edit.tooltip.text,subtext:L.drawLocal.edit.handlers.edit.tooltip.subtext}),i._editTooltip=this._tooltip,this._updateTooltip(),this._map.on("mousemove",this._onMouseMove,this).on("touchmove",this._onMouseMove,this).on("MSPointerMove",this._onMouseMove,this).on(L.Draw.Event.EDITVERTEX,this._updateTooltip,this))},removeHooks:function(){this._map&&(this._featureGroup.eachLayer(this._disableLayerEdit,this),this._uneditedLayerProps={},this._tooltip.dispose(),this._tooltip=null,this._map.off("mousemove",this._onMouseMove,this).off("touchmove",this._onMouseMove,this).off("MSPointerMove",this._onMouseMove,this).off(L.Draw.Event.EDITVERTEX,this._updateTooltip,this))},revertLayers:function(){this._featureGroup.eachLayer(function(i){this._revertLayer(i)},this)},save:function(){var i=new L.LayerGroup;this._featureGroup.eachLayer(function(r){r.edited&&(i.addLayer(r),r.edited=!1)}),this._map.fire(L.Draw.Event.EDITED,{layers:i})},_backupLayer:function(i){var r=L.Util.stamp(i);this._uneditedLayerProps[r]||(i instanceof L.Polyline||i instanceof L.Polygon||i instanceof L.Rectangle?this._uneditedLayerProps[r]={latlngs:L.LatLngUtil.cloneLatLngs(i.getLatLngs())}:i instanceof L.Circle?this._uneditedLayerProps[r]={latlng:L.LatLngUtil.cloneLatLng(i.getLatLng()),radius:i.getRadius()}:(i instanceof L.Marker||i instanceof L.CircleMarker)&&(this._uneditedLayerProps[r]={latlng:L.LatLngUtil.cloneLatLng(i.getLatLng())}))},_getTooltipText:function(){return{text:L.drawLocal.edit.handlers.edit.tooltip.text,subtext:L.drawLocal.edit.handlers.edit.tooltip.subtext}},_updateTooltip:function(){this._tooltip.updateContent(this._getTooltipText())},_revertLayer:function(i){var r=L.Util.stamp(i);i.edited=!1,this._uneditedLayerProps.hasOwnProperty(r)&&(i instanceof L.Polyline||i instanceof L.Polygon||i instanceof L.Rectangle?i.setLatLngs(this._uneditedLayerProps[r].latlngs):i instanceof L.Circle?(i.setLatLng(this._uneditedLayerProps[r].latlng),i.setRadius(this._uneditedLayerProps[r].radius)):(i instanceof L.Marker||i instanceof L.CircleMarker)&&i.setLatLng(this._uneditedLayerProps[r].latlng),i.fire("revert-edited",{layer:i}))},_enableLayerEdit:function(i){var r,d,p=i.layer||i.target||i;this._backupLayer(p),this.options.poly&&(d=L.Util.extend({},this.options.poly),p.options.poly=d),this.options.selectedPathOptions&&(r=L.Util.extend({},this.options.selectedPathOptions),r.maintainColor&&(r.color=p.options.color,r.fillColor=p.options.fillColor),p.options.original=L.extend({},p.options),p.options.editing=r),p instanceof L.Marker?(p.editing&&p.editing.enable(),p.dragging.enable(),p.on("dragend",this._onMarkerDragEnd).on("touchmove",this._onTouchMove,this).on("MSPointerMove",this._onTouchMove,this).on("touchend",this._onMarkerDragEnd,this).on("MSPointerUp",this._onMarkerDragEnd,this)):p.editing.enable()},_disableLayerEdit:function(i){var r=i.layer||i.target||i;r.edited=!1,r.editing&&r.editing.disable(),delete r.options.editing,delete r.options.original,this._selectedPathOptions&&(r instanceof L.Marker?this._toggleMarkerHighlight(r):(r.setStyle(r.options.previousOptions),delete r.options.previousOptions)),r instanceof L.Marker?(r.dragging.disable(),r.off("dragend",this._onMarkerDragEnd,this).off("touchmove",this._onTouchMove,this).off("MSPointerMove",this._onTouchMove,this).off("touchend",this._onMarkerDragEnd,this).off("MSPointerUp",this._onMarkerDragEnd,this)):r.editing.disable()},_onMouseMove:function(i){this._tooltip.updatePosition(i.latlng)},_onMarkerDragEnd:function(i){var r=i.target;r.edited=!0,this._map.fire(L.Draw.Event.EDITMOVE,{layer:r})},_onTouchMove:function(i){var r=i.originalEvent.changedTouches[0],d=this._map.mouseEventToLayerPoint(r),p=this._map.layerPointToLatLng(d);i.target.setLatLng(p)},_hasAvailableLayers:function(){return this._featureGroup.getLayers().length!==0}}),L.EditToolbar.Delete=L.Handler.extend({statics:{TYPE:"remove"},initialize:function(i,r){if(L.Handler.prototype.initialize.call(this,i),L.Util.setOptions(this,r),this._deletableLayers=this.options.featureGroup,!(this._deletableLayers instanceof L.FeatureGroup))throw new Error("options.featureGroup must be a L.FeatureGroup");this.type=L.EditToolbar.Delete.TYPE;var d=L.version.split(".");parseInt(d[0],10)===1&&parseInt(d[1],10)>=2?L.EditToolbar.Delete.include(L.Evented.prototype):L.EditToolbar.Delete.include(L.Mixin.Events)},enable:function(){!this._enabled&&this._hasAvailableLayers()&&(this.fire("enabled",{handler:this.type}),this._map.fire(L.Draw.Event.DELETESTART,{handler:this.type}),L.Handler.prototype.enable.call(this),this._deletableLayers.on("layeradd",this._enableLayerDelete,this).on("layerremove",this._disableLayerDelete,this))},disable:function(){this._enabled&&(this._deletableLayers.off("layeradd",this._enableLayerDelete,this).off("layerremove",this._disableLayerDelete,this),L.Handler.prototype.disable.call(this),this._map.fire(L.Draw.Event.DELETESTOP,{handler:this.type}),this.fire("disabled",{handler:this.type}))},addHooks:function(){var i=this._map;i&&(i.getContainer().focus(),this._deletableLayers.eachLayer(this._enableLayerDelete,this),this._deletedLayers=new L.LayerGroup,this._tooltip=new L.Draw.Tooltip(this._map),this._tooltip.updateContent({text:L.drawLocal.edit.handlers.remove.tooltip.text}),this._map.on("mousemove",this._onMouseMove,this))},removeHooks:function(){this._map&&(this._deletableLayers.eachLayer(this._disableLayerDelete,this),this._deletedLayers=null,this._tooltip.dispose(),this._tooltip=null,this._map.off("mousemove",this._onMouseMove,this))},revertLayers:function(){this._deletedLayers.eachLayer(function(i){this._deletableLayers.addLayer(i),i.fire("revert-deleted",{layer:i})},this)},save:function(){this._map.fire(L.Draw.Event.DELETED,{layers:this._deletedLayers})},removeAllLayers:function(){this._deletableLayers.eachLayer(function(i){this._removeLayer({layer:i})},this),this.save()},_enableLayerDelete:function(i){(i.layer||i.target||i).on("click",this._removeLayer,this)},_disableLayerDelete:function(i){var r=i.layer||i.target||i;r.off("click",this._removeLayer,this),this._deletedLayers.removeLayer(r)},_removeLayer:function(i){var r=i.layer||i.target||i;this._deletableLayers.removeLayer(r),this._deletedLayers.addLayer(r),r.fire("deleted")},_onMouseMove:function(i){this._tooltip.updatePosition(i.latlng)},_hasAvailableLayers:function(){return this._deletableLayers.getLayers().length!==0}})})(window,document);function An(a){for(var n=1;n<arguments.length;n++){var h=arguments[n]!=null?arguments[n]:{},s=Object.keys(h);typeof Object.getOwnPropertySymbols=="function"&&(s=s.concat(Object.getOwnPropertySymbols(h).filter(function(i){return Object.getOwnPropertyDescriptor(h,i).enumerable}))),s.forEach(function(i){Kn(a,i,h[i])})}return a}function Ti(a){return typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?Ti=function(h){return typeof h}:Ti=function(h){return h&&typeof Symbol=="function"&&h.constructor===Symbol&&h!==Symbol.prototype?"symbol":typeof h},Ti(a)}function Mu(a,n){if(!(a instanceof n))throw new TypeError("Cannot call a class as a function")}function ju(a,n){for(var h=0;h<n.length;h++){var s=n[h];s.enumerable=s.enumerable||!1,s.configurable=!0,"value"in s&&(s.writable=!0),Object.defineProperty(a,s.key,s)}}function Su(a,n,h){return n&&ju(a.prototype,n),a}function Cu(a,n){return n&&(Ti(n)==="object"||typeof n=="function")?n:Zn(a)}function je(a,n,h){return typeof Reflect<"u"&&Reflect.get?je=Reflect.get:je=function(i,r,d){var p=Du(i,r);if(p){var _=Object.getOwnPropertyDescriptor(p,r);return _.get?_.get.call(d):_.value}},je(a,n,h||a)}function Du(a,n){for(;!Object.prototype.hasOwnProperty.call(a,n)&&(a=he(a),a!==null););return a}function he(a){return he=Object.setPrototypeOf?Object.getPrototypeOf:function(h){return h.__proto__||Object.getPrototypeOf(h)},he(a)}function Nu(a,n){if(typeof n!="function"&&n!==null)throw new TypeError("Super expression must either be null or a function");a.prototype=Object.create(n&&n.prototype,{constructor:{value:a,writable:!0,configurable:!0}}),n&&Bn(a,n)}function Bn(a,n){return Bn=Object.setPrototypeOf||function(s,i){return s.__proto__=i,s},Bn(a,n)}function Zn(a){if(a===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return a}function Kn(a,n,h){return n in a?Object.defineProperty(a,n,{value:h,enumerable:!0,configurable:!0,writable:!0}):a[n]=h,a}var Qe={onEdited:"draw:edited",onDrawStart:"draw:drawstart",onDrawStop:"draw:drawstop",onDrawVertex:"draw:drawvertex",onEditStart:"draw:editstart",onEditMove:"draw:editmove",onEditResize:"draw:editresize",onEditVertex:"draw:editvertex",onEditStop:"draw:editstop",onDeleted:"draw:deleted",onDeleteStart:"draw:deletestart",onDeleteStop:"draw:deletestop"},Cr=function(a){Nu(n,a);function n(){var h,s;Mu(this,n);for(var i=arguments.length,r=new Array(i),d=0;d<i;d++)r[d]=arguments[d];return s=Cu(this,(h=he(n)).call.apply(h,[this].concat(r))),Kn(Zn(Zn(s)),"onDrawCreate",function(p){var _=s.props.onCreated,g=s.props.leaflet.layerContainer;g.addLayer(p.layer),_&&_(p)}),s}return Su(n,[{key:"createLeafletElement",value:function(s){return lr(s)}},{key:"componentDidMount",value:function(){je(he(n.prototype),"componentDidMount",this).call(this);var s=this.props.leaflet.map,i=this.props.onMounted;for(var r in Qe)this.props[r]&&s.on(Qe[r],this.props[r]);s.on(bt.Draw.Event.CREATED,this.onDrawCreate),i&&i(this.leafletElement)}},{key:"componentWillUnmount",value:function(){je(he(n.prototype),"componentWillUnmount",this).call(this);var s=this.props.leaflet.map;s.off(bt.Draw.Event.CREATED,this.onDrawCreate);for(var i in Qe)this.props[i]&&s.off(Qe[i],this.props[i])}},{key:"componentDidUpdate",value:function(s){if(je(he(n.prototype),"componentDidUpdate",this).call(this,s),Wn(this.props.draw,s.draw)||this.props.position!==s.position)return!1;var i=this.props.leaflet.map;return this.leafletElement.remove(i),this.leafletElement=lr(this.props),this.leafletElement.addTo(i),null}}]),n}(De);Kn(Cr,"propTypes",An({},Object.keys(Qe).reduce(function(a,n){return a[n]=X.PropTypes.func,a},{}),{onCreated:X.PropTypes.func,onMounted:X.PropTypes.func,draw:X.PropTypes.shape({polyline:X.PropTypes.oneOfType([X.PropTypes.object,X.PropTypes.bool]),polygon:X.PropTypes.oneOfType([X.PropTypes.object,X.PropTypes.bool]),rectangle:X.PropTypes.oneOfType([X.PropTypes.object,X.PropTypes.bool]),circle:X.PropTypes.oneOfType([X.PropTypes.object,X.PropTypes.bool]),marker:X.PropTypes.oneOfType([X.PropTypes.object,X.PropTypes.bool])}),edit:X.PropTypes.shape({edit:X.PropTypes.oneOfType([X.PropTypes.object,X.PropTypes.bool]),remove:X.PropTypes.oneOfType([X.PropTypes.object,X.PropTypes.bool]),poly:X.PropTypes.oneOfType([X.PropTypes.object,X.PropTypes.bool]),allowIntersection:X.PropTypes.bool}),position:X.PropTypes.oneOf(["topright","topleft","bottomright","bottomleft"]),leaflet:X.PropTypes.shape({map:X.PropTypes.instanceOf(rt.Map),layerContainer:X.PropTypes.shape({addLayer:X.PropTypes.func.isRequired,removeLayer:X.PropTypes.func.isRequired})})}));function lr(a){var n=a.leaflet.layerContainer,h=a.draw,s=a.edit,i=a.position,r={edit:An({},s,{featureGroup:n})};return h&&(r.draw=An({},h)),i&&(r.position=i),new rt.Control.Draw(r)}const zu=dt(Cr);var Iu=function a(n,h){if(n===h)return!0;if(n&&h&&typeof n=="object"&&typeof h=="object"){if(n.constructor!==h.constructor)return!1;var s,i,r;if(Array.isArray(n)){if(s=n.length,s!=h.length)return!1;for(i=s;i--!==0;)if(!a(n[i],h[i]))return!1;return!0}if(n.constructor===RegExp)return n.source===h.source&&n.flags===h.flags;if(n.valueOf!==Object.prototype.valueOf)return n.valueOf()===h.valueOf();if(n.toString!==Object.prototype.toString)return n.toString()===h.toString();if(r=Object.keys(n),s=r.length,s!==Object.keys(h).length)return!1;for(i=s;i--!==0;)if(!Object.prototype.hasOwnProperty.call(h,r[i]))return!1;for(i=s;i--!==0;){var d=r[i];if(!a(n[d],h[d]))return!1}return!0}return n!==n&&h!==h};const Ru=dr(Iu);bt.TileLayer.BetterWMS=bt.TileLayer.WMS.extend({initialize:function(a,n,h,s){h&&(this._onGetFeatureInfo=h),s&&(this._onFetching=s),bt.TileLayer.WMS.prototype.initialize.call(this,a,n)},onAdd:function(a){bt.TileLayer.WMS.prototype.onAdd.call(this,a),a.on("click",this.getFeatureInfo,this)},onRemove:function(a){bt.TileLayer.WMS.prototype.onRemove.call(this,a),a.off("click",this.getFeatureInfo,this)},getFeatureInfo:function(a){var n=this.getFeatureInfoUrl(a.latlng),h=bt.Util.bind(this.showGetFeatureInfo,this);this._onFetching(!0),fetch(n).then(s=>s.json()).then(s=>{this._onFetching(!1),h(typeof s=="object"?null:s,a.latlng,s)})},getFeatureInfoUrl:function(a){var n=this._map.latLngToContainerPoint(a,this._map.getZoom()),h=this._map.getSize(),s={request:"GetFeatureInfo",service:"WMS",srs:"EPSG:4326",styles:this.wmsParams.styles,transparent:this.wmsParams.transparent,version:this.wmsParams.version,format:this.wmsParams.format,bbox:this._map.getBounds().toBBoxString(),height:h.y,width:h.x,layers:this.wmsParams.layers,query_layers:this.wmsParams.layers,info_format:"application/json"};return s[s.version==="1.3.0"?"i":"x"]=Math.round(n.x),s[s.version==="1.3.0"?"j":"y"]=Math.round(n.y),this._url+bt.Util.getParamString(s,this._url,!0)},showGetFeatureInfo:function(a,n,h){if(a){console.log(a);return}this._onGetFeatureInfo(h,n)}});bt.tileLayer.betterWms=function(a,n){return new bt.TileLayer.BetterWMS(a,n)};const Au=/^on(.+)$/i;class Bu extends Ni{createLeafletElement(n){let{url:h,onGetFeatureInfo:s,onFetching:i,...r}=n;r.cql_filter===null&&delete r.cql_filter;const{leaflet:d,...p}=this.getOptions(r);return new bt.TileLayer.BetterWMS(h,p,s,i)}updateLeafletElement(n,h){super.updateLeafletElement(n,h);const{url:s,opacity:i,zIndex:r,...d}=n,{leaflet:p,..._}=this.getOptions(d),{url:g,opacity:b,zIndex:T,...O}=h,{leaflet:H,...M}=this.getOptions(O);g!==s&&(console.log(g),this.leafletElement.setUrl(g)),Ru(M,_)||(console.log("AQUI"),M.cql_filter===null&&(M.cql_filter="INCLUDE"),this.leafletElement.setParams(M))}getOptions(n){const h=super.getOptions(n);return Object.keys(h).reduce((s,i)=>(Au.test(i)||(s[i]=h[i]),s),{})}}const Zu=dt(Bu),$u=[-15.559793,-56.58506],Uu=4;function Fu({initialGeoms:a,initialBBOX:n,templateLayers:h,onSave:s,onEdit:i,isEditing:r,onCancel:d}){const p=w.useRef(),_=w.useRef(),g=w.useRef(),{server:b}=ee(),{enqueueSnackbar:T,closeSnackbar:O}=ue(),[H,M]=w.useState(null),[G,v]=w.useState(!1),[Z,D]=w.useState(null),[z,k]=w.useState(!1);w.useEffect(()=>{!n||!p||!p.current||p.current.leafletElement.fitBounds(n)},[n]),w.useEffect(()=>{!a||!_.current||(_.current.leafletElement.eachLayer(S=>{_.current.leafletElement.removeLayer(S)}),a.forEach(S=>{const W=new bt.GeoJSON(S);console.log(S),W.eachLayer(et=>{_.current.leafletElement.addLayer(et)})}))},[a]),w.useEffect(()=>{G&&M(null)},[G]);const j=()=>{const S=_.current.leafletElement.toGeoJSON();s(S)},P=()=>{M(null),d()},I=()=>{g.current.click()},Y=async S=>{const W=new FormData;W.append("file",S);const{data:{geojson:et}}=await ut.post(`${b}project/upload-shp`,W);new bt.GeoJSON(et).eachLayer(R=>{_.current.leafletElement.addLayer(R)}),p.current.leafletElement.fitBounds(_.current.leafletElement.getBounds())},at=S=>{},A=S=>{if(S&&S.features&&S.features[0]&&S.features[0])for(let W of S.features[0].geometry.coordinates){let et={...S.features[0]};et.geometry.type="Polygon",et.geometry.coordinates=W,new bt.GeoJSON(et).eachLayer(R=>{_.current.leafletElement.addLayer(R)})}},K=S=>{H===S?(M(null),D(null)):M(S)},B=async S=>{const W=T("Carregando...",{persist:!0,anchorOrigin:{vertical:"top",horizontal:"right"}}),{data:et}=await ut.get(`${b}municipio/${S}/feature`);et.forEach(xt=>{const R=new bt.GeoJSON(xt);console.log(xt),R.eachLayer(fe=>{_.current.leafletElement.addLayer(fe)})}),O(W),D(null),k(!1)},$=async S=>{D(`cd_mun=${S}`);const W=T("Carregando...",{persist:!0,anchorOrigin:{vertical:"top",horizontal:"right"}}),{data:et}=await ut.get(`${b}municipio/${S}/bbox`);O(W);const xt=[[et.y1,et.x1],[et.y2,et.x2]];p&&p.current&&p.current.leafletElement.fitBounds(xt)},lt=()=>{D(null)};return c.jsxs(c.Fragment,{children:[c.jsx("input",{type:"file",ref:g,style:{display:"none"},name:"file",onChange:S=>Y(S.target.files[0])}),c.jsxs(Or,{id:"map-container",center:$u,zoom:Uu,ref:p,maxZoom:18,minZoom:3,children:[c.jsx(Pr,{ref:_,children:r&&c.jsxs(c.Fragment,{children:[c.jsx(zu,{position:"topright",onEditStart:()=>v(!0),onDeleteStart:()=>v(!0),onDrawStart:()=>v(!0),onEditStop:()=>v(!1),onDeleteStop:()=>v(!1),onDrawStop:()=>v(!1),draw:{marker:!1,circlemarker:!1,polyline:!1}}),c.jsx(Je,{position:"topright",children:c.jsx("button",{disabled:G,onClick:I,children:"Enviar (shp)"})}),c.jsx(Je,{position:"topright",children:c.jsx("div",{style:{display:"flex",flexDirection:"column",alignItems:"self-end"},children:h.map((S,W)=>c.jsxs("div",{children:[c.jsx("button",{disabled:G||H!==null&&H!==W,onClick:()=>K(W),children:S.name}),S.search&&H===W&&c.jsx("button",{onClick:()=>k(!z),children:"..."})]},W))})})]})}),r&&c.jsxs(c.Fragment,{children:[c.jsx(Je,{position:"bottomright",children:c.jsx("button",{disabled:G,className:"action save",onClick:j,children:"Gravar"})}),c.jsx(Je,{position:"bottomright",children:c.jsx("button",{disabled:G,className:"action cancel",onClick:P,children:"Sair"})})]}),!r&&c.jsx(Je,{position:"bottomright",children:c.jsx("button",{className:"action",onClick:()=>i(!0),children:"Editar"})}),c.jsx(Mr,{attribution:'<a href="http://www.openstreetmap.org/copyright">OpenStreetMap</a>',url:"https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png"}),h.map((S,W)=>c.jsx(w.Fragment,{children:H===W&&c.jsx(Zu,{url:S.url,layers:S.layers,format:"image/png",transparent:!0,onGetFeatureInfo:A,onFetching:at,cql_filter:Z})},W))]}),c.jsx(Hu,{show:z,onClose:()=>k(!1),onAdd:B,onFind:$,onRemove:lt,hasFilter:!!Z})]})}function Hu({show:a,onClose:n,onFind:h,onAdd:s,onRemove:i,hasFilter:r}){const[d,p]=w.useState(null);return c.jsxs(Oi,{open:a,onClose:n,"aria-labelledby":"alert-dialog-title","aria-describedby":"alert-dialog-description",maxWidth:"xs",fullWidth:!0,children:[c.jsx(ki,{id:"alert-dialog-title",children:"Encontrar municipio"}),c.jsxs(Se,{children:[c.jsx("div",{className:"row",children:c.jsx("div",{className:"col-xs-6",children:c.jsx(te,{label:"Municipio",url:"municipio",query:"?uf=1",onChange:(_,g)=>{p(g==null?void 0:g.value),g!=null&&g.value&&i()},value:d})})}),r&&c.jsx("div",{className:"row",children:c.jsx("div",{className:"col-xs-12",style:{fontWeight:"bold",color:"#b34747"},children:"Você deve clicar no municipio para incluí-lo!"})})]}),c.jsxs(Mi,{children:[!r&&d&&c.jsx("button",{className:"button-outline",onClick:()=>d&&h(d),children:"Filtrar"}),r&&c.jsx("button",{className:"button-outline",onClick:()=>i(),children:"Remover filtro"}),c.jsx("button",{className:"button-outline",onClick:n,children:"Fechar"})]})]})}const Gu=[{name:"Municipíos",url:"https://geoserver.monitoraea.org.br/geoserver/pppzcm/wms?",layers:"pppzcm:municipios",search:!0},{name:"Estados",url:"https://geoserver.monitoraea.org.br/geoserver/pppzcm/wms?",layers:"pppzcm:ufs"},{name:"Bacias (nível 5)",url:"https://geoservicos.ibge.gov.br/geoserver/ows",layers:"CREN:bacias_nivel_5"}];async function hr(a,n){const{data:{geoms:h,bbox:s}}=await ut.get(`${a}project/${n}/geo-draw`);return console.log({geoms:h,bbox:s}),{geoms:h,bbox:s}}function Wu(){const a=ji(),{server:n}=ee(),{currentCommunity:h}=ii(),{enqueueSnackbar:s,closeSnackbar:i}=ue(),[r,d]=w.useState(null),[p,_]=w.useState(null),[g,b]=w.useState(""),[T,O]=w.useState(!1);w.useEffect(()=>{async function j(){const{data:{id:P}}=await ut.get(`${n}project/id_from_community/${h.id}`);d(P)}j()},[h.id,n]);const[H,M]=w.useState(null),[G,v]=w.useState(null);w.useEffect(()=>{async function j(){const{data:{atuacao_aplica:P,atuacao_naplica_just:I}}=await ut.get(`${n}project/${r}/geo-draw/has-geo`);_(P),b(I||"")}r&&j()},[r,n]),w.useEffect(()=>{async function j(){const{geoms:P,bbox:I}=await hr(n,r);M(P),I[0][0]&&v(I)}p&&j()},[p,r,n]);const Z=async()=>{const j=s("Voltando...",{persist:!0,anchorOrigin:{vertical:"top",horizontal:"right"}}),{geoms:P,bbox:I}=await hr(n,r);M(P),I[0][0]&&v(I),i(j),O(!1)},D=async j=>{const P=j.features.map(({geometry:Y})=>Y),I=s("Gravando...",{persist:!0,anchorOrigin:{vertical:"top",horizontal:"right"}});await ut.post(`${n}project/${r}/geo-draw`,{geoms:P}),i(I),s("Atuação gravado com sucesso!",{variant:"success",anchorOrigin:{vertical:"top",horizontal:"right"}})},z=async j=>{console.log({checked:j});const P=s("Gravando...",{persist:!0,anchorOrigin:{vertical:"top",horizontal:"right"}});await ut.put(`${n}project/${r}/geo-draw/${j?j==="none"?"none":"1":"0"}`),a.invalidateQueries("project_indics"),i(P),_(j)},k=async()=>{const j=s("Gravando...",{persist:!0,anchorOrigin:{vertical:"top",horizontal:"right"}});return await ut.put(`${n}project/${r}/draft/justification`,{value:g}),a.invalidateQueries("project_indics"),i(j),!0};return c.jsx("div",{className:"page-content",children:c.jsx("div",{className:"page-body",children:c.jsx($n,{middle:!0,headerless:!0,children:c.jsxs("div",{className:"p-3",children:[c.jsxs("div",{style:{display:"flex",justifyContent:"space-between"},children:[c.jsxs(Vu,{children:[c.jsx("div",{children:"É possivel representar este projeto de geograficamente?"}),c.jsx(At,{children:c.jsxs(ti,{className:"input-select",value:p===null?"none":p,onChange:j=>z(j.target.value),children:[c.jsx(nt,{value:"none",children:" -- selecione -- "}),c.jsx(nt,{value:!0,children:"Sim"}),c.jsx(nt,{value:!1,children:"Não"})]})})]}),c.jsx(Ci,{tab:"atuacao"})]}),p===!0&&c.jsx(Fu,{initialGeoms:H,initialBBOX:G,templateLayers:Gu,isEditing:T,onEdit:j=>O(j),onSave:D,onCancel:Z}),p===!1&&c.jsxs("section",{id:"details",children:[c.jsxs("div",{className:"section-header",children:[c.jsx("div",{className:"section-title",children:"Justificativa"}),c.jsx("div",{className:"section-actions",children:c.jsxs("button",{className:"button-primary",onClick:()=>k(),children:[c.jsx(ei,{}),"Gravar"]})})]}),c.jsx("div",{className:"row",children:c.jsx("div",{className:"col-xs-12",children:c.jsx(ht,{className:"input-text",value:g||"",onChange:j=>b(j.target.value),multiline:!0,rows:4})})})]})]})})})})}const Vu=Ls.div`
  display: flex;
  margin-bottom: 20px;
  justify-content: end;
  align-items: center;
  div {
    margin-right: 10px;
  }
`;function cr(){return c.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[c.jsx("path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4"}),c.jsx("polyline",{points:"7 10 12 15 17 10"}),c.jsx("line",{x1:"12",y1:"15",x2:"12",y2:"3"})]})}const qu="_button_delete_lccbr_45",Yu="_Roll_lccbr_1",Ku="_term_lccbr_82",Dr={button_delete:qu,Roll:Yu,term:Ku},yd=()=>{const{currentCommunity:a,changeRoute:n,params:h}=ii(),{server:s}=ee(),{user:i,updateUser:r}=Ha(),{enqueueSnackbar:d,closeSnackbar:p}=ue(),[_,g]=w.useState(null),[b,T]=w.useState(!1),[O,H]=w.useState(null),[M,G]=w.useState(null),[v,Z]=w.useState(!1),[D,z]=w.useState(!1),[k,j]=w.useState(!1),{data:P}=Vt(["project",{currentCommunity:a.id}],{queryFn:async()=>(await ut.get(`${s}project/id_from_community/${a.id}`)).data}),{data:I}=Vt(["project_indics",{project_id:P==null?void 0:P.id}],{queryFn:async()=>(await ut.get(`${s}project/${P==null?void 0:P.id}/verify`)).data,enabled:!!(P!=null&&P.id)}),Y={publish:ce(()=>ut.put(`${s}project/${O}/publish`)),remove:ce(()=>ut.delete(`${s}project/${_}`))},at=()=>{g(a.id),T(!0)},A=async S=>{if(S==="confirm"){let W=await Y.remove.mutateAsync(_);d("Iniciativa deletada com sucesso!",{variant:"success",anchorOrigin:{vertical:"top",horizontal:"right"}}),n({community:W.data}),r()}g(null),T(!1)};w.useEffect(()=>{j(i.membership.map(S=>S.id===1||S.id===a.id&&S.type==="adm").reduce((S,W)=>S||W))},[k,i,a]),w.useEffect(()=>{P&&H(P.id)},[P]),w.useEffect(()=>{G(h&&h.length?h[0]:"informacao")},[h]);const K=()=>{z(!0)},B=S=>{S==="confirm"&&$(),z(!1)},$=async()=>{const S=d("Publicando...",{persist:!0,anchorOrigin:{vertical:"top",horizontal:"right"}});try{const{data:W}=await Y.publish.mutateAsync();if(p(S),W.success)window.location=`${window.location}`,d("Iniciativa publicada com sucesso!",{variant:"success",anchorOrigin:{vertical:"top",horizontal:"right"}});else if(W.reason.code==="not_ready")d(c.jsxs("div",{children:[c.jsx("p",{children:c.jsx("strong",{children:"Esta iniciativa ainda não esta pronta para ser publicado!"})}),c.jsx("p",{children:"Verifique se todos os campos das abas de Informações e Indicadores estão completamente preenchidos."})]}),{variant:"warning",anchorOrigin:{vertical:"top",horizontal:"center"}});else throw new Error("unknown reason")}catch(W){p(S),console.error(W),d("Erro ao publicar a iniciativa!",{variant:"error",anchorOrigin:{vertical:"top",horizontal:"right"}})}},lt=()=>{window.open(`${s}project/${O}/download`,"_blank")};return c.jsxs("div",{className:"page",children:[c.jsxs("div",{className:"page-header",children:[c.jsx(xs,{title:"Iniciativa"}),c.jsxs("div",{className:"page-header-buttons",children:[c.jsxs("button",{className:"button-outline",onClick:lt,children:[c.jsx(cr,{}),"Baixar CSV"]}),c.jsxs("button",{className:"button-outline",onClick:()=>Z(!0),children:[c.jsx(cr,{}),"Baixar GEO (Shapefile)"]}),k&&k===!0&&c.jsxs("button",{className:"button-primary",onClick:K,children:[c.jsx(yr,{}),"Publicar"]}),k&&k===!0&&c.jsxs("button",{className:Dr.button_delete,onClick:at,children:[c.jsx(Fn,{}),"Excluir"]})]})]}),M&&c.jsxs(c.Fragment,{children:[c.jsx(Ms,{defaultTab:M,onTabChange:S=>n({params:[S]}),analysis:I}),O&&c.jsxs(c.Fragment,{children:[M==="informacao"&&c.jsx(Js,{projectId:O}),M==="conexoes"&&c.jsx(Xs,{projectId:O}),M==="indicadores"&&c.jsx(el,{analysis:I}),M==="atuacao"&&c.jsx(Wu,{projectId:O})]})]}),c.jsx(bs,{display:"flex",justifyContent:"space-between"}),c.jsx(pr,{open:b,content:"Confirma a remoção desta iniciativa?",confirmButtonText:"Remover",onClose:A}),c.jsx(Ju,{open:v,onClose:()=>Z(!1)}),c.jsx(Xu,{open:D,onClose:B})]})};function Ju({open:a,onClose:n}){return c.jsx("div",{children:c.jsxs(Oi,{open:a,onClose:n,"aria-labelledby":"alert-dialog-title","aria-describedby":"alert-dialog-description",children:[c.jsx(ki,{id:"alert-dialog-title",children:"Aviso"}),c.jsx(Se,{children:c.jsx(Se,{id:"alert-dialog-description",children:"Este recurso esta em fase de implementação!"})}),c.jsx(Mi,{children:c.jsx("button",{className:"button-primary",onClick:()=>n("cancel"),autoFocus:!0,children:"Fechar"})})]})})}function Xu({open:a,onClose:n}){return c.jsx("div",{children:c.jsxs(Oi,{open:a,onClose:n,"aria-labelledby":"alert-dialog-title","aria-describedby":"alert-dialog-description",fullWidth:!0,maxWidth:"md",children:[c.jsx(ki,{id:"alert-dialog-title",children:"Termo de Adesão ao PPPZCM"}),c.jsx(Se,{children:c.jsxs(Se,{id:"alert-dialog-description",className:Dr.term,children:[c.jsx("p",{children:"Declaro estar ciente e de acordo com as diretrizes político-pedagógicas do PPPZCM e que reconheço o PPPZCM como um instrumento político-pedagógico de gestão de processos educativos estruturantes e continuados com o foco na contribuição da conservação da biodiversidade e uso sustentável da zona costeira e marinha do Brasil."}),c.jsx("p",{children:"Neste sentido, declaro a adesão ao PPPZCM por meio da inserção da ação/projeto ora cadastrada na plataforma MonitoraEA PPPZCM. Declaro que a execução técnica e financeira da referida ação/projeto está sob a responsabilidade integral da instituição proponente. A ação/projeto indicada comporá o eixo operacional do PPPZCM."}),c.jsx("p",{children:"Ainda, declaro concordar com a divulgação pública dos dados da ação/projetos ora inseridos – por meio da plataforma MonitoraEA PPPZCM - e assumo a inteira responsabilidade pelo teor e veracidade das informações cadastradas."}),c.jsx("p",{children:"Por fim, declaro meu consentimento com a coleta, uso e tratamento de meus dados pessoais pela ANPPEA, que atuará como controlador de dados, nos termos da Lei 13.709/2018, e que tenho ciência de que poderei solicitar, a qualquer momento, a exclusão de meus dados do banco de dados da plataforma MonitoraEA PPPZCM, bem como a revogação deste consentimento."})]})}),c.jsxs(Mi,{children:[c.jsx("button",{className:"button-primary",onClick:()=>n("confirm"),children:"Concordo"}),c.jsx(ur,{onClick:()=>n("cancel"),autoFocus:!0,children:"Não concordo"})]})]})})}export{yd as default};
