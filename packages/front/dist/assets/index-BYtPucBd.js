import{b as k,u as z,c as w,d as R,r as o,e as H,n as y,x as E,f as M,j as s}from"./index-DLt25zcS.js";import{B as n}from"./Box-BoG2D6P7.js";const q="_mainDiv_d2yrn_45",Q="_error_d2yrn_50",Y="_actions_d2yrn_53",O="_community_d2yrn_62",B="_maxh_d2yrn_68",F="_title_d2yrn_73",P="_status_d2yrn_77",T="_closed_d2yrn_85",K="_text_d2yrn_89",t={mainDiv:q,error:Q,actions:Y,community:O,maxh:B,title:F,status:P,closed:T,text:K},j={informacao:"Informações",conexoes:"Conexões",indicadores:"Indicadores",atuacao:"Atuação"};function J({data:e}){const{getCommunityData:m,changeRoute:f,currentCommunity:x}=k(),{server:c}=z(),{enqueueSnackbar:l,closeSnackbar:p}=w(),d=R(),[v,b]=o.useState(""),[h,g]=o.useState(""),[N,S]=o.useState(""),[C,A]=o.useState("..."),[$,_]=o.useState(!1),{data:i}=H([`help_status_${e.content.help_id}`,{helpId:e.content.help_id}],{queryFn:async()=>(await y.get(`${c}help/${e.content.help_id}`)).data,enabled:!!e.content});o.useEffect(()=>{async function a(){let r=await m(e.content.communityId);A(r?r.name:"?")}e&&(b(E(e.createdAt).format("DD [de] MMMM [de] YYYY [às] HH:mm")),g(e.user_name),S(e.user_id),a())},[e,c,m]),o.useEffect(()=>{e&&d.invalidateQueries(`help_status_${e.content.help_id}`)},[e,d]);const D={close:M(()=>y.put(`${c}help/${e.content.help_id}/close`,{communityId:e.content.communityId}),{onSuccess:()=>{d.invalidateQueries(`help_status_${e.content.help_id}`)}})},u=()=>{f({community:e.content.communityId,tool:"projeto",params:[e.content.tab]})},I=async()=>{_(!0);const a=l("Resolvendo pedido de ajuda...",{persist:!0,anchorOrigin:{vertical:"top",horizontal:"center"}});try{await D.close.mutateAsync(),p(a),l("Pedido de ajuda resolvido com sucesso!",{variant:"success",anchorOrigin:{vertical:"top",horizontal:"right"}})}catch(r){p(a),_(!1),console.error(r),l("Erro ao resolver pedido de ajuda!",{variant:"error",anchorOrigin:{vertical:"top",horizontal:"right"}})}};return s.jsxs(n,{sx:{padding:"24px",marginTop:"48px",backgroundColor:"white",position:"relative",zIndex:"1",minHeight:"100px",width:"100%",boxShadow:"0px 0px 8px #0000001A",borderRadius:"8px"},children:[s.jsx(n,{sx:{display:"flex",justifyContent:"space-between"},children:s.jsxs(n,{sx:{display:"flex"},children:[s.jsx(n,{as:"img",src:`${c}user/${N}/thumb`,alt:"salve",sx:{borderRadius:"50%",width:"48px",height:"48px"}}),s.jsxs(n,{sx:{marginLeft:"8px"},children:[s.jsx(n,{sx:{fontWeight:"bold",fontSize:"16px"},children:s.jsxs("div",{className:t.title,children:["Pedido de Ajuda",s.jsx(L,{status:i})]})}),s.jsx(n,{sx:{fontSize:"14px"},children:v})]})]})}),s.jsxs(n,{sx:{marginTop:"8px"},children:[x.alias!=="projeto"&&s.jsxs("div",{className:t.mainDiv,children:[s.jsxs("div",{children:[h," de ",s.jsxs("span",{className:t.community,onClick:u,children:['"',C,'"']}),s.jsxs("span",{children:[" pediu uma ajuda para a aba ",s.jsxs("span",{className:t.field,children:['"',j[e.content.tab],'"']})]}),", com o seguinte texto: ",s.jsxs("span",{className:t.text,children:['"',e.content.text,'"']})]}),e&&s.jsxs("div",{className:t.actions,children:[s.jsx("button",{className:"button-outline",size:"small",onClick:u,children:"Acessar"}),i&&!i.closedAt&&s.jsx("button",{className:"button-primary",disabled:$,size:"small",onClick:I,children:"Resolvido"})]})]}),x.alias==="projeto"&&s.jsxs("div",{className:t.mainDiv,children:[s.jsxs("div",{children:[h," pediu uma ajuda para a aba ",s.jsxs("span",{className:t.field,children:['"',j[e.content.tab],'"']}),", com o seguinte texto: ",s.jsxs("span",{className:t.text,children:['"',e.content.text,'"']})]}),e&&i&&!i.closedAt&&s.jsx("div",{className:t.actions,children:s.jsx("button",{className:"button-primary",size:"small",onClick:u,children:"Acessar"})})]})]})]})}function L({status:e}){return e?s.jsx("div",{className:`${t.status} ${e.closedAt?t.closed:""}`,children:e.closedAt?"resolvido":"aberto"}):s.jsx(s.Fragment,{})}export{J as default};
