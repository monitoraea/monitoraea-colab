import{r as s,j as e,u as I,d as L,c as R,e as O,C as z,s as J,n as F,b as U,a as X,p as Y,D as ee,k as ae,l as M,m as te,B as ie}from"./index-7W1X0-fp.js";import{T as se,a as D}from"./Tabs-BbqEWVY-.js";import"./lodash-Ba4guvlw.js";import{m as V,R as G}from"./index-7lRCPYvU.js";import{f as C,l as oe}from"./lists1-BdcWwmFr.js";import"./indics-CgMJSsJ0.js";/* empty css                          */import{C as ne}from"./index-CicgDPHG.js";import{a as W,E as re,D as le}from"./Download-DoNKOpeO.js";import{P as de}from"./PageTitle-B5Guk-9A.js";import"./KeyboardArrowRight-C1ubucs1.js";import"./Plus-LxlK4A0R.js";import"./Trash-DJyh5p-H.js";import"./Popper-DAXMf1d9.js";import"./index-DB8_86U1.js";import"./useThemeProps-D5IlkqSU.js";import"./Autocomplete-rJEHThK9.js";const ce="_backdrop_x4juq_52",me="_indicator_x4juq_85",ue="_warning_x4juq_106",pe="_ready_x4juq_109",_e="_divisor_x4juq_146",fe="_cleanfilters_x4juq_152",v={"projects-tabs":"_projects-tabs_x4juq_45",backdrop:ce,"ptabs-content":"_ptabs-content_x4juq_72","ptabs-tabs":"_ptabs-tabs_x4juq_79",indicator:me,"fixed-size":"_fixed-size_x4juq_85","not-ready":"_not-ready_x4juq_103",warning:ue,ready:pe,"ptabs-actions":"_ptabs-actions_x4juq_119","ptabs-datefilter":"_ptabs-datefilter_x4juq_124","ptabs-datefilter-button":"_ptabs-datefilter-button_x4juq_134",divisor:_e,cleanfilters:fe};function ye({defaultTab:i,onTabChange:n,analysis:f}){const[p,c]=s.useState(!1),r=l=>{n(l.target.id)};return e.jsxs("div",{className:v["projects-tabs"],children:[e.jsx("div",{className:v.backdrop}),e.jsx("div",{className:v["ptabs-content"],children:e.jsxs(se,{className:v["ptabs-tabs"],onChange:r,value:i,children:[e.jsx(D,{disableRipple:!0,label:"Cadastro",...w("informacao"),className:`${v.indicator} ${p?v.ready:v.warning} `}),e.jsx(D,{disableRipple:!0,label:"Enquadramento",...w("enquadramento")}),e.jsx(D,{disableRipple:!0,label:"Indicadores",...w("indicadores")}),e.jsx(D,{disableRipple:!0,label:"Atuação",...w("atuacao")})]})})]})}function w(i,n=""){return{id:i,"aria-controls":`simple-tabpanel-${i}`,value:i,"data-problems":n}}const be=[{type:"row",block:"ppea",elements:[{type:"row",elements:[{type:"column",size:12,key:"nome"},{type:"column",size:6,key:"area"},{type:"column",size:6,key:"area_tematica"}]},{type:"row",elements:[{type:"column",size:12,key:"link"}]}]},{type:"row",block:"inst",elements:[{type:"column",size:6,key:"instituicao_nome"},{type:"column",size:6,key:"instituicao_enquadramento"}]},{type:"row",block:"responsavel",elements:[{type:"row",elements:[{type:"column",size:6,key:"responsavel_nome"},{type:"column",size:6,key:"responsavel_cargo"}]},{type:"row",elements:[{type:"column",size:6,key:"responsavel_telefone"},{type:"column",size:6,key:"responsavel_email"}]}]},{type:"row",block:"more",elements:[{type:"row",elements:[{type:"column",size:4,key:"fase"},{type:"column",size:4,key:"fase_ano"},{type:"column",size:4,key:"fase_descricao"}]},{type:"row",elements:[{type:"column",size:4,key:"dificuldades"},{type:"column",size:8,key:"contemplados"}]}]}];function he({entityId:i}){const{server:n}=I();L(),R();const[f,p]=s.useState([]),[c,r]=s.useState([]),{data:l}=O(["policy_info",{entityId:i}],{queryFn:async()=>(await F.get(`${n}ppea/${i}/draft/info`)).data});s.useEffect(()=>{if(!l||!C)return;const m=V(l,C);r(m),p(m)},[l,C]);const b=(m,h)=>{r(u=>({...u,[m]:h}))};return e.jsx(e.Fragment,{children:c&&e.jsx("div",{className:"page-content",children:e.jsx("div",{className:"page-body",children:e.jsx(z,{middle:!0,headerless:!0,children:e.jsxs("div",{className:"p-3",children:[e.jsx(G,{form:C,view:be,lists:oe,data:c,onDataChange:b}),e.jsxs("div",{className:"section-header",children:[e.jsx("div",{className:"section-title"}),e.jsx("div",{className:"section-actions",children:e.jsxs("button",{className:"button-primary",onClick:()=>console.log(c),children:[" ",e.jsx(J,{}),"Gravar"]})})]})]})})})})})}function xe({entityId:i}){return e.jsx(e.Fragment,{children:e.jsx("div",{className:"page-content",children:e.jsx("div",{className:"page-body",children:e.jsx(z,{middle:!0,headerless:!0,children:e.jsx("div",{className:"p-3",children:"[ENQUADRAMENTO]"})})})})})}const ve="_error_1r416_45",je="_done_1r416_50",ge="_indic_1r416_55",Ee="_selected_1r416_59",ke="_field_1r416_63",Pe="_title_box_1r416_66",Ne="_tree_1r416_81",De="_li_lae_titles_1r416_92",Ce="_show_1r416_96",we="_fade_in_show_1r416_1",ze="_hide_1r416_111",Ae="_li_indicators_1r416_114",Se="_strong_1r416_125",$e="_actions_1r416_151",qe="_helpbox_button_1r416_157",Te="_button_delete_1r416_164",Ie="_Roll_1r416_1",_={error:ve,done:je,indic:ge,selected:Ee,field:ke,title_box:Pe,tree:Ne,li_lae_titles:De,show:Ce,fade_in_show:we,hide:ze,li_indicators:Ae,"item-container":"_item-container_1r416_118",strong:Se,"indic-header":"_indic-header_1r416_137",actions:$e,helpbox_button:qe,button_delete:Te,Roll:Ie},t={fields:[{key:"text",type:"label",title:"Este indicador ainda não foi implementado!"}]},Re={fields:[{key:1,type:"options",title:"Realizou diagnóstico?",size:6,options:[{value:0,label:"Não"},{value:1,label:"Sim"}]},{key:2,type:"options",title:"Quando foi realizado o diagnóstico?",size:6,options:[{value:0,label:"No início, para planejar e construir a PPEA"},{value:1,label:"Para implementar e/ou revisar a PPEA"},{value:2,label:"Durante todo o processo de construção, implementação e revisão da PPEA"}]},{key:6,type:"text",title:"Insira elemento comprobatório referente a pergunta acima //TODO - FILE",size:12},{key:3,type:"multi_autocomplete",title:"Quais as estratégias utilizadas para realizar o diagnóstico?",size:12,options:[{value:0,label:"Dados secundários / levantamento bibliográfico"},{value:1,label:"Entrevistas e questionários"},{value:2,label:"Oficinas"},{value:3,label:"Conjunto de técnicas participativas (MAPPEA - Mínima Aproximação Prévia para elaboração de Programas de Educação Ambiental, DRP – Diagnóstico Rápido Participativo, etc.)"}]},{key:7,type:"text",title:"Insira elemento comprobatório referente a pergunta acima //TODO - FILE",size:12},{key:4,type:"multi_autocomplete",title:"Quais foram os atores envolvidos no diagnóstico?",size:12,options:[{value:0,label:"Equipe contratada/terceirizada pela instituição proponente da PPEA"},{value:1,label:"Setor responsável pela PPEA da Instituição proponente"},{value:2,label:"Equipes de toda Instituição proponente da PPEA"},{value:3,label:"Instituição proponente da PPEA e representantes da sociedade civil, setor privado e poder público"}]},{key:5,type:"textarea",rows:8,title:"Descreva o processo de envolvimento destes atores/sujeitos",size:12}],blocks:[{key:"main",elements:[1]},{key:"dependent",show:{target:{key:1,value:1}},elements:[2,6,3,7,4,5]}]},Oe={fields:[{key:"name",type:"options",title:"Foi utilizada alguma estratégia de mobilização social?",size:6,options:[{value:0,label:"Não"},{value:1,label:"Sim"}]}]},T=[{id:"1",title:"Dimensão Diagnóstica",ready:!1,indics:[{id:"1_1",title:"Diagnóstico para construção da PPEA",ready:!1,form:Re}]},{id:"2",title:"Dimensão da Participação e Construção Coletiva",ready:!1,indics:[{id:"2_1",title:"Mobilização Social",ready:!1,form:Oe},{id:"2_2",title:"Existência de espaço coletivo (colegiado) para construir e implementar a PPEA",ready:!1,form:t}]},{id:"3",title:"Dimensão da Formação Dialógica",ready:!1,indics:[{id:"3_1",title:"Desenvolvimento de processo formador para a construção e implementação da PPEA",ready:!1,form:t},{id:"3_2",title:"Articulação entre teoria e prática do processo formativo/pedagógico",ready:!1,form:t},{id:"3_3",title:"Diversidade de Técnicas/estratégias utilizadas nos processos formativos",ready:!1,form:t},{id:"3_4",title:"Diversidade de públicos envolvidos",ready:!1,form:t},{id:"3_5",title:"Avaliação dos processos formativos",ready:!1,form:t}]},{id:"4",title:"Dimensão da Intervenção Socioambiental",ready:!1,indics:[{id:"4_1",title:"Intervenções socioambientais geradas a partir da execução da PPEA",ready:!1,form:t}]},{id:"5",title:"Dimensão da Subjetividade / Indivíduo",ready:!1,indics:[{id:"5_1",title:"Elevação da autoestima dos envolvidos",ready:!1,form:t},{id:"5_2",title:"Laços e vínculos comunitários/sociais",ready:!1,form:t},{id:"5_3",title:"Valorização da cultura associada às atividades ambientais",ready:!1,form:t}]},{id:"6",title:"Dimensão da Complexidade",ready:!1,indics:[{id:"6_1",title:"Articulação Temática",ready:!1,form:t},{id:"6_2",title:"Articulação de Redes, Movimentos socioambientais e Coletivos Educadores",ready:!1,form:t},{id:"6_3",title:"Conexão e articulação com referências e documentos internacionais",ready:!1,form:t},{id:"6_4",title:"Apoio à Ações Afirmativas de enfrentamento às desigualdades e discriminações",ready:!1,form:t}]},{id:"7",title:"Dimensão Institucional",ready:!1,indics:[{id:"7_1",title:"Instrumento legal da PPEA",ready:!1,form:t},{id:"7_2",title:"Instrumento pedagógico participativo de base",ready:!1,form:t},{id:"7_3",title:"Gestão racional dos bens naturais, patrimoniais e bens públicos",ready:!1,form:t},{id:"7_4",title:"Suporte orçamentário",ready:!1,form:t},{id:"7_5",title:"Infraestrutura física",ready:!1,form:t},{id:"7_6",title:"Estrutura Organizacional",ready:!1,form:t},{id:"7_7",title:"Recursos humanos empregados na PPEA",ready:!1,form:t},{id:"7_8",title:"Monitoramento e Avaliação da PPEA",ready:!1,form:t}]},{id:"8",title:"Dimensão da Comunicação",ready:!1,indics:[{id:"8_1",title:"Plano e Ferramentas de Comunicação",ready:!1,form:t},{id:"8_2",title:"Interlocutores do processo de comunicação",ready:!1,form:t},{id:"8_3",title:"Educomunicação e/ou Comunicação Social",ready:!1,form:t}]}];function Fe({entityId:i}){const{server:n}=I(),{currentCommunity:f,changeRoute:p,params:c}=U();L(),R();const[r,l]=s.useState(null),[b,m]=s.useState(null),[h,u]=s.useState(null),[g,E]=s.useState(null),[k,P]=s.useState(!1),[x,j]=s.useState(null),[B,A]=s.useState([]),[S,N]=s.useState([]),{data:o}=O(["policy_info",{entityId:i}],{queryFn:async()=>(await F.get(`${n}ppea/${i}/draft/indics`)).data});s.useEffect(()=>{var d;if(!o||!x||!r||!((d=o.indicadores)!=null&&d[r]))return;const a=V(o.indicadores[r],x);N(a),A(a)},[o,x,r]),s.useEffect(()=>{c&&c[1]?l(c[1]):l("1_1")},[c]),s.useEffect(()=>{if(r){const a=r.split("_")[0];m(a);const $=T.find(q=>q.id===a).indics.find(q=>q.id===r);j($.form)}},[r]);const y=a=>{u(h!==a?a:null)},K=(a,d)=>()=>{u(d),k?E(a):p({params:["indicadores",a]})},Z=async a=>{a==="confirm"&&p({params:["indicadores",g]}),E(null)},H=(a,d)=>{N($=>({...$,[a]:d}))};return e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"page-content",children:[e.jsx("div",{className:"page-sidebar",children:e.jsx("div",{className:`sidebar-body ${_.tree}`,children:T&&e.jsx("ul",{children:T.map(a=>e.jsxs("li",{className:`mb-3 ${_.li_lae_titles}`,onClick:()=>y(a.id),children:[e.jsx(Q,{title:a.title,ready:a.ready,className:b===a.id||h===a.id?_.strong:""}),e.jsx("ul",{className:`${b===a.id||h===a.id?_.show:_.hide}`,children:a.indics.map(d=>e.jsx("li",{className:`${_.li_indicators}`,onClick:K(d.id,a.id),children:e.jsx(Q,{title:d.title,ready:d.ready,className:`${_.indic} ${r===d.id?_.selected:""}`})},d.id))})]},a.id))})})}),e.jsx("div",{className:"page-body",children:e.jsx(z,{middle:!0,headerless:!0,children:e.jsx("div",{className:"p-3",children:!!x&&e.jsx(G,{form:x,data:S,onDataChange:H})})})})]}),e.jsx(ne,{open:!!g,content:"Você deseja sair do indicador sem salvar as alterações?",confirmButtonText:"Confirmar",onClose:Z})]})}function Q({title:i,ready:n,className:f}){let p=n?e.jsx(W,{}):e.jsx(re,{});return e.jsxs("div",{className:`${_["item-container"]} ${f}`,children:[e.jsx("div",{className:`${_[n?"done":"error"]}`,children:p}),e.jsx("div",{children:i})]})}function Be({entityId:i}){return e.jsx(e.Fragment,{children:e.jsx("div",{className:"page-content",children:e.jsx("div",{className:"page-body",children:e.jsx(z,{middle:!0,headerless:!0,children:e.jsx("div",{className:"p-3",children:"[ATUACAO]"})})})})})}const Me="_button_delete_lccbr_45",Qe="_Roll_lccbr_1",Le="_term_lccbr_82",Ue={button_delete:Me,Roll:Qe,term:Le},da=()=>{const{currentCommunity:i,changeRoute:n,params:f}=U(),{server:p}=I(),{user:c,updateUser:r}=X(),{enqueueSnackbar:l,closeSnackbar:b}=R(),[m,h]=s.useState(null),[u,g]=s.useState(null),[E,k]=s.useState(!1),[P,x]=s.useState(!1),{data:j}=O(["policy",{currentCommunity:i.id}],{queryFn:async()=>(await F.get(`${p}ppea/id_from_community/${i.id}`)).data});s.useEffect(()=>{x(c.membership.map(o=>o.id===1||o.id===i.id&&o.type==="adm").reduce((o,y)=>o||y))},[P,c,i]),s.useEffect(()=>{j&&h(j.id)},[j]),s.useEffect(()=>{g(f&&f.length?f[0]:"informacao")},[f]);const B=()=>{k(!0)},A=o=>{o==="confirm"&&S(),k(!1)},S=async()=>{const o=l("Publicando...",{persist:!0,anchorOrigin:{vertical:"top",horizontal:"right"}});try{const{data:y}=await mutation.publish.mutateAsync();if(b(o),y.success)window.location=`${window.location}`,l("Comissão publicada com sucesso!",{variant:"success",anchorOrigin:{vertical:"top",horizontal:"right"}});else if(y.reason.code==="not_ready")l(e.jsxs("div",{children:[e.jsx("p",{children:e.jsx("strong",{children:"Esta comissão ainda não esta pronta para ser publicada!"})}),e.jsx("p",{children:"Verifique se todos os campos das abas de Informações estão completamente preenchidos."})]}),{variant:"warning",anchorOrigin:{vertical:"top",horizontal:"center"}});else throw new Error("unknown reason")}catch(y){b(o),console.error(y),l("Erro ao publicar a comissão!",{variant:"error",anchorOrigin:{vertical:"top",horizontal:"right"}})}},N=()=>{};return e.jsxs("div",{className:"page",children:[e.jsxs("div",{className:"page-header",children:[e.jsx(de,{title:"Política Pública de Educação Ambiental"}),e.jsxs("div",{className:"page-header-buttons",children:[e.jsxs("button",{className:"button-outline",onClick:N,children:[e.jsx(le,{}),"Baixar CSV"]}),P&&P===!0&&e.jsxs("button",{className:"button-primary",onClick:B,children:[e.jsx(W,{}),"Publicar"]})]})]}),u&&e.jsxs(e.Fragment,{children:[e.jsx(ye,{defaultTab:u,onTabChange:o=>n({params:[o]})}),m&&e.jsxs(e.Fragment,{children:[u==="informacao"&&e.jsx(he,{entityId:m}),u==="enquadramento"&&e.jsx(xe,{entityId:m}),u==="indicadores"&&e.jsx(Fe,{entityId:m}),u==="atuacao"&&e.jsx(Be,{entityId:m})]})]}),e.jsx(Y,{display:"flex",justifyContent:"space-between"}),e.jsx(Ve,{open:E,onClose:A})]})};function Ve({open:i,onClose:n}){return e.jsx("div",{children:e.jsxs(ee,{open:i,onClose:n,"aria-labelledby":"alert-dialog-title","aria-describedby":"alert-dialog-description",fullWidth:!0,maxWidth:"md",children:[e.jsx(ae,{id:"alert-dialog-title",children:"Termo de Adesão ao PPPZCM"}),e.jsx(M,{children:e.jsx(M,{id:"alert-dialog-description",className:Ue.term,children:e.jsx("p",{children:"TODO TODO TODO"})})}),e.jsxs(te,{children:[e.jsx("button",{className:"button-primary",onClick:()=>n("confirm"),children:"Concordo"}),e.jsx(ie,{onClick:()=>n("cancel"),autoFocus:!0,children:"Não concordo"})]})]})})}export{da as default};
