import{b as N,r as a,j as e,u as w,e as b,P as C,o as L,p as $,C as R,b4 as I,b5 as E,E as B,q,n as v}from"./index-DLt25zcS.js";import{S as z}from"./Search-BuC3Vl68.js";import{E as D}from"./Eye-r5Ro5whN.js";import"./chevron-down-Ds3BInvI.js";import{T as A,a as O}from"./TableRow-2NasLTb7.js";import{T as V}from"./TablePagination-ChKDi7BJ.js";import{B as S}from"./Box-BoG2D6P7.js";import{T as Q}from"./TableSortLabel-BadkXaU-.js";import"./KeyboardArrowRight-B-_qEmRL.js";const G="_similarList_jkwof_1",H="_similarListItem_jkwof_5",J="_name_similarity_box_jkwof_12",K="_similares_jkwof_19",M="_select_level_jkwof_23",U="_similar_orgs_jkwof_30",W="_org_id_jkwof_33",X="_org_name_jkwof_36",m={similarList:G,similarListItem:H,name_similarity_box:J,similares:K,select_level:M,similar_orgs:U,org_id:W,org_name:X},Y=q,Z=[{value:10,label:"10"},{value:15,label:"15"},{value:20,label:"20"},{value:25,label:"25"},{value:30,label:"30"},{value:35,label:"35"},{value:40,label:"40"},{value:45,label:"45"},{value:50,label:"50"}],xe=()=>{const{changeRoute:t,params:l}=N(),[i,r]=a.useState(null);return a.useEffect(()=>{r(l[0]?l[0]:null)},[l]),e.jsxs(e.Fragment,{children:[!i&&e.jsx(ee,{onSelect:n=>t({params:[n]})}),!!i&&e.jsx(se,{id:i})]})};let p;const ee=({onSelect:t})=>{const{server:l}=w(),i=a.useRef(null),[r,n]=a.useState(1),[o,x]=a.useState("nome"),[d,c]=a.useState("desc"),[h,k]=a.useState(10),[j,P]=a.useState(""),[u,T]=a.useState(null),[g,F]=a.useState(""),{data:_}=b(["orgs_list",{page:r,order:o,direction:d,perPage:h,filter:g}],{queryFn:async()=>(await v.get(`${l}organization/?page=${r}&order=${o}&direction=${d==="asc"?"desc":"asc"}&limit=${h}${g.length?`&filter=${g}`:""}`)).data});a.useEffect(()=>{_&&T(_)},[_]),a.useEffect(()=>{p&&clearTimeout(p),p=setTimeout(()=>{n(1),F(j)},500)},[j]);const f=s=>{n(1),o===s?c(d==="asc"?"desc":"asc"):(x(s),c("desc"))};return u?e.jsxs("div",{className:"page width-limiter tbox-fixed",children:[e.jsx("div",{className:"page-header",children:e.jsx(C,{title:"Organizações ("+u.total+")"})}),e.jsx("div",{className:"page-content",children:e.jsxs("div",{className:"page-body",children:[e.jsxs("div",{className:"tablebox",children:[e.jsx("div",{className:"tbox-header",children:e.jsx(Y,{spellCheck:"false",className:"tbox-search",startAdornment:e.jsx(z,{onClick:()=>{var s;return(s=i.current)==null?void 0:s.focus()}}),inputRef:i,placeholder:"Pesquisar...",inputProps:{"aria-label":"pesquisar grupos"},value:j,onChange:s=>P(s.target.value)})}),e.jsx("div",{className:"tbox-body",children:e.jsxs("table",{className:"tbox-table",children:[e.jsx("thead",{children:e.jsxs("tr",{children:[e.jsx("th",{children:e.jsx(y,{text:"ID",column:"id",order:o,direction:d,onClick:f})}),e.jsx("th",{children:e.jsx(y,{text:"Nome",column:"nome",order:o,direction:d,onClick:f})}),e.jsx("th",{children:"Ações"})]})}),e.jsx(A,{children:u.entities.map(s=>e.jsxs(ae,{children:[e.jsxs("td",{children:["#",s.id]}),e.jsx("td",{children:s.nome}),e.jsx("td",{className:"tbox-table-actions",children:e.jsx("div",{children:e.jsx(L,{title:"Remover",children:e.jsx($,{onClick:()=>t(s.id),children:e.jsx(D,{})})})})})]},s.id))})]})})]}),e.jsx(V,{className:"pagination",component:"div",count:u.total,page:r-1,onPageChange:(...s)=>n(s[1]+1),rowsPerPage:h,rowsPerPageOptions:[10,20,50,100],onRowsPerPageChange:s=>{k(s.target.value),n(1)}}),e.jsx(S,{display:"flex",justifyContent:"space-between"})]})})]}):e.jsx(e.Fragment,{})},se=({id:t})=>{const{server:l}=w(),{changeRoute:i}=N(),[r,n]=a.useState(40),{data:o}=b(["orgs_data",{id:t}],{queryFn:async()=>(await v.get(`${l}organization/${t}`)).data}),{data:x}=b(["orgs_similar_list",{id:t,level:r}],{queryFn:async()=>(await v.get(`${l}organization/similar/${t}/?level=${r}`)).data,enabled:!!t}),d=(c,h)=>{n(h)};return o?e.jsxs("div",{className:"page",children:[e.jsxs("div",{className:"page-header",children:[e.jsx(C,{title:o.nome}),e.jsx("div",{className:"page-header-buttons",children:e.jsx("button",{className:"button-outline",onClick:()=>i({params:[]}),children:"Voltar"})})]}),e.jsx("div",{className:"page-content",children:e.jsx("div",{className:"page-body",children:e.jsx(e.Fragment,{children:e.jsxs(R,{middle:!0,headerless:!0,children:[e.jsx("div",{className:m.similares,children:e.jsx(I,{direction:"row",justifyContent:"space-between",alignItems:"flex-start",spacing:2,children:e.jsx(S,{width:300,children:e.jsxs("div",{className:m.select_level,children:[e.jsx(E,{min:10,max:50,step:5,marks:Z,size:"small",value:r,"aria-label":"Small",valueLabelDisplay:"auto",onChangeCommitted:d,onClick:c=>{c.stopPropagation()}}),e.jsx("small",{children:"(nível)"})]})})})}),e.jsxs("div",{className:m.similarList,children:[x&&x.map(c=>e.jsx("div",{className:m.similarListItem,children:e.jsxs("span",{onClick:()=>i({params:[c.id]}),className:m.similar_orgs,children:[e.jsxs("span",{className:m.org_id,children:["#",c.id]}),e.jsx("span",{className:m.org_name,children:c.nome})]})},c.id)),x&&!x.length&&e.jsx(e.Fragment,{children:"Nenhum item encontrado com este nível de similaridade"})]})]})})})})]}):e.jsx(e.Fragment,{})};function y({text:t,column:l,order:i,direction:r,enabled:n=!0,onClick:o}){return e.jsxs(e.Fragment,{children:[!n&&e.jsx(e.Fragment,{children:t}),n&&e.jsx(Q,{className:"tbox-table-sortlabel",active:i===l,direction:r,onClick:()=>o(l),children:t})]})}const ae=B(O)({"&:last-child td, &:last-child th":{border:0}});export{xe as default};
