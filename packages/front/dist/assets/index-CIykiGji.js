import{b as k,u as z,c as w,d as R,r as o,e as H,l as _,A as E,f as M,j as s}from"./index-D86RA3IV.js";import{B as n}from"./Box-DnU_U0sJ.js";const q="_mainDiv_1vjx6_45",Q="_error_1vjx6_50",Y="_actions_1vjx6_53",O="_community_1vjx6_62",B="_maxh_1vjx6_68",F="_title_1vjx6_73",P="_status_1vjx6_77",T="_closed_1vjx6_85",K="_text_1vjx6_89",t={mainDiv:q,error:Q,actions:Y,community:O,maxh:B,title:F,status:P,closed:T,text:K},v={informacao:"Informações",conexoes:"Conexões",indicadores:"Indicadores",atuacao:"Atuação"};function J({data:e}){const{getCommunityData:m,changeRoute:y,currentCommunity:x}=k(),{server:c}=z(),{enqueueSnackbar:l,closeSnackbar:p}=w(),u=R(),[f,b]=o.useState(""),[h,g]=o.useState(""),[N,S]=o.useState(""),[A,C]=o.useState("..."),[$,j]=o.useState(!1),{data:i}=H([`help_status_${e.content.help_id}`,{helpId:e.content.help_id}],{queryFn:async()=>(await _.get(`${c}help/${e.content.help_id}`)).data,enabled:!!e.content});o.useEffect(()=>{async function a(){let r=await m(e.content.communityId);C(r?r.name:"?")}e&&(b(E(e.createdAt).format("DD [de] MMMM [de] YYYY [às] HH:mm")),g(e.user_name),S(e.user_id),a())},[e,c,m]),o.useEffect(()=>{e&&u.invalidateQueries(`help_status_${e.content.help_id}`)},[e,u]);const D={close:M(()=>_.put(`${c}help/${e.content.help_id}/close`,{communityId:e.content.communityId}),{onSuccess:()=>{u.invalidateQueries(`help_status_${e.content.help_id}`)}})},d=()=>{y({community:e.content.communityId,tool:"projeto",params:[e.content.tab]})},I=async()=>{j(!0);const a=l("Resolvendo pedido de ajuda...",{persist:!0,anchorOrigin:{vertical:"top",horizontal:"center"}});try{await D.close.mutateAsync(),p(a),l("Pedido de ajuda resolvido com sucesso!",{variant:"success",anchorOrigin:{vertical:"top",horizontal:"right"}})}catch(r){p(a),j(!1),console.error(r),l("Erro ao resolver pedido de ajuda!",{variant:"error",anchorOrigin:{vertical:"top",horizontal:"right"}})}};return s.jsxs(n,{sx:{padding:"24px",marginTop:"48px",backgroundColor:"white",position:"relative",zIndex:"1",minHeight:"100px",width:"100%",boxShadow:"0px 0px 8px #0000001A",borderRadius:"8px"},children:[s.jsx(n,{sx:{display:"flex",justifyContent:"space-between"},children:s.jsxs(n,{sx:{display:"flex"},children:[s.jsx(n,{as:"img",src:`${c}user/${N}/thumb`,alt:"salve",sx:{borderRadius:"50%",width:"48px",height:"48px"}}),s.jsxs(n,{sx:{marginLeft:"8px"},children:[s.jsx(n,{sx:{fontWeight:"bold",fontSize:"16px"},children:s.jsxs("div",{className:t.title,children:["Pedido de Ajuda",s.jsx(L,{status:i})]})}),s.jsx(n,{sx:{fontSize:"14px"},children:f})]})]})}),s.jsxs(n,{sx:{marginTop:"8px"},children:[x.alias!=="projeto"&&s.jsxs("div",{className:t.mainDiv,children:[s.jsxs("div",{children:[h," de ",s.jsxs("span",{className:t.community,onClick:d,children:['"',A,'"']}),s.jsxs("span",{children:[" pediu uma ajuda para a aba ",s.jsxs("span",{className:t.field,children:['"',v[e.content.tab],'"']})]}),", com o seguinte texto: ",s.jsxs("span",{className:t.text,children:['"',e.content.text,'"']})]}),e&&s.jsxs("div",{className:t.actions,children:[s.jsx("button",{className:"button-outline",size:"small",onClick:d,children:"Acessar"}),i&&!i.closedAt&&s.jsx("button",{className:"button-primary",disabled:$,size:"small",onClick:I,children:"Resolvido"})]})]}),x.alias==="projeto"&&s.jsxs("div",{className:t.mainDiv,children:[s.jsxs("div",{children:[h," pediu uma ajuda para a aba ",s.jsxs("span",{className:t.field,children:['"',v[e.content.tab],'"']}),", com o seguinte texto: ",s.jsxs("span",{className:t.text,children:['"',e.content.text,'"']})]}),e&&i&&!i.closedAt&&s.jsx("div",{className:t.actions,children:s.jsx("button",{className:"button-primary",size:"small",onClick:d,children:"Acessar"})})]})]})]})}function L({status:e}){return e?s.jsx("div",{className:`${t.status} ${e.closedAt?t.closed:""}`,children:e.closedAt?"resolvido":"aberto"}):s.jsx(s.Fragment,{})}export{J as default};
