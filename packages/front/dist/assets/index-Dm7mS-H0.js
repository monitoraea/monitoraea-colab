import{j as e,m as X,u as Y,b as H,c as K,r,d as Z,a as J,e as V,f as E,D as ee,h as te,i as ae,T as se,k as re,B as ie,n as oe,l as f}from"./index-D86RA3IV.js";import{T as ne,A as ce,C as le}from"./Trash-eVNNj0w9.js";import{P as ue}from"./PageTitle-BoYOGQqw.js";import{s as de}from"./FreeMultiple.module-CtXSpXmF.js";import{I as me}from"./Popper-Djdz_uXk.js";import{B as xe}from"./Box-DnU_U0sJ.js";import{T as he}from"./TableSortLabel-BrFooZBr.js";function pe(){return e.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[e.jsx("circle",{cx:"11",cy:"11",r:"8"}),e.jsx("line",{x1:"21",y1:"21",x2:"16.65",y2:"16.65"})]})}function ve(){return e.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[e.jsx("path",{d:"M1 12s4-8 11-8 11 8 11 8-4 8-11 8-11-8-11-8z"}),e.jsx("circle",{cx:"12",cy:"12",r:"3"})]})}var h={exports:{}},w={À:"A",Á:"A",Â:"A",Ã:"A",Ä:"A",Å:"A",Ấ:"A",Ắ:"A",Ẳ:"A",Ẵ:"A",Ặ:"A",Æ:"AE",Ầ:"A",Ằ:"A",Ȃ:"A",Ç:"C",Ḉ:"C",È:"E",É:"E",Ê:"E",Ë:"E",Ế:"E",Ḗ:"E",Ề:"E",Ḕ:"E",Ḝ:"E",Ȇ:"E",Ì:"I",Í:"I",Î:"I",Ï:"I",Ḯ:"I",Ȋ:"I",Ð:"D",Ñ:"N",Ò:"O",Ó:"O",Ô:"O",Õ:"O",Ö:"O",Ø:"O",Ố:"O",Ṍ:"O",Ṓ:"O",Ȏ:"O",Ù:"U",Ú:"U",Û:"U",Ü:"U",Ý:"Y",à:"a",á:"a",â:"a",ã:"a",ä:"a",å:"a",ấ:"a",ắ:"a",ẳ:"a",ẵ:"a",ặ:"a",æ:"ae",ầ:"a",ằ:"a",ȃ:"a",ç:"c",ḉ:"c",è:"e",é:"e",ê:"e",ë:"e",ế:"e",ḗ:"e",ề:"e",ḕ:"e",ḝ:"e",ȇ:"e",ì:"i",í:"i",î:"i",ï:"i",ḯ:"i",ȋ:"i",ð:"d",ñ:"n",ò:"o",ó:"o",ô:"o",õ:"o",ö:"o",ø:"o",ố:"o",ṍ:"o",ṓ:"o",ȏ:"o",ù:"u",ú:"u",û:"u",ü:"u",ý:"y",ÿ:"y",Ā:"A",ā:"a",Ă:"A",ă:"a",Ą:"A",ą:"a",Ć:"C",ć:"c",Ĉ:"C",ĉ:"c",Ċ:"C",ċ:"c",Č:"C",č:"c",C̆:"C",c̆:"c",Ď:"D",ď:"d",Đ:"D",đ:"d",Ē:"E",ē:"e",Ĕ:"E",ĕ:"e",Ė:"E",ė:"e",Ę:"E",ę:"e",Ě:"E",ě:"e",Ĝ:"G",Ǵ:"G",ĝ:"g",ǵ:"g",Ğ:"G",ğ:"g",Ġ:"G",ġ:"g",Ģ:"G",ģ:"g",Ĥ:"H",ĥ:"h",Ħ:"H",ħ:"h",Ḫ:"H",ḫ:"h",Ĩ:"I",ĩ:"i",Ī:"I",ī:"i",Ĭ:"I",ĭ:"i",Į:"I",į:"i",İ:"I",ı:"i",Ĳ:"IJ",ĳ:"ij",Ĵ:"J",ĵ:"j",Ķ:"K",ķ:"k",Ḱ:"K",ḱ:"k",K̆:"K",k̆:"k",Ĺ:"L",ĺ:"l",Ļ:"L",ļ:"l",Ľ:"L",ľ:"l",Ŀ:"L",ŀ:"l",Ł:"l",ł:"l",Ḿ:"M",ḿ:"m",M̆:"M",m̆:"m",Ń:"N",ń:"n",Ņ:"N",ņ:"n",Ň:"N",ň:"n",ŉ:"n",N̆:"N",n̆:"n",Ō:"O",ō:"o",Ŏ:"O",ŏ:"o",Ő:"O",ő:"o",Œ:"OE",œ:"oe",P̆:"P",p̆:"p",Ŕ:"R",ŕ:"r",Ŗ:"R",ŗ:"r",Ř:"R",ř:"r",R̆:"R",r̆:"r",Ȓ:"R",ȓ:"r",Ś:"S",ś:"s",Ŝ:"S",ŝ:"s",Ş:"S",Ș:"S",ș:"s",ş:"s",Š:"S",š:"s",ß:"ss",Ţ:"T",ţ:"t",ț:"t",Ț:"T",Ť:"T",ť:"t",Ŧ:"T",ŧ:"t",T̆:"T",t̆:"t",Ũ:"U",ũ:"u",Ū:"U",ū:"u",Ŭ:"U",ŭ:"u",Ů:"U",ů:"u",Ű:"U",ű:"u",Ų:"U",ų:"u",Ȗ:"U",ȗ:"u",V̆:"V",v̆:"v",Ŵ:"W",ŵ:"w",Ẃ:"W",ẃ:"w",X̆:"X",x̆:"x",Ŷ:"Y",ŷ:"y",Ÿ:"Y",Y̆:"Y",y̆:"y",Ź:"Z",ź:"z",Ż:"Z",ż:"z",Ž:"Z",ž:"z",ſ:"s",ƒ:"f",Ơ:"O",ơ:"o",Ư:"U",ư:"u",Ǎ:"A",ǎ:"a",Ǐ:"I",ǐ:"i",Ǒ:"O",ǒ:"o",Ǔ:"U",ǔ:"u",Ǖ:"U",ǖ:"u",Ǘ:"U",ǘ:"u",Ǚ:"U",ǚ:"u",Ǜ:"U",ǜ:"u",Ứ:"U",ứ:"u",Ṹ:"U",ṹ:"u",Ǻ:"A",ǻ:"a",Ǽ:"AE",ǽ:"ae",Ǿ:"O",ǿ:"o",Þ:"TH",þ:"th",Ṕ:"P",ṕ:"p",Ṥ:"S",ṥ:"s",X́:"X",x́:"x",Ѓ:"Г",ѓ:"г",Ќ:"К",ќ:"к",A̋:"A",a̋:"a",E̋:"E",e̋:"e",I̋:"I",i̋:"i",Ǹ:"N",ǹ:"n",Ồ:"O",ồ:"o",Ṑ:"O",ṑ:"o",Ừ:"U",ừ:"u",Ẁ:"W",ẁ:"w",Ỳ:"Y",ỳ:"y",Ȁ:"A",ȁ:"a",Ȅ:"E",ȅ:"e",Ȉ:"I",ȉ:"i",Ȍ:"O",ȍ:"o",Ȑ:"R",ȑ:"r",Ȕ:"U",ȕ:"u",B̌:"B",b̌:"b",Č̣:"C",č̣:"c",Ê̌:"E",ê̌:"e",F̌:"F",f̌:"f",Ǧ:"G",ǧ:"g",Ȟ:"H",ȟ:"h",J̌:"J",ǰ:"j",Ǩ:"K",ǩ:"k",M̌:"M",m̌:"m",P̌:"P",p̌:"p",Q̌:"Q",q̌:"q",Ř̩:"R",ř̩:"r",Ṧ:"S",ṧ:"s",V̌:"V",v̌:"v",W̌:"W",w̌:"w",X̌:"X",x̌:"x",Y̌:"Y",y̌:"y",A̧:"A",a̧:"a",B̧:"B",b̧:"b",Ḑ:"D",ḑ:"d",Ȩ:"E",ȩ:"e",Ɛ̧:"E",ɛ̧:"e",Ḩ:"H",ḩ:"h",I̧:"I",i̧:"i",Ɨ̧:"I",ɨ̧:"i",M̧:"M",m̧:"m",O̧:"O",o̧:"o",Q̧:"Q",q̧:"q",U̧:"U",u̧:"u",X̧:"X",x̧:"x",Z̧:"Z",z̧:"z",й:"и",Й:"И",ё:"е",Ё:"Е"},I=Object.keys(w).join("|"),je=new RegExp(I,"g"),ge=new RegExp(I,"");function fe(a){return w[a]}var S=function(a){return a.replace(je,fe)},be=function(a){return!!a.match(ge)};h.exports=S;h.exports.has=be;h.exports.remove=S;var ye=h.exports;const O=X(ye),Se=()=>{const{server:a}=Y(),{currentCommunity:s,changeRoute:n}=H(),{enqueueSnackbar:i,closeSnackbar:o}=K(),d=r.useRef(null),y=Z(),[U,R]=r.useState([]),[T,D]=r.useState(0),[m,B]=r.useState(""),[c,L]=r.useState("name"),[l,C]=r.useState("asc"),[P,A]=r.useState(null),[_,N]=r.useState(!1),{user:k}=J(),[$,p]=r.useState(!1),[v,M]=r.useState(!1),G=oe,{data:x}=V(["communities_list",{currentCommunity:s.id,order:c,direction:l}],{queryFn:async()=>(await f.get(`${a}gt/${s.id}/?alias=${s.alias.trim()}&order=${c}&direction=${l}`)).data}),z={create:E(t=>f.post(`${a}project/?communityId=${s.id}`,{nome:t}),{onSuccess:()=>{y.invalidateQueries("communities_list")}})},F={remove:E(t=>f.delete(`${a}project/${t}`),{onSuccess:()=>y.invalidateQueries("communities_list")})};r.useEffect(()=>{if(!x)return;D(x.total);let t=[...x.entities];m.trim().length&&(t=t.filter(u=>O(u.name.toLowerCase()).includes(O(m.trim().toLocaleLowerCase())))),R(t)},[x,m]),r.useEffect(()=>{M(k.membership.map(t=>t.id===1||t.id===s.id&&t.type==="adm").reduce((t,u)=>t||u))},[v,k,s]);const j=t=>{c===t?C(l==="asc"?"desc":"asc"):(L(t),C("desc"))},W=async t=>{if(!t||!t.length)return;const u=i("Criando a Iniciativa..",{persist:!0,anchorOrigin:{vertical:"top",horizontal:"right"}});try{const{data:g}=await z.create.mutateAsync(t);o(u),i("Iniciativa gravado com sucesso!",{variant:"success",anchorOrigin:{vertical:"top",horizontal:"right"}}),p(!1),window.location=`/colabora/projeto/${g.communityId}`}catch(g){o(u),console.error(g),i("Erro ao gravar a iniciativa!",{variant:"error",anchorOrigin:{vertical:"top",horizontal:"right"}})}},q=t=>{A(t),N(!0)},Q=async t=>{t==="confirm"&&(await F.remove.mutateAsync(P),i("Iniciativa deletada com sucesso!",{variant:"success",anchorOrigin:{vertical:"top",horizontal:"right"}})),A(null),N(!1)};return e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"page width-limiter tbox-fixed",children:[e.jsxs("div",{className:"page-header",children:[e.jsx(ue,{title:"Grupos de trabalho ("+T+")"}),e.jsxs("div",{className:"page-header-buttons",children:[e.jsx("button",{className:"button-primary",onClick:()=>p(!0),children:"Nova iniciativa"}),s.id===1&&e.jsx("button",{className:"button-outline",onClick:()=>window.open(`${a}project/spreadsheet`,"_blank"),children:"Baixar planilha"})]})]}),e.jsx("div",{className:"page-content",children:e.jsx("div",{className:"page-body",children:e.jsxs("div",{className:"tablebox limit-height",children:[e.jsx("div",{className:"tbox-header",children:e.jsx(G,{spellCheck:"false",className:"tbox-search",startAdornment:e.jsx(pe,{onClick:()=>{var t;return(t=d.current)==null?void 0:t.focus()}}),inputRef:d,placeholder:"Pesquisar...",inputProps:{"aria-label":"pesquisar grupos"},value:m,onChange:t=>B(t.target.value)})}),e.jsx("div",{className:"tbox-body",children:e.jsxs("table",{className:"tbox-table",children:[e.jsx("thead",{children:e.jsxs("tr",{children:[e.jsx("th",{children:e.jsx(b,{text:"Grupos de trabalho",column:"name",order:c,direction:l,onClick:j})}),s.alias.trim()==="adm"&&e.jsx("th",{children:e.jsx(b,{text:"Perspectiva",column:"perspectiveName",order:c,direction:l,onClick:j})}),e.jsx("th",{children:e.jsx(b,{text:"Tipo",column:"typeName",order:c,direction:l,onClick:j})}),e.jsx("th",{children:"Ações"})]})}),e.jsx("tbody",{children:U.map(t=>e.jsxs("tr",{className:"tbox-row",children:[e.jsx("td",{children:t.name}),s.alias.trim()==="adm"&&e.jsx("td",{children:t.pespectiveName}),e.jsx("td",{children:t.typeName}),e.jsxs("td",{className:"tbox-table-actions",children:[e.jsx("div",{onClick:()=>n({community:t.id}),children:e.jsx(ve,{})}),e.jsx("div",{className:de["svg-icon-box"],children:v&&v===!0&&e.jsx(ne,{title:"Remover",children:e.jsx(me,{onClick:()=>q(t.id),children:e.jsx(ce,{})})})})]})]},t.id))})]})})]})})}),e.jsx(xe,{display:"flex",justifyContent:"space-between"}),e.jsx(le,{open:_,content:"Confirma a remoção deste produtor?",confirmButtonText:"Remover",onClose:Q})]}),e.jsx(Ce,{open:$,onCreate:W,onClose:()=>p(!1)})]})};function b({text:a,column:s,order:n,direction:i,onClick:o}){return e.jsx(e.Fragment,{children:e.jsx(he,{className:"tbox-table-sortlabel",active:n===s,direction:i==="desc"?"asc":"desc",onClick:()=>o(s),children:a})})}function Ce({open:a,onCreate:s,onClose:n}){const[i,o]=r.useState("");return r.useEffect(()=>{a&&o("")},[a]),e.jsx("div",{children:e.jsxs(ee,{open:a,onClose:n,"aria-labelledby":"alert-dialog-title","aria-describedby":"alert-dialog-description",maxWidth:"md",fullWidth:!0,children:[e.jsx(te,{id:"alert-dialog-title",children:"Nova iniciativa"}),e.jsx(ae,{children:e.jsx("div",{className:"row",children:e.jsx("div",{className:"col-xs-12",children:e.jsx(se,{className:"input-text",label:"Nome da nova iniciativa",value:i,onChange:d=>o(d.target.value)})})})}),e.jsxs(re,{children:[e.jsx(ie,{onClick:()=>n(),autoFocus:!0,children:"Cancelar"}),e.jsx("button",{className:"button-primary",onClick:()=>s(i),children:"Criar"})]})]})})}export{Se as default};
