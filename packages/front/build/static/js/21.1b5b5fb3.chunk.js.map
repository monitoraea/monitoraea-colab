{"version":3,"sources":["../node_modules/@mui/system/esm/createBox.js","../node_modules/@mui/material/Box/Box.js","tools/notifications/HelpNotification/styles.module.scss","tools/notifications/HelpNotification/index.js"],"names":["_excluded","Box","options","defaultTheme","defaultClassName","generateClassName","styleFunctionSx","defaultStyleFunctionSx","BoxRoot","styled","React","inProps","ref","theme","useTheme","_extendSxProp","extendSxProp","className","component","other","_objectWithoutPropertiesLoose","_jsx","_extends","as","clsx","createBox","createTheme","ClassNameGenerator","generate","module","exports","tabNames","informacao","conexoes","indicadores","atuacao","HelpNotification","data","useRouter","getCommunityData","changeRoute","currentCommunity","server","useDorothy","useSnackbar","enqueueSnackbar","closeSnackbar","queryClient","useQueryClient","useState","date","_date","sender","_sender","senderId","_senderId","communityName","_communityName","closing","_closing","useQuery","content","help_id","helpId","queryFn","axios","get","enabled","helpStatus","useEffect","communityId","communityData","name","dayjs","createdAt","format","user_name","user_id","fetchCompleted","invalidateQueries","mutations","close","useMutation","put","onSuccess","access","community","tool","params","tab","closeHelpRequest","snackKey","persist","anchorOrigin","vertical","horizontal","mutateAsync","variant","console","error","sx","padding","marginTop","backgroundColor","position","zIndex","minHeight","width","boxShadow","borderRadius","display","justifyContent","src","alt","height","marginLeft","fontWeight","fontSize","styles","title","HelpStatus","status","alias","mainDiv","onClick","field","text","actions","size","closedAt","disabled","closed"],"mappings":"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","file":"static/js/21.1b5b5fb3.chunk.js","sourcesContent":["import _extends from \"@babel/runtime/helpers/esm/extends\";\nimport _objectWithoutPropertiesLoose from \"@babel/runtime/helpers/esm/objectWithoutPropertiesLoose\";\nconst _excluded = [\"className\", \"component\"];\nimport * as React from 'react';\nimport clsx from 'clsx';\nimport styled from '@mui/styled-engine';\nimport defaultStyleFunctionSx, { extendSxProp } from './styleFunctionSx';\nimport useTheme from './useTheme';\nimport { jsx as _jsx } from \"react/jsx-runtime\";\nexport default function createBox(options = {}) {\n  const {\n    defaultTheme,\n    defaultClassName = 'MuiBox-root',\n    generateClassName,\n    styleFunctionSx = defaultStyleFunctionSx\n  } = options;\n  const BoxRoot = styled('div')(styleFunctionSx);\n  const Box = /*#__PURE__*/React.forwardRef(function Box(inProps, ref) {\n    const theme = useTheme(defaultTheme);\n\n    const _extendSxProp = extendSxProp(inProps),\n          {\n      className,\n      component = 'div'\n    } = _extendSxProp,\n          other = _objectWithoutPropertiesLoose(_extendSxProp, _excluded);\n\n    return /*#__PURE__*/_jsx(BoxRoot, _extends({\n      as: component,\n      ref: ref,\n      className: clsx(className, generateClassName ? generateClassName(defaultClassName) : defaultClassName),\n      theme: theme\n    }, other));\n  });\n  return Box;\n}","import { createBox } from '@mui/system';\nimport PropTypes from 'prop-types';\nimport { unstable_ClassNameGenerator as ClassNameGenerator } from '../className';\nimport { createTheme } from '../styles';\nconst defaultTheme = createTheme();\nconst Box = createBox({\n  defaultTheme,\n  defaultClassName: 'MuiBox-root',\n  generateClassName: ClassNameGenerator.generate\n});\nprocess.env.NODE_ENV !== \"production\" ? Box.propTypes\n/* remove-proptypes */\n= {\n  // ----------------------------- Warning --------------------------------\n  // | These PropTypes are generated from the TypeScript type definitions |\n  // |     To update them edit the d.ts file and run \"yarn proptypes\"     |\n  // ----------------------------------------------------------------------\n\n  /**\n   * @ignore\n   */\n  children: PropTypes.node,\n\n  /**\n   * The component used for the root node.\n   * Either a string to use a HTML element or a component.\n   */\n  component: PropTypes.elementType,\n\n  /**\n   * The system prop that allows defining system overrides as well as additional CSS styles.\n   */\n  sx: PropTypes.oneOfType([PropTypes.arrayOf(PropTypes.oneOfType([PropTypes.func, PropTypes.object, PropTypes.bool])), PropTypes.func, PropTypes.object])\n} : void 0;\nexport default Box;","// extracted by mini-css-extract-plugin\nmodule.exports = {\"mainDiv\":\"styles_mainDiv__1_bjB\",\"error\":\"styles_error__3zj3L\",\"actions\":\"styles_actions__19lBf\",\"community\":\"styles_community__3x1Rv\",\"maxh\":\"styles_maxh__1F8PL\",\"title\":\"styles_title__19EEO\",\"status\":\"styles_status__32RWl\",\"closed\":\"styles_closed__LHyGv\",\"text\":\"styles_text__3B-pE\"};","import React, { useState, useEffect } from 'react';\n\n// import axios from 'axios';\nimport dayjs from 'dayjs';\n\nimport { useRouter, useDorothy } from 'dorothy-dna-react';\n\nimport { Box } from '@mui/material';\nimport styles from './styles.module.scss';\n\nimport { useQuery, useMutation, useQueryClient } from 'react-query';\nimport axios from 'axios';\n\nimport { useSnackbar } from 'notistack';\n\nconst tabNames = {\n    informacao: 'Informações',\n    conexoes: 'Conexões',\n    indicadores: 'Indicadores',\n    atuacao: 'Atuação',\n}\n\nexport default function HelpNotification({ data }) {\n    const { getCommunityData, changeRoute, currentCommunity } = useRouter();\n    const { server } = useDorothy();\n    const { enqueueSnackbar, closeSnackbar } = useSnackbar();\n    const queryClient = useQueryClient();\n\n    const [date, _date] = useState('');\n    const [sender, _sender] = useState('');\n    const [senderId, _senderId] = useState('');\n    const [communityName, _communityName] = useState('...');\n\n    const [closing, _closing] = useState(false);\n\n    const { data: helpStatus } = useQuery([`help_status_${data.content.help_id}`, {\n        helpId: data.content.help_id,\n    }], {\n        queryFn: async () => (await axios.get(`${server}help/${data.content.help_id}`)).data,\n        enabled: !!data.content,\n    });\n\n    /* recuperar dados da comunidade */\n    useEffect(() => {\n        async function fetchCompleted() {\n            let communityData = await getCommunityData(data.content.communityId);\n            _communityName(communityData ? communityData.name : '?')\n        }\n\n        if (!data) return;\n\n        _date(dayjs(data.createdAt).format('DD [de] MMMM [de] YYYY [às] HH:mm'));\n        _sender(data.user_name);\n        _senderId(data.user_id);\n        /* _community(data.content.communityId);   */\n\n        fetchCompleted();\n    }, [data, server, getCommunityData]);\n\n    useEffect(() => {\n        if (!data) return;\n\n        queryClient.invalidateQueries(`help_status_${data.content.help_id}`)\n    }, [data, queryClient]);\n\n    /* useEffect(()=>{\n        if(!!data && !!helpStatus) \n            console.log(data.content.help_id, {helpStatus})\n    },[data, helpStatus]) */\n\n    const mutations = {\n        close: useMutation(\n            () => {\n                return axios.put(`${server}help/${data.content.help_id}/close`, {\n                    communityId: data.content.communityId,\n                });\n            }, {\n            onSuccess: () => {\n                queryClient.invalidateQueries(`help_status_${data.content.help_id}`);\n            },\n        },\n        ),\n    }\n\n    const access = () => {\n        changeRoute({ community: data.content.communityId, tool: 'projeto', params: [data.content.tab] })\n    }\n\n    const closeHelpRequest = async () => {\n        _closing(true);\n\n        const snackKey = enqueueSnackbar('Resolvendo pedido de ajuda...', {\n            /* variant: 'info', */\n            /* hideIconVariant: true, */\n            persist: true,\n            anchorOrigin: {\n                vertical: 'top',\n                horizontal: 'center',\n            },\n        });\n\n        try {\n\n\n            await mutations.close.mutateAsync();\n\n            closeSnackbar(snackKey);\n\n            enqueueSnackbar('Pedido de ajuda resolvido com sucesso!', {\n                variant: 'success',\n                anchorOrigin: {\n                    vertical: 'top',\n                    horizontal: 'right',\n                },\n            });\n        } catch (error) {\n            closeSnackbar(snackKey);\n\n\n            _closing(false);\n\n            console.error(error);\n\n            enqueueSnackbar('Erro ao resolver pedido de ajuda!', {\n                variant: 'error',\n                anchorOrigin: {\n                    vertical: 'top',\n                    horizontal: 'right',\n                },\n            });\n        }\n    }\n\n    return (<Box\n        sx={{\n            padding: '24px',\n            marginTop: '48px',\n            backgroundColor: 'white',\n            position: 'relative',\n            zIndex: '1',\n            minHeight: '100px',\n            width: '100%',\n            boxShadow: '0px 0px 8px #0000001A',\n            borderRadius: '8px',\n        }}\n    >\n        <Box sx={{ display: 'flex', justifyContent: 'space-between' }}>\n            <Box sx={{ display: 'flex' }}>\n                <Box\n                    as=\"img\"\n                    src={`${server}user/${senderId}/thumb`}\n                    alt=\"salve\"\n                    sx={{ borderRadius: '50%', width: '48px', height: '48px' }}\n                />\n                <Box sx={{ marginLeft: '8px' }}>\n                    <Box sx={{ fontWeight: 'bold', fontSize: '16px' }}>\n                        <div className={styles.title}>\n                            Pedido de Ajuda\n                            <HelpStatus status={helpStatus} />\n                        </div>\n                    </Box>\n                    <Box sx={{ fontSize: '14px' }}>{date}</Box>\n                </Box>\n            </Box>\n            {/* <Box>\n        <ArrowRightCircle size=\"32px\" />\n      </Box> */}\n        </Box>\n        <Box sx={{ marginTop: '8px' }}>\n            {/* {JSON.stringify(data)} */}\n\n            {currentCommunity.alias !== 'projeto' && <div className={styles.mainDiv}>\n                <div>\n                    {sender} de <span className={styles.community} onClick={access}>\"{communityName}\"</span>\n                    <span> pediu uma ajuda para a aba <span className={styles.field}>\"{tabNames[data.content.tab]}\"</span></span>\n                    , com o seguinte texto: <span className={styles.text}>\"{data.content.text}\"</span>\n                </div>\n                {data && <div className={styles.actions}>\n\n                    <button className='button-outline' size=\"small\" onClick={access}>Acessar</button>\n                    {helpStatus && !helpStatus.closedAt && <button className='button-primary' disabled={closing} size=\"small\" onClick={closeHelpRequest}>Resolvido</button>}\n\n                </div>}\n            </div>}\n\n            {currentCommunity.alias === 'projeto' && <div className={styles.mainDiv}>\n                <div>\n                    {sender} pediu uma ajuda para a aba <span className={styles.field}>\"{tabNames[data.content.tab]}\"</span>\n                    , com o seguinte texto: <span className={styles.text}>\"{data.content.text}\"</span>\n                </div>\n                {data && helpStatus && !helpStatus.closedAt && <div className={styles.actions}>\n\n                    <button className='button-primary' size=\"small\" onClick={access}>Acessar</button>\n\n                </div>}\n            </div>}\n        </Box>\n    </Box>)\n}\n\nfunction HelpStatus({ status }) {\n    if(!status) return (<></>);\n    return (<div className={`${styles.status} ${!!status.closedAt ? styles.closed  : ''}`}>{!!status.closedAt ? 'resolvido'  : 'aberto'}</div>);\n}"],"sourceRoot":""}